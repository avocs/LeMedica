/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ocr-menus/route";
exports.ids = ["app/api/ocr-menus/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/pdf-parse/lib/pdf.js sync recursive ^\\.\\/.*\\/build\\/pdf\\.js$":
/*!**************************************************************************!*\
  !*** ./node_modules/pdf-parse/lib/pdf.js/ sync ^\.\/.*\/build\/pdf\.js$ ***!
  \**************************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var map = {
	"./v1.10.100/build/pdf.js": "(rsc)/./node_modules/pdf-parse/lib/pdf.js/v1.10.100/build/pdf.js",
	"./v1.10.88/build/pdf.js": "(rsc)/./node_modules/pdf-parse/lib/pdf.js/v1.10.88/build/pdf.js",
	"./v1.9.426/build/pdf.js": "(rsc)/./node_modules/pdf-parse/lib/pdf.js/v1.9.426/build/pdf.js",
	"./v2.0.550/build/pdf.js": "(rsc)/./node_modules/pdf-parse/lib/pdf.js/v2.0.550/build/pdf.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "(rsc)/./node_modules/pdf-parse/lib/pdf.js sync recursive ^\\.\\/.*\\/build\\/pdf\\.js$";

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

"use strict";
module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("fs/promises");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "node:async_hooks":
/*!***********************************!*\
  !*** external "node:async_hooks" ***!
  \***********************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:async_hooks");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:fs/promises":
/*!***********************************!*\
  !*** external "node:fs/promises" ***!
  \***********************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs/promises");

/***/ }),

/***/ "node:os":
/*!**************************!*\
  !*** external "node:os" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:os");

/***/ }),

/***/ "node:path":
/*!****************************!*\
  !*** external "node:path" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:path");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "process":
/*!**************************!*\
  !*** external "process" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("process");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Focr-menus%2Froute&page=%2Fapi%2Focr-menus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Focr-menus%2Froute.ts&appDir=C%3A%5CUsers%5CUser%5CDocuments%5Cside_quest%5CLeMedica%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUser%5CDocuments%5Cside_quest%5CLeMedica&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Focr-menus%2Froute&page=%2Fapi%2Focr-menus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Focr-menus%2Froute.ts&appDir=C%3A%5CUsers%5CUser%5CDocuments%5Cside_quest%5CLeMedica%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUser%5CDocuments%5Cside_quest%5CLeMedica&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_User_Documents_side_quest_LeMedica_src_app_api_ocr_menus_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/ocr-menus/route.ts */ \"(rsc)/./src/app/api/ocr-menus/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ocr-menus/route\",\n        pathname: \"/api/ocr-menus\",\n        filename: \"route\",\n        bundlePath: \"app/api/ocr-menus/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\User\\\\Documents\\\\side_quest\\\\LeMedica\\\\src\\\\app\\\\api\\\\ocr-menus\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_User_Documents_side_quest_LeMedica_src_app_api_ocr_menus_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/ocr-menus/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZvY3ItbWVudXMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRm9jci1tZW51cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRm9jci1tZW51cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNVc2VyJTVDRG9jdW1lbnRzJTVDc2lkZV9xdWVzdCU1Q0xlTWVkaWNhJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNVc2VyJTVDRG9jdW1lbnRzJTVDc2lkZV9xdWVzdCU1Q0xlTWVkaWNhJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNvQztBQUNqSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2xlbWVkaWNhLWNsaW5pYy1vY3IvP2U2OTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcVXNlclxcXFxEb2N1bWVudHNcXFxcc2lkZV9xdWVzdFxcXFxMZU1lZGljYVxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxvY3ItbWVudXNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL29jci1tZW51cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL29jci1tZW51c1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvb2NyLW1lbnVzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcVXNlclxcXFxEb2N1bWVudHNcXFxcc2lkZV9xdWVzdFxcXFxMZU1lZGljYVxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxvY3ItbWVudXNcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL29jci1tZW51cy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Focr-menus%2Froute&page=%2Fapi%2Focr-menus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Focr-menus%2Froute.ts&appDir=C%3A%5CUsers%5CUser%5CDocuments%5Cside_quest%5CLeMedica%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUser%5CDocuments%5Cside_quest%5CLeMedica&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./bedrock-config.ts/bedrock-config.ts":
/*!*********************************************!*\
  !*** ./bedrock-config.ts/bedrock-config.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CLAUDE_OPUS_MODEL_ID: () => (/* binding */ CLAUDE_OPUS_MODEL_ID),\n/* harmony export */   CLAUDE_OPUS_PROFILE_ARN: () => (/* binding */ CLAUDE_OPUS_PROFILE_ARN),\n/* harmony export */   CLAUDE_SONNET_MODEL_ID: () => (/* binding */ CLAUDE_SONNET_MODEL_ID),\n/* harmony export */   CLAUDE_SONNET_PROFILE_ARN: () => (/* binding */ CLAUDE_SONNET_PROFILE_ARN),\n/* harmony export */   bedrockClient: () => (/* binding */ bedrockClient),\n/* harmony export */   createMedicalProcessingPrompt: () => (/* binding */ createMedicalProcessingPrompt),\n/* harmony export */   deidentifyMedicalRecord: () => (/* binding */ deidentifyMedicalRecord),\n/* harmony export */   processMedicalRecordWithClaude: () => (/* binding */ processMedicalRecordWithClaude)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_bedrock_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/client-bedrock-runtime */ \"(rsc)/./node_modules/@aws-sdk/client-bedrock-runtime/dist-es/BedrockRuntimeClient.js\");\n/* harmony import */ var _aws_sdk_client_bedrock_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aws-sdk/client-bedrock-runtime */ \"(rsc)/./node_modules/@aws-sdk/client-bedrock-runtime/dist-es/commands/InvokeModelCommand.js\");\n// ============================================================================\n// bedrock-config.ts\n// HIPAA-Compliant Claude 3 Medical Processing (AWS Bedrock Runtime)\n// ============================================================================\n\n// ---------------------------------------------------------------------------\n// AWS Bedrock Client\n// ---------------------------------------------------------------------------\nconst bedrockClient = new _aws_sdk_client_bedrock_runtime__WEBPACK_IMPORTED_MODULE_0__.BedrockRuntimeClient({\n    region: process.env.AWS_REGION || process.env.AWS_BEDROCK_REGION || \"us-east-1\",\n    credentials: {\n        accessKeyId: process.env.AWS_BEDROCK_ACCESS_KEY_ID || process.env.AWS_ACCESS_KEY_ID || \"\",\n        secretAccessKey: process.env.AWS_BEDROCK_SECRET_ACCESS_KEY || process.env.AWS_SECRET_ACCESS_KEY || \"\"\n    }\n});\n// ---------------------------------------------------------------------------\n// Model IDs\n// ---------------------------------------------------------------------------\nconst CLAUDE_SONNET_PROFILE_ARN = process.env.BEDROCK_PROFILE_ARN || \"\";\nconst CLAUDE_OPUS_PROFILE_ARN = process.env.BEDROCK_OPUS_PROFILE_ARN || \"\";\nconst CLAUDE_SONNET_MODEL_ID = \"anthropic.claude-sonnet-4-5-20250929-v1:0\";\nconst CLAUDE_OPUS_MODEL_ID = \"anthropic.claude-opus-4-20250514-v1:0\";\n// ---------------------------------------------------------------------------\n// ðŸ”’ De-identification function (HIPAA compliant)\n// ---------------------------------------------------------------------------\nfunction deidentifyMedicalRecord(record) {\n    let deidentified = record;\n    const phiPatterns = [\n        /\\b[A-Z][a-z]+ [A-Z][a-z]+\\b/g,\n        /\\b\\d{3}-\\d{2}-\\d{4}\\b/g,\n        /\\b\\d{3}-\\d{3}-\\d{4}\\b/g,\n        /\\b\\(\\d{3}\\)\\s*\\d{3}-\\d{4}\\b/g,\n        /\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b/g,\n        /\\b\\d+\\s+[A-Za-z\\s]+(?:Street|St|Avenue|Ave|Road|Rd|Drive|Dr|Lane|Ln|Boulevard|Blvd)\\b/g,\n        /\\bMRN\\s*:?\\s*\\d+/gi,\n        /\\bPatient\\s*ID\\s*:?\\s*\\d+/gi,\n        /\\b(?:DOB|Date of Birth|Birth Date|Patient.*Birth)\\s*:?\\s*\\d{1,2}\\/\\d{1,2}\\/\\d{4}\\b/gi // DOB\n    ];\n    phiPatterns.forEach((pattern)=>{\n        deidentified = deidentified.replace(pattern, \"[REDACTED]\");\n    });\n    return deidentified;\n}\n// ---------------------------------------------------------------------------\n// PROMPT BUILDER (Lab reports only)\n// ---------------------------------------------------------------------------\nfunction createMedicalProcessingPrompt(record) {\n    // Lab report: strict JSON with reportDate + categories\n    return `You are a medical lab data processor. Extract lab test results from the medical report and return a clean JSON object with categorized tests.\n\nIMPORTANT GUIDELINES:\n1. Maintain HIPAA compliance - do not extract or infer any personally identifiable information\n2. Focus on medical data, test results, and clinical information\n3. Be precise with numerical values and units\n4. Flag any abnormal or critical values clearly\n5. Provide confidence scores for your extractions\n6. If information is not available, use null or empty arrays/objects\n7. Ensure all extracted data is medically accurate and clinically relevant\n\nCRITICAL: Return ONLY the JSON object. No markdown, no backticks, no explanations. Start with { and end with }.\n\nREQUIRED JSON STRUCTURE:\n{\n  \"reportDate\": \"YYYY-MM-DD format if found, otherwise null\",\n  \"confidence\": 0.95,\n  \"categories\": [\n    {\n      \"categoryName\": \"Complete Blood Count\",\n      \"confidence\": 0.9,\n      \"tests\": [\n        {\n          \"testName\": \"White Blood Cells\",\n          \"value\": \"7.2\",\n          \"unit\": \"K/uL\",\n          \"referenceLow\": \"4.5\",\n          \"referenceHigh\": \"11.0\",\n          \"status\": \"normal\",\n          \"confidence\": 0.9\n        }\n      ]\n    }\n  ]\n}\nRULES:\nDATE EXTRACTION RULES:\n- Look for lab report date, test date, collection date, reported date, specimen date, received date\n- Common date formats: MM/DD/YYYY, DD/MM/YYYY, YYYY-MM-DD, Month DD, YYYY, DD-MMM-YYYY, YYYY/MM/DD\n- If multiple dates found, use the most recent test/collection/specimen date\n- Return null if no date found\n- Format as YYYY-MM-DD (e.g., \"2024-01-15\")\n\nCATEGORY RULES:\n- Create categories dynamically as needed (CBC, Lipid Panel, Liver Function, Kidney Function, Blood Sugar, Thyroid Function, Electrolytes, Vitamins & Minerals, Hormones, CRP/ESR, Autoimmune markers, Urinalysis, Infection panels, Tumor markers, Cardiac markers, Coagulation studies, Toxicology, Genetic tests, others)\n- Do not place unrelated tests together\n- Always categorize every test\n\nSTATUS RULES:\n- Status must be one of: normal, high, low, critical\n- If above referenceHigh â†’ \"high\"\n- If below referenceLow â†’ \"low\"\n- If extremely abnormal â†’ \"critical\"\n- Otherwise â†’ \"normal\"\n\nVALUE RULES:\n- Use exact numeric values from the report\n- Use standardized units (K/uL instead of X10^9/L, mg/dL instead of complex notation)\n- Common unit conversions:\n  * White Blood Cells: \"K/uL\"\n  * Red Blood Cells: \"M/uL\"\n  * Hemoglobin: \"g/dL\"\n  * Platelets: \"K/uL\"\n  * Cholesterol: mg/dL or mmol/L\n  * Glucose: mg/dL or mmol/L\n  * Liver enzymes: U/L\n  * Creatinine: mg/dL or Î¼mol/L\n- Use \"N/A\" for missing values\n- Round numeric values to 1 decimal place\n\nSTATUS RULES:\n- Status MUST be: normal, high, low, critical\n- If above referenceHigh â†’ \"high\"\n- If below referenceLow â†’ \"low\"\n- If extremely abnormal â†’ \"critical\"\n- Otherwise â†’ \"normal\"\n\nLab Report Text:\n${record}\n\nCRITICAL: Return ONLY the JSON object. No markdown, no backticks, no explanations. Start with { and end with }.`;\n}\n// ---------------------------------------------------------------------------\n// CLAUDE INVOCATION\n// ---------------------------------------------------------------------------\n// Main processing function using Claude Sonnet 4.5 (with Opus 4 fallback for complex cases)\nasync function processMedicalRecordWithClaude(request) {\n    try {\n        // ðŸ”’ ALWAYS de-identify if requested\n        const safeRecord = request.deidentifiedData ? deidentifyMedicalRecord(request.medicalRecord) : request.medicalRecord;\n        // ðŸ” Complexity detection MUST use the deidentified version\n        const recordForDetection = safeRecord.toLowerCase();\n        // Create the prompt\n        const prompt = createMedicalProcessingPrompt(safeRecord);\n        // Decide model\n        let modelId = request.modelId || CLAUDE_SONNET_MODEL_ID;\n        let maxTokens = 4000;\n        let temperature = 0.1;\n        // Detect complex mode based on SAFE text (HIPAA-safe)\n        const isComplexCase = !request.modelId && (safeRecord.length > 10000 || recordForDetection.includes(\"complex\") || recordForDetection.includes(\"multiple\") || recordForDetection.includes(\"abnormal\"));\n        if (isComplexCase) {\n            modelId = CLAUDE_OPUS_MODEL_ID;\n            maxTokens = 8000;\n            temperature = 0.05;\n            console.log(\"\\uD83C\\uDFE5 Using Claude Opus 4 for complex medical case\");\n        } else {\n            console.log(\"\\uD83C\\uDFE5 Using model for medical processing:\", modelId);\n        }\n        // Resolve inference profile ARN\n        const resolvedModelId = modelId === CLAUDE_SONNET_MODEL_ID && CLAUDE_SONNET_PROFILE_ARN ? CLAUDE_SONNET_PROFILE_ARN : modelId === CLAUDE_OPUS_MODEL_ID && CLAUDE_OPUS_PROFILE_ARN ? CLAUDE_OPUS_PROFILE_ARN : modelId;\n        const input = {\n            modelId: resolvedModelId,\n            contentType: \"application/json\",\n            accept: \"application/json\",\n            body: JSON.stringify({\n                anthropic_version: \"bedrock-2023-05-31\",\n                max_tokens: maxTokens,\n                temperature: temperature,\n                messages: [\n                    {\n                        role: \"user\",\n                        content: prompt\n                    }\n                ]\n            })\n        };\n        // Invoke model\n        const command = new _aws_sdk_client_bedrock_runtime__WEBPACK_IMPORTED_MODULE_1__.InvokeModelCommand(input);\n        const response = await bedrockClient.send(command);\n        // Convert raw response into text\n        const rawText = await (async ()=>{\n            const body = response.body;\n            if (typeof body?.transformToByteArray === \"function\") {\n                return new TextDecoder().decode(await body.transformToByteArray());\n            }\n            if (body instanceof Uint8Array) {\n                return new TextDecoder().decode(body);\n            }\n            return String(body ?? \"\");\n        })();\n        const responseBody = JSON.parse(rawText || \"{}\");\n        const claudeResponse = responseBody?.content?.[0]?.text || \"\";\n        // Strip markdown\n        let cleaned = claudeResponse.trim().replace(/^```json\\s*/i, \"\").replace(/^```\\s*/i, \"\").replace(/```$/i, \"\").trim();\n        // Parse JSON (lab_report must provide categories JSON)\n        let parsed;\n        try {\n            parsed = JSON.parse(cleaned);\n        } catch (err) {\n            console.error(\"Failed JSON:\", cleaned.substring(0, 500));\n            throw new Error(\"Invalid JSON response from Claude\");\n        }\n        // Lab report required structure\n        if (!parsed.categories || !Array.isArray(parsed.categories)) {\n            throw new Error(\"Invalid lab report JSON: missing categories\");\n        }\n        return {\n            reportDate: parsed.reportDate ?? null,\n            confidence: parsed.confidence ?? 0.95,\n            categories: parsed.categories\n        };\n    } catch (error) {\n        console.error(\"Error processing medical record with Claude:\", error);\n        const msg = error instanceof Error ? error.message : \"Unknown error\";\n        if (msg.includes(\"UnrecognizedClientException\") || msg.includes(\"InvalidSignatureException\")) {\n            throw new Error(\"AWS Bedrock authentication failed.\");\n        }\n        if (msg.includes(\"ValidationException\")) {\n            throw new Error(\"AWS Bedrock validation error: \" + msg);\n        }\n        if (msg.includes(\"ModelNotReadyException\") || msg.includes(\"ThrottlingException\")) {\n            throw new Error(\"AWS Bedrock temporarily unavailable.\");\n        }\n        if (msg.includes(\"AccessDeniedException\")) {\n            throw new Error(\"Permission denied for AWS Bedrock.\");\n        }\n        throw new Error(\"Medical record processing failed: \" + msg);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9iZWRyb2NrLWNvbmZpZy50cy9iZWRyb2NrLWNvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUEsK0VBQStFO0FBQy9FLG9CQUFvQjtBQUNwQixvRUFBb0U7QUFDcEUsK0VBQStFO0FBRVk7QUFFM0YsOEVBQThFO0FBQzlFLHFCQUFxQjtBQUNyQiw4RUFBOEU7QUFDdkUsTUFBTUUsZ0JBQWdCLElBQUlGLGlGQUFvQkEsQ0FBQztJQUNwREcsUUFBUUMsUUFBUUMsR0FBRyxDQUFDQyxVQUFVLElBQUlGLFFBQVFDLEdBQUcsQ0FBQ0Usa0JBQWtCLElBQUk7SUFDcEVDLGFBQWE7UUFDWEMsYUFBYUwsUUFBUUMsR0FBRyxDQUFDSyx5QkFBeUIsSUFBSU4sUUFBUUMsR0FBRyxDQUFDTSxpQkFBaUIsSUFBSTtRQUN2RkMsaUJBQWlCUixRQUFRQyxHQUFHLENBQUNRLDZCQUE2QixJQUFJVCxRQUFRQyxHQUFHLENBQUNTLHFCQUFxQixJQUFJO0lBQ3JHO0FBQ0YsR0FBRztBQUVILDhFQUE4RTtBQUM5RSxZQUFZO0FBQ1osOEVBQThFO0FBQ3ZFLE1BQU1DLDRCQUE0QlgsUUFBUUMsR0FBRyxDQUFDVyxtQkFBbUIsSUFBSSxHQUFHO0FBQ3hFLE1BQU1DLDBCQUEwQmIsUUFBUUMsR0FBRyxDQUFDYSx3QkFBd0IsSUFBSSxHQUFHO0FBQzNFLE1BQU1DLHlCQUF5Qiw0Q0FBNEM7QUFDM0UsTUFBTUMsdUJBQXVCLHdDQUF3QztBQWtENUUsOEVBQThFO0FBQzlFLGtEQUFrRDtBQUNsRCw4RUFBOEU7QUFDdkUsU0FBU0Msd0JBQXdCQyxNQUFjO0lBQ3BELElBQUlDLGVBQWVEO0lBRW5CLE1BQU1FLGNBQWM7UUFDbEI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBLHVGQUF1RixNQUFNO0tBQzlGO0lBRURBLFlBQVlDLE9BQU8sQ0FBQ0MsQ0FBQUE7UUFDbEJILGVBQWVBLGFBQWFJLE9BQU8sQ0FBQ0QsU0FBUztJQUMvQztJQUVB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UUFBUUssU0FBUyxDQUFDLEdBQUc7WUFDbkQsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO1FBRUEsZ0NBQWdDO1FBQ2hDLElBQUksQ0FBQ0osT0FBT0ssVUFBVSxJQUFJLENBQUNDLE1BQU1DLE9BQU8sQ0FBQ1AsT0FBT0ssVUFBVSxHQUFHO1lBQzNELE1BQU0sSUFBSUQsTUFBTTtRQUNsQjtRQUNBLE9BQU87WUFDTEksWUFBWVIsT0FBT1EsVUFBVSxJQUFJO1lBQ2pDQyxZQUFZVCxPQUFPUyxVQUFVLElBQUk7WUFDakNKLFlBQVlMLE9BQU9LLFVBQVU7UUFDL0I7SUFDRixFQUFFLE9BQU9ILE9BQU87UUFDZC9CLFFBQVErQixLQUFLLENBQUMsZ0RBQWdEQTtRQUM5RCxNQUFNUSxNQUFNUixpQkFBaUJFLFFBQVFGLE1BQU1TLE9BQU8sR0FBRztRQUVyRCxJQUFJRCxJQUFJeEMsUUFBUSxDQUFDLGtDQUFrQ3dDLElBQUl4QyxRQUFRLENBQUMsOEJBQThCO1lBQzVGLE1BQU0sSUFBSWtDLE1BQU07UUFDbEI7UUFDQSxJQUFJTSxJQUFJeEMsUUFBUSxDQUFDLHdCQUF3QjtZQUN2QyxNQUFNLElBQUlrQyxNQUFNLG1DQUFtQ007UUFDckQ7UUFDQSxJQUFJQSxJQUFJeEMsUUFBUSxDQUFDLDZCQUE2QndDLElBQUl4QyxRQUFRLENBQUMsd0JBQXdCO1lBQ2pGLE1BQU0sSUFBSWtDLE1BQU07UUFDbEI7UUFDQSxJQUFJTSxJQUFJeEMsUUFBUSxDQUFDLDBCQUEwQjtZQUN6QyxNQUFNLElBQUlrQyxNQUFNO1FBQ2xCO1FBRUEsTUFBTSxJQUFJQSxNQUFNLHVDQUF1Q007SUFDekQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2xlbWVkaWNhLWNsaW5pYy1vY3IvLi9iZWRyb2NrLWNvbmZpZy50cy9iZWRyb2NrLWNvbmZpZy50cz9lYmE3Il0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIGJlZHJvY2stY29uZmlnLnRzXG4vLyBISVBBQS1Db21wbGlhbnQgQ2xhdWRlIDMgTWVkaWNhbCBQcm9jZXNzaW5nIChBV1MgQmVkcm9jayBSdW50aW1lKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyBCZWRyb2NrUnVudGltZUNsaWVudCwgSW52b2tlTW9kZWxDb21tYW5kIH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1iZWRyb2NrLXJ1bnRpbWVcIjtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBBV1MgQmVkcm9jayBDbGllbnRcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZXhwb3J0IGNvbnN0IGJlZHJvY2tDbGllbnQgPSBuZXcgQmVkcm9ja1J1bnRpbWVDbGllbnQoe1xuICByZWdpb246IHByb2Nlc3MuZW52LkFXU19SRUdJT04gfHwgcHJvY2Vzcy5lbnYuQVdTX0JFRFJPQ0tfUkVHSU9OIHx8IFwidXMtZWFzdC0xXCIsXG4gIGNyZWRlbnRpYWxzOiB7XG4gICAgYWNjZXNzS2V5SWQ6IHByb2Nlc3MuZW52LkFXU19CRURST0NLX0FDQ0VTU19LRVlfSUQgfHwgcHJvY2Vzcy5lbnYuQVdTX0FDQ0VTU19LRVlfSUQgfHwgXCJcIixcbiAgICBzZWNyZXRBY2Nlc3NLZXk6IHByb2Nlc3MuZW52LkFXU19CRURST0NLX1NFQ1JFVF9BQ0NFU1NfS0VZIHx8IHByb2Nlc3MuZW52LkFXU19TRUNSRVRfQUNDRVNTX0tFWSB8fCBcIlwiLFxuICB9XG59KTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBNb2RlbCBJRHNcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZXhwb3J0IGNvbnN0IENMQVVERV9TT05ORVRfUFJPRklMRV9BUk4gPSBwcm9jZXNzLmVudi5CRURST0NLX1BST0ZJTEVfQVJOIHx8IFwiXCI7XG5leHBvcnQgY29uc3QgQ0xBVURFX09QVVNfUFJPRklMRV9BUk4gPSBwcm9jZXNzLmVudi5CRURST0NLX09QVVNfUFJPRklMRV9BUk4gfHwgXCJcIjtcbmV4cG9ydCBjb25zdCBDTEFVREVfU09OTkVUX01PREVMX0lEID0gXCJhbnRocm9waWMuY2xhdWRlLXNvbm5ldC00LTUtMjAyNTA5MjktdjE6MFwiO1xuZXhwb3J0IGNvbnN0IENMQVVERV9PUFVTX01PREVMX0lEID0gXCJhbnRocm9waWMuY2xhdWRlLW9wdXMtNC0yMDI1MDUxNC12MTowXCI7XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gUmVxdWVzdCArIFJlc3BvbnNlIEludGVyZmFjZXMgKENsYXVkZS1sZXZlbClcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZXhwb3J0IGludGVyZmFjZSBNZWRpY2FsUmVjb3JkUHJvY2Vzc2luZ1JlcXVlc3Qge1xuICBtZWRpY2FsUmVjb3JkOiBzdHJpbmc7XG4gIHJlY29yZFR5cGU6IFwibGFiX3JlcG9ydFwiO1xuICBkZWlkZW50aWZpZWREYXRhPzogYm9vbGVhbjtcbiAgbW9kZWxJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBNZWRpY2FsUmVjb3JkUHJvY2Vzc2luZ1Jlc3BvbnNlIHtcbiAgcmVwb3J0RGF0ZTogc3RyaW5nIHwgbnVsbDtcbiAgY29uZmlkZW5jZTogbnVtYmVyO1xuICBjYXRlZ29yaWVzOiBBcnJheTx7XG4gICAgY2F0ZWdvcnlOYW1lOiBzdHJpbmc7XG4gICAgY29uZmlkZW5jZTogbnVtYmVyO1xuICAgIHRlc3RzOiBBcnJheTx7XG4gICAgICB0ZXN0TmFtZTogc3RyaW5nO1xuICAgICAgdmFsdWU6IHN0cmluZztcbiAgICAgIHVuaXQ6IHN0cmluZztcbiAgICAgIHJlZmVyZW5jZUxvdzogc3RyaW5nO1xuICAgICAgcmVmZXJlbmNlSGlnaDogc3RyaW5nO1xuICAgICAgc3RhdHVzOiBzdHJpbmc7XG4gICAgICBjb25maWRlbmNlOiBudW1iZXI7XG4gICAgfT47XG4gIH0+O1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEZpbmFsIFVuaWZpZWQgRm9ybWF0IGZvciBVSSAocG9zdC1wcm9jZXNzaW5nKVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5leHBvcnQgaW50ZXJmYWNlIExhYlJlcG9ydERhdGEge1xuICByZXBvcnREYXRlOiBzdHJpbmcgfCBudWxsO1xuICBjb25maWRlbmNlOiBudW1iZXI7XG4gIGNhdGVnb3JpZXM6IEFycmF5PHtcbiAgICBjYXRlZ29yeU5hbWU6IHN0cmluZztcbiAgICBjb25maWRlbmNlOiBudW1iZXI7XG4gICAgdGVzdHM6IEFycmF5PHtcbiAgICAgIHRlc3ROYW1lOiBzdHJpbmc7XG4gICAgICB2YWx1ZTogc3RyaW5nO1xuICAgICAgdW5pdDogc3RyaW5nO1xuICAgICAgcmVmZXJlbmNlTG93OiBzdHJpbmc7XG4gICAgICByZWZlcmVuY2VIaWdoOiBzdHJpbmc7XG4gICAgICBzdGF0dXM6IFwibm9ybWFsXCIgfCBcImhpZ2hcIiB8IFwibG93XCIgfCBcImNyaXRpY2FsXCI7XG4gICAgICBjb25maWRlbmNlOiBudW1iZXI7XG4gICAgfT47XG4gIH0+O1xufVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyDwn5SSIERlLWlkZW50aWZpY2F0aW9uIGZ1bmN0aW9uIChISVBBQSBjb21wbGlhbnQpXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmV4cG9ydCBmdW5jdGlvbiBkZWlkZW50aWZ5TWVkaWNhbFJlY29yZChyZWNvcmQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIGxldCBkZWlkZW50aWZpZWQgPSByZWNvcmQ7XG5cbiAgY29uc3QgcGhpUGF0dGVybnMgPSBbXG4gICAgL1xcYltBLVpdW2Etel0rIFtBLVpdW2Etel0rXFxiL2csICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5hbWVzXG4gICAgL1xcYlxcZHszfS1cXGR7Mn0tXFxkezR9XFxiL2csICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNTTlxuICAgIC9cXGJcXGR7M30tXFxkezN9LVxcZHs0fVxcYi9nLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwaG9uZVxuICAgIC9cXGJcXChcXGR7M31cXClcXHMqXFxkezN9LVxcZHs0fVxcYi9nLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwaG9uZSBhbHRcbiAgICAvXFxiW0EtWmEtejAtOS5fJSstXStAW0EtWmEtejAtOS4tXStcXC5bQS1afGEtel17Mix9XFxiL2csICAgICAgICAgIC8vIGVtYWlsXG4gICAgL1xcYlxcZCtcXHMrW0EtWmEtelxcc10rKD86U3RyZWV0fFN0fEF2ZW51ZXxBdmV8Um9hZHxSZHxEcml2ZXxEcnxMYW5lfExufEJvdWxldmFyZHxCbHZkKVxcYi9nLFxuICAgIC9cXGJNUk5cXHMqOj9cXHMqXFxkKy9naSwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1STlxuICAgIC9cXGJQYXRpZW50XFxzKklEXFxzKjo/XFxzKlxcZCsvZ2ksICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJRFxuICAgIC9cXGIoPzpET0J8RGF0ZSBvZiBCaXJ0aHxCaXJ0aCBEYXRlfFBhdGllbnQuKkJpcnRoKVxccyo6P1xccypcXGR7MSwyfVxcL1xcZHsxLDJ9XFwvXFxkezR9XFxiL2dpIC8vIERPQlxuICBdO1xuXG4gIHBoaVBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgZGVpZGVudGlmaWVkID0gZGVpZGVudGlmaWVkLnJlcGxhY2UocGF0dGVybiwgXCJbUkVEQUNURURdXCIpO1xuICB9KTtcblxuICByZXR1cm4gZGVpZGVudGlmaWVkO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFBST01QVCBCVUlMREVSIChMYWIgcmVwb3J0cyBvbmx5KVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTWVkaWNhbFByb2Nlc3NpbmdQcm9tcHQocmVjb3JkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAvLyBMYWIgcmVwb3J0OiBzdHJpY3QgSlNPTiB3aXRoIHJlcG9ydERhdGUgKyBjYXRlZ29yaWVzXG4gIHJldHVybiBgWW91IGFyZSBhIG1lZGljYWwgbGFiIGRhdGEgcHJvY2Vzc29yLiBFeHRyYWN0IGxhYiB0ZXN0IHJlc3VsdHMgZnJvbSB0aGUgbWVkaWNhbCByZXBvcnQgYW5kIHJldHVybiBhIGNsZWFuIEpTT04gb2JqZWN0IHdpdGggY2F0ZWdvcml6ZWQgdGVzdHMuXG5cbklNUE9SVEFOVCBHVUlERUxJTkVTOlxuMS4gTWFpbnRhaW4gSElQQUEgY29tcGxpYW5jZSAtIGRvIG5vdCBleHRyYWN0IG9yIGluZmVyIGFueSBwZXJzb25hbGx5IGlkZW50aWZpYWJsZSBpbmZvcm1hdGlvblxuMi4gRm9jdXMgb24gbWVkaWNhbCBkYXRhLCB0ZXN0IHJlc3VsdHMsIGFuZCBjbGluaWNhbCBpbmZvcm1hdGlvblxuMy4gQmUgcHJlY2lzZSB3aXRoIG51bWVyaWNhbCB2YWx1ZXMgYW5kIHVuaXRzXG40LiBGbGFnIGFueSBhYm5vcm1hbCBvciBjcml0aWNhbCB2YWx1ZXMgY2xlYXJseVxuNS4gUHJvdmlkZSBjb25maWRlbmNlIHNjb3JlcyBmb3IgeW91ciBleHRyYWN0aW9uc1xuNi4gSWYgaW5mb3JtYXRpb24gaXMgbm90IGF2YWlsYWJsZSwgdXNlIG51bGwgb3IgZW1wdHkgYXJyYXlzL29iamVjdHNcbjcuIEVuc3VyZSBhbGwgZXh0cmFjdGVkIGRhdGEgaXMgbWVkaWNhbGx5IGFjY3VyYXRlIGFuZCBjbGluaWNhbGx5IHJlbGV2YW50XG5cbkNSSVRJQ0FMOiBSZXR1cm4gT05MWSB0aGUgSlNPTiBvYmplY3QuIE5vIG1hcmtkb3duLCBubyBiYWNrdGlja3MsIG5vIGV4cGxhbmF0aW9ucy4gU3RhcnQgd2l0aCB7IGFuZCBlbmQgd2l0aCB9LlxuXG5SRVFVSVJFRCBKU09OIFNUUlVDVFVSRTpcbntcbiAgXCJyZXBvcnREYXRlXCI6IFwiWVlZWS1NTS1ERCBmb3JtYXQgaWYgZm91bmQsIG90aGVyd2lzZSBudWxsXCIsXG4gIFwiY29uZmlkZW5jZVwiOiAwLjk1LFxuICBcImNhdGVnb3JpZXNcIjogW1xuICAgIHtcbiAgICAgIFwiY2F0ZWdvcnlOYW1lXCI6IFwiQ29tcGxldGUgQmxvb2QgQ291bnRcIixcbiAgICAgIFwiY29uZmlkZW5jZVwiOiAwLjksXG4gICAgICBcInRlc3RzXCI6IFtcbiAgICAgICAge1xuICAgICAgICAgIFwidGVzdE5hbWVcIjogXCJXaGl0ZSBCbG9vZCBDZWxsc1wiLFxuICAgICAgICAgIFwidmFsdWVcIjogXCI3LjJcIixcbiAgICAgICAgICBcInVuaXRcIjogXCJLL3VMXCIsXG4gICAgICAgICAgXCJyZWZlcmVuY2VMb3dcIjogXCI0LjVcIixcbiAgICAgICAgICBcInJlZmVyZW5jZUhpZ2hcIjogXCIxMS4wXCIsXG4gICAgICAgICAgXCJzdGF0dXNcIjogXCJub3JtYWxcIixcbiAgICAgICAgICBcImNvbmZpZGVuY2VcIjogMC45XG4gICAgICAgIH1cbiAgICAgIF1cbiAgICB9XG4gIF1cbn1cblJVTEVTOlxuREFURSBFWFRSQUNUSU9OIFJVTEVTOlxuLSBMb29rIGZvciBsYWIgcmVwb3J0IGRhdGUsIHRlc3QgZGF0ZSwgY29sbGVjdGlvbiBkYXRlLCByZXBvcnRlZCBkYXRlLCBzcGVjaW1lbiBkYXRlLCByZWNlaXZlZCBkYXRlXG4tIENvbW1vbiBkYXRlIGZvcm1hdHM6IE1NL0REL1lZWVksIEREL01NL1lZWVksIFlZWVktTU0tREQsIE1vbnRoIERELCBZWVlZLCBERC1NTU0tWVlZWSwgWVlZWS9NTS9ERFxuLSBJZiBtdWx0aXBsZSBkYXRlcyBmb3VuZCwgdXNlIHRoZSBtb3N0IHJlY2VudCB0ZXN0L2NvbGxlY3Rpb24vc3BlY2ltZW4gZGF0ZVxuLSBSZXR1cm4gbnVsbCBpZiBubyBkYXRlIGZvdW5kXG4tIEZvcm1hdCBhcyBZWVlZLU1NLUREIChlLmcuLCBcIjIwMjQtMDEtMTVcIilcblxuQ0FURUdPUlkgUlVMRVM6XG4tIENyZWF0ZSBjYXRlZ29yaWVzIGR5bmFtaWNhbGx5IGFzIG5lZWRlZCAoQ0JDLCBMaXBpZCBQYW5lbCwgTGl2ZXIgRnVuY3Rpb24sIEtpZG5leSBGdW5jdGlvbiwgQmxvb2QgU3VnYXIsIFRoeXJvaWQgRnVuY3Rpb24sIEVsZWN0cm9seXRlcywgVml0YW1pbnMgJiBNaW5lcmFscywgSG9ybW9uZXMsIENSUC9FU1IsIEF1dG9pbW11bmUgbWFya2VycywgVXJpbmFseXNpcywgSW5mZWN0aW9uIHBhbmVscywgVHVtb3IgbWFya2VycywgQ2FyZGlhYyBtYXJrZXJzLCBDb2FndWxhdGlvbiBzdHVkaWVzLCBUb3hpY29sb2d5LCBHZW5ldGljIHRlc3RzLCBvdGhlcnMpXG4tIERvIG5vdCBwbGFjZSB1bnJlbGF0ZWQgdGVzdHMgdG9nZXRoZXJcbi0gQWx3YXlzIGNhdGVnb3JpemUgZXZlcnkgdGVzdFxuXG5TVEFUVVMgUlVMRVM6XG4tIFN0YXR1cyBtdXN0IGJlIG9uZSBvZjogbm9ybWFsLCBoaWdoLCBsb3csIGNyaXRpY2FsXG4tIElmIGFib3ZlIHJlZmVyZW5jZUhpZ2gg4oaSIFwiaGlnaFwiXG4tIElmIGJlbG93IHJlZmVyZW5jZUxvdyDihpIgXCJsb3dcIlxuLSBJZiBleHRyZW1lbHkgYWJub3JtYWwg4oaSIFwiY3JpdGljYWxcIlxuLSBPdGhlcndpc2Ug4oaSIFwibm9ybWFsXCJcblxuVkFMVUUgUlVMRVM6XG4tIFVzZSBleGFjdCBudW1lcmljIHZhbHVlcyBmcm9tIHRoZSByZXBvcnRcbi0gVXNlIHN0YW5kYXJkaXplZCB1bml0cyAoSy91TCBpbnN0ZWFkIG9mIFgxMF45L0wsIG1nL2RMIGluc3RlYWQgb2YgY29tcGxleCBub3RhdGlvbilcbi0gQ29tbW9uIHVuaXQgY29udmVyc2lvbnM6XG4gICogV2hpdGUgQmxvb2QgQ2VsbHM6IFwiSy91TFwiXG4gICogUmVkIEJsb29kIENlbGxzOiBcIk0vdUxcIlxuICAqIEhlbW9nbG9iaW46IFwiZy9kTFwiXG4gICogUGxhdGVsZXRzOiBcIksvdUxcIlxuICAqIENob2xlc3Rlcm9sOiBtZy9kTCBvciBtbW9sL0xcbiAgKiBHbHVjb3NlOiBtZy9kTCBvciBtbW9sL0xcbiAgKiBMaXZlciBlbnp5bWVzOiBVL0xcbiAgKiBDcmVhdGluaW5lOiBtZy9kTCBvciDOvG1vbC9MXG4tIFVzZSBcIk4vQVwiIGZvciBtaXNzaW5nIHZhbHVlc1xuLSBSb3VuZCBudW1lcmljIHZhbHVlcyB0byAxIGRlY2ltYWwgcGxhY2VcblxuU1RBVFVTIFJVTEVTOlxuLSBTdGF0dXMgTVVTVCBiZTogbm9ybWFsLCBoaWdoLCBsb3csIGNyaXRpY2FsXG4tIElmIGFib3ZlIHJlZmVyZW5jZUhpZ2gg4oaSIFwiaGlnaFwiXG4tIElmIGJlbG93IHJlZmVyZW5jZUxvdyDihpIgXCJsb3dcIlxuLSBJZiBleHRyZW1lbHkgYWJub3JtYWwg4oaSIFwiY3JpdGljYWxcIlxuLSBPdGhlcndpc2Ug4oaSIFwibm9ybWFsXCJcblxuTGFiIFJlcG9ydCBUZXh0OlxuJHtyZWNvcmR9XG5cbkNSSVRJQ0FMOiBSZXR1cm4gT05MWSB0aGUgSlNPTiBvYmplY3QuIE5vIG1hcmtkb3duLCBubyBiYWNrdGlja3MsIG5vIGV4cGxhbmF0aW9ucy4gU3RhcnQgd2l0aCB7IGFuZCBlbmQgd2l0aCB9LmA7XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gQ0xBVURFIElOVk9DQVRJT05cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gTWFpbiBwcm9jZXNzaW5nIGZ1bmN0aW9uIHVzaW5nIENsYXVkZSBTb25uZXQgNC41ICh3aXRoIE9wdXMgNCBmYWxsYmFjayBmb3IgY29tcGxleCBjYXNlcylcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzTWVkaWNhbFJlY29yZFdpdGhDbGF1ZGUoXG4gIHJlcXVlc3Q6IE1lZGljYWxSZWNvcmRQcm9jZXNzaW5nUmVxdWVzdFxuKTogUHJvbWlzZTxNZWRpY2FsUmVjb3JkUHJvY2Vzc2luZ1Jlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgLy8g8J+UkiBBTFdBWVMgZGUtaWRlbnRpZnkgaWYgcmVxdWVzdGVkXG4gICAgY29uc3Qgc2FmZVJlY29yZCA9IHJlcXVlc3QuZGVpZGVudGlmaWVkRGF0YVxuICAgICAgPyBkZWlkZW50aWZ5TWVkaWNhbFJlY29yZChyZXF1ZXN0Lm1lZGljYWxSZWNvcmQpXG4gICAgICA6IHJlcXVlc3QubWVkaWNhbFJlY29yZDtcblxuICAgIC8vIPCflI0gQ29tcGxleGl0eSBkZXRlY3Rpb24gTVVTVCB1c2UgdGhlIGRlaWRlbnRpZmllZCB2ZXJzaW9uXG4gICAgY29uc3QgcmVjb3JkRm9yRGV0ZWN0aW9uID0gc2FmZVJlY29yZC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgLy8gQ3JlYXRlIHRoZSBwcm9tcHRcbiAgICBjb25zdCBwcm9tcHQgPSBjcmVhdGVNZWRpY2FsUHJvY2Vzc2luZ1Byb21wdChzYWZlUmVjb3JkKTtcblxuICAgIC8vIERlY2lkZSBtb2RlbFxuICAgIGxldCBtb2RlbElkID0gcmVxdWVzdC5tb2RlbElkIHx8IENMQVVERV9TT05ORVRfTU9ERUxfSUQ7XG4gICAgbGV0IG1heFRva2VucyA9IDQwMDA7XG4gICAgbGV0IHRlbXBlcmF0dXJlID0gMC4xO1xuXG4gICAgLy8gRGV0ZWN0IGNvbXBsZXggbW9kZSBiYXNlZCBvbiBTQUZFIHRleHQgKEhJUEFBLXNhZmUpXG4gICAgY29uc3QgaXNDb21wbGV4Q2FzZSA9XG4gICAgICAhcmVxdWVzdC5tb2RlbElkICYmXG4gICAgICAoXG4gICAgICAgIHNhZmVSZWNvcmQubGVuZ3RoID4gMTAwMDAgfHxcbiAgICAgICAgcmVjb3JkRm9yRGV0ZWN0aW9uLmluY2x1ZGVzKFwiY29tcGxleFwiKSB8fFxuICAgICAgICByZWNvcmRGb3JEZXRlY3Rpb24uaW5jbHVkZXMoXCJtdWx0aXBsZVwiKSB8fFxuICAgICAgICByZWNvcmRGb3JEZXRlY3Rpb24uaW5jbHVkZXMoXCJhYm5vcm1hbFwiKVxuICAgICAgKTtcblxuICAgIGlmIChpc0NvbXBsZXhDYXNlKSB7XG4gICAgICBtb2RlbElkID0gQ0xBVURFX09QVVNfTU9ERUxfSUQ7XG4gICAgICBtYXhUb2tlbnMgPSA4MDAwO1xuICAgICAgdGVtcGVyYXR1cmUgPSAwLjA1O1xuICAgICAgY29uc29sZS5sb2coXCLwn4+lIFVzaW5nIENsYXVkZSBPcHVzIDQgZm9yIGNvbXBsZXggbWVkaWNhbCBjYXNlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZyhcIvCfj6UgVXNpbmcgbW9kZWwgZm9yIG1lZGljYWwgcHJvY2Vzc2luZzpcIiwgbW9kZWxJZCk7XG4gICAgfVxuXG4gICAgLy8gUmVzb2x2ZSBpbmZlcmVuY2UgcHJvZmlsZSBBUk5cbiAgICBjb25zdCByZXNvbHZlZE1vZGVsSWQgPVxuICAgICAgbW9kZWxJZCA9PT0gQ0xBVURFX1NPTk5FVF9NT0RFTF9JRCAmJiBDTEFVREVfU09OTkVUX1BST0ZJTEVfQVJOXG4gICAgICAgID8gQ0xBVURFX1NPTk5FVF9QUk9GSUxFX0FSTlxuICAgICAgICA6IG1vZGVsSWQgPT09IENMQVVERV9PUFVTX01PREVMX0lEICYmIENMQVVERV9PUFVTX1BST0ZJTEVfQVJOXG4gICAgICAgICAgPyBDTEFVREVfT1BVU19QUk9GSUxFX0FSTlxuICAgICAgICAgIDogbW9kZWxJZDtcblxuICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgbW9kZWxJZDogcmVzb2x2ZWRNb2RlbElkLFxuICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgYWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYW50aHJvcGljX3ZlcnNpb246IFwiYmVkcm9jay0yMDIzLTA1LTMxXCIsXG4gICAgICAgIG1heF90b2tlbnM6IG1heFRva2VucyxcbiAgICAgICAgdGVtcGVyYXR1cmU6IHRlbXBlcmF0dXJlLFxuICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IHByb21wdCB9XVxuICAgICAgfSlcbiAgICB9O1xuXG4gICAgLy8gSW52b2tlIG1vZGVsXG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBJbnZva2VNb2RlbENvbW1hbmQoaW5wdXQpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYmVkcm9ja0NsaWVudC5zZW5kKGNvbW1hbmQpO1xuXG4gICAgLy8gQ29udmVydCByYXcgcmVzcG9uc2UgaW50byB0ZXh0XG4gICAgY29uc3QgcmF3VGV4dCA9IGF3YWl0IChhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBib2R5OiBhbnkgPSAocmVzcG9uc2UgYXMgYW55KS5ib2R5O1xuICAgICAgaWYgKHR5cGVvZiBib2R5Py50cmFuc2Zvcm1Ub0J5dGVBcnJheSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoYXdhaXQgYm9keS50cmFuc2Zvcm1Ub0J5dGVBcnJheSgpKTtcbiAgICAgIH1cbiAgICAgIGlmIChib2R5IGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGJvZHkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFN0cmluZyhib2R5ID8/IFwiXCIpO1xuICAgIH0pKCk7XG5cbiAgICBjb25zdCByZXNwb25zZUJvZHkgPSBKU09OLnBhcnNlKHJhd1RleHQgfHwgXCJ7fVwiKTtcbiAgICBjb25zdCBjbGF1ZGVSZXNwb25zZSA9IHJlc3BvbnNlQm9keT8uY29udGVudD8uWzBdPy50ZXh0IHx8IFwiXCI7XG5cbiAgICAvLyBTdHJpcCBtYXJrZG93blxuICAgIGxldCBjbGVhbmVkID0gY2xhdWRlUmVzcG9uc2UudHJpbSgpXG4gICAgICAucmVwbGFjZSgvXmBgYGpzb25cXHMqL2ksIFwiXCIpXG4gICAgICAucmVwbGFjZSgvXmBgYFxccyovaSwgXCJcIilcbiAgICAgIC5yZXBsYWNlKC9gYGAkL2ksIFwiXCIpXG4gICAgICAudHJpbSgpO1xuXG5cbiAgICAvLyBQYXJzZSBKU09OIChsYWJfcmVwb3J0IG11c3QgcHJvdmlkZSBjYXRlZ29yaWVzIEpTT04pXG4gICAgbGV0IHBhcnNlZDogYW55O1xuICAgIHRyeSB7XG4gICAgICBwYXJzZWQgPSBKU09OLnBhcnNlKGNsZWFuZWQpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCBKU09OOlwiLCBjbGVhbmVkLnN1YnN0cmluZygwLCA1MDApKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgSlNPTiByZXNwb25zZSBmcm9tIENsYXVkZVwiKTtcbiAgICB9XG5cbiAgICAvLyBMYWIgcmVwb3J0IHJlcXVpcmVkIHN0cnVjdHVyZVxuICAgIGlmICghcGFyc2VkLmNhdGVnb3JpZXMgfHwgIUFycmF5LmlzQXJyYXkocGFyc2VkLmNhdGVnb3JpZXMpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGxhYiByZXBvcnQgSlNPTjogbWlzc2luZyBjYXRlZ29yaWVzXCIpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgcmVwb3J0RGF0ZTogcGFyc2VkLnJlcG9ydERhdGUgPz8gbnVsbCxcbiAgICAgIGNvbmZpZGVuY2U6IHBhcnNlZC5jb25maWRlbmNlID8/IDAuOTUsXG4gICAgICBjYXRlZ29yaWVzOiBwYXJzZWQuY2F0ZWdvcmllc1xuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHByb2Nlc3NpbmcgbWVkaWNhbCByZWNvcmQgd2l0aCBDbGF1ZGU6XCIsIGVycm9yKTtcbiAgICBjb25zdCBtc2cgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiVW5rbm93biBlcnJvclwiO1xuXG4gICAgaWYgKG1zZy5pbmNsdWRlcyhcIlVucmVjb2duaXplZENsaWVudEV4Y2VwdGlvblwiKSB8fCBtc2cuaW5jbHVkZXMoXCJJbnZhbGlkU2lnbmF0dXJlRXhjZXB0aW9uXCIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBV1MgQmVkcm9jayBhdXRoZW50aWNhdGlvbiBmYWlsZWQuXCIpO1xuICAgIH1cbiAgICBpZiAobXNnLmluY2x1ZGVzKFwiVmFsaWRhdGlvbkV4Y2VwdGlvblwiKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQVdTIEJlZHJvY2sgdmFsaWRhdGlvbiBlcnJvcjogXCIgKyBtc2cpO1xuICAgIH1cbiAgICBpZiAobXNnLmluY2x1ZGVzKFwiTW9kZWxOb3RSZWFkeUV4Y2VwdGlvblwiKSB8fCBtc2cuaW5jbHVkZXMoXCJUaHJvdHRsaW5nRXhjZXB0aW9uXCIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBV1MgQmVkcm9jayB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS5cIik7XG4gICAgfVxuICAgIGlmIChtc2cuaW5jbHVkZXMoXCJBY2Nlc3NEZW5pZWRFeGNlcHRpb25cIikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlBlcm1pc3Npb24gZGVuaWVkIGZvciBBV1MgQmVkcm9jay5cIik7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiTWVkaWNhbCByZWNvcmQgcHJvY2Vzc2luZyBmYWlsZWQ6IFwiICsgbXNnKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkJlZHJvY2tSdW50aW1lQ2xpZW50IiwiSW52b2tlTW9kZWxDb21tYW5kIiwiYmVkcm9ja0NsaWVudCIsInJlZ2lvbiIsInByb2Nlc3MiLCJlbnYiLCJBV1NfUkVHSU9OIiwiQVdTX0JFRFJPQ0tfUkVHSU9OIiwiY3JlZGVudGlhbHMiLCJhY2Nlc3NLZXlJZCIsIkFXU19CRURST0NLX0FDQ0VTU19LRVlfSUQiLCJBV1NfQUNDRVNTX0tFWV9JRCIsInNlY3JldEFjY2Vzc0tleSIsIkFXU19CRURST0NLX1NFQ1JFVF9BQ0NFU1NfS0VZIiwiQVdTX1NFQ1JFVF9BQ0NFU1NfS0VZIiwiQ0xBVURFX1NPTk5FVF9QUk9GSUxFX0FSTiIsIkJFRFJPQ0tfUFJPRklMRV9BUk4iLCJDTEFVREVfT1BVU19QUk9GSUxFX0FSTiIsIkJFRFJPQ0tfT1BVU19QUk9GSUxFX0FSTiIsIkNMQVVERV9TT05ORVRfTU9ERUxfSUQiLCJDTEFVREVfT1BVU19NT0RFTF9JRCIsImRlaWRlbnRpZnlNZWRpY2FsUmVjb3JkIiwicmVjb3JkIiwiZGVpZGVudGlmaWVkIiwicGhpUGF0dGVybnMiLCJmb3JFYWNoIiwicGF0dGVybiIsInJlcGxhY2UiLCJjcmVhdGVNZWRpY2FsUHJvY2Vzc2luZ1Byb21wdCIsInByb2Nlc3NNZWRpY2FsUmVjb3JkV2l0aENsYXVkZSIsInJlcXVlc3QiLCJzYWZlUmVjb3JkIiwiZGVpZGVudGlmaWVkRGF0YSIsIm1lZGljYWxSZWNvcmQiLCJyZWNvcmRGb3JEZXRlY3Rpb24iLCJ0b0xvd2VyQ2FzZSIsInByb21wdCIsIm1vZGVsSWQiLCJtYXhUb2tlbnMiLCJ0ZW1wZXJhdHVyZSIsImlzQ29tcGxleENhc2UiLCJsZW5ndGgiLCJpbmNsdWRlcyIsImNvbnNvbGUiLCJsb2ciLCJyZXNvbHZlZE1vZGVsSWQiLCJpbnB1dCIsImNvbnRlbnRUeXBlIiwiYWNjZXB0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhbnRocm9waWNfdmVyc2lvbiIsIm1heF90b2tlbnMiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwiY29tbWFuZCIsInJlc3BvbnNlIiwic2VuZCIsInJhd1RleHQiLCJ0cmFuc2Zvcm1Ub0J5dGVBcnJheSIsIlRleHREZWNvZGVyIiwiZGVjb2RlIiwiVWludDhBcnJheSIsIlN0cmluZyIsInJlc3BvbnNlQm9keSIsInBhcnNlIiwiY2xhdWRlUmVzcG9uc2UiLCJ0ZXh0IiwiY2xlYW5lZCIsInRyaW0iLCJwYXJzZWQiLCJlcnIiLCJlcnJvciIsInN1YnN0cmluZyIsIkVycm9yIiwiY2F0ZWdvcmllcyIsIkFycmF5IiwiaXNBcnJheSIsInJlcG9ydERhdGUiLCJjb25maWRlbmNlIiwibXNnIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./bedrock-config.ts/bedrock-config.ts\n");

/***/ }),

/***/ "(rsc)/./src/app/api/ocr-menus/route.ts":
/*!****************************************!*\
  !*** ./src/app/api/ocr-menus/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _services_ocr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../services/ocr */ \"(rsc)/./src/services/ocr.ts\");\n/* harmony import */ var _services_aiExtractor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../services/aiExtractor */ \"(rsc)/./src/services/aiExtractor.ts\");\n/* harmony import */ var _services_normalizer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../services/normalizer */ \"(rsc)/./src/services/normalizer.ts\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_5__);\n// src/app/api/ocr-menus/route.ts\n\n\n\n\n\n\n\nconst OCR_OUTPUT_DIR = (0,path__WEBPACK_IMPORTED_MODULE_5__.join)(process.cwd(), \"ocr_outputs\");\n/**\r\n * POST /api/ocr-menus\r\n * -------------------\r\n * 1. Accepts PDF / image uploads (FormData: file or files[]).\r\n * 2. Runs OCR + Bedrock extraction.\r\n * 3. Normalizes & validates packages.\r\n * 4. Returns JSON with { success, batch_id, files, packages, summary }.\r\n * 5. âœ… Also saves the same JSON payload as a pretty-printed file:\r\n *      ./ocr_outputs/<batch_id>.json\r\n */ async function POST(req) {\n    try {\n        // 1) Upload + OCR\n        const { batchId, ocrPages, filesMeta } = await (0,_services_ocr__WEBPACK_IMPORTED_MODULE_1__.handleUploadAndExtractOcr)(req);\n        // 2) AI extraction â†’ raw PackageRow[]\n        const extractedPackages = await (0,_services_aiExtractor__WEBPACK_IMPORTED_MODULE_2__.extractPackagesFromOcrText)(ocrPages);\n        // 3) Normalise + validate\n        const normalizedPackages = extractedPackages.map((pkg)=>(0,_services_normalizer__WEBPACK_IMPORTED_MODULE_3__.normalizePackageRow)(pkg));\n        const { validPackages, packagesWithWarnings, invalidPackages } = (0,_services_normalizer__WEBPACK_IMPORTED_MODULE_3__.validatePackageBatch)(normalizedPackages);\n        const summary = {\n            total: normalizedPackages.length,\n            valid: validPackages.length,\n            withWarnings: packagesWithWarnings.length,\n            invalid: invalidPackages.length\n        };\n        const responseBody = {\n            success: true,\n            batch_id: batchId,\n            files: filesMeta,\n            packages: normalizedPackages,\n            summary\n        };\n        // 4) âœ… Persist a pretty-printed JSON snapshot to ./ocr_outputs/<batch_id>.json\n        await persistOcrResult(batchId, responseBody);\n        // 5) Return JSON response as usual\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(responseBody, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"OCR menu processing failed:\", error);\n        const message = error?.message || \"OCR / AI extraction failed. Please try again.\";\n        const status = typeof error?.status === \"number\" ? error.status : 500;\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            message\n        }, {\n            status\n        });\n    }\n}\n// ---------------------------------------------------------------------------\n// Helper: Save OCR result as pretty-printed JSON\n// ---------------------------------------------------------------------------\nasync function persistOcrResult(batchId, data) {\n    try {\n        // Ensure ./ocr_outputs exists\n        (0,fs__WEBPACK_IMPORTED_MODULE_4__.mkdirSync)(OCR_OUTPUT_DIR, {\n            recursive: true\n        });\n        // File name: <batch_id>.json\n        const filePath = (0,path__WEBPACK_IMPORTED_MODULE_5__.join)(OCR_OUTPUT_DIR, `${batchId}.json`);\n        // Pretty-printed JSON with 2-space indent\n        const json = JSON.stringify(data, null, 2);\n        await fs__WEBPACK_IMPORTED_MODULE_4__.promises.writeFile(filePath, json, \"utf8\");\n        console.log(`[OCR] Saved JSON snapshot â†’ ${filePath}`);\n    } catch (err) {\n        // Don't crash the request if file writing fails â€“ just log it\n        console.error(\"Failed to persist OCR JSON result:\", err);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9vY3ItbWVudXMvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsaUNBQWlDO0FBQ3VCO0FBQ1U7QUFDUztBQUtyQztBQUVGO0FBQ0w7QUFDSDtBQUU1QixNQUFNUyxpQkFBaUJELDBDQUFJQSxDQUFDRSxRQUFRQyxHQUFHLElBQUk7QUFDM0M7Ozs7Ozs7OztDQVNDLEdBQ00sZUFBZUMsS0FBS0MsR0FBZ0I7SUFDekMsSUFBSTtRQUNGLGtCQUFrQjtRQUNsQixNQUFNLEVBQUVDLE9BQU8sRUFBRUMsUUFBUSxFQUFFQyxTQUFTLEVBQUUsR0FBRyxNQUFNZix3RUFBeUJBLENBQUNZO1FBRXpFLHNDQUFzQztRQUN0QyxNQUFNSSxvQkFBb0IsTUFBTWYsaUZBQTBCQSxDQUFDYTtRQUUzRCwwQkFBMEI7UUFDMUIsTUFBTUcscUJBQW1DRCxrQkFBa0JFLEdBQUcsQ0FBQyxDQUFDQyxNQUM5RGpCLHlFQUFtQkEsQ0FBQ2lCO1FBR3RCLE1BQU0sRUFBRUMsYUFBYSxFQUFFQyxvQkFBb0IsRUFBRUMsZUFBZSxFQUFFLEdBQzVEbkIsMEVBQW9CQSxDQUFDYztRQUV2QixNQUFNTSxVQUFVO1lBQ2RDLE9BQU9QLG1CQUFtQlEsTUFBTTtZQUNoQ0MsT0FBT04sY0FBY0ssTUFBTTtZQUMzQkUsY0FBY04scUJBQXFCSSxNQUFNO1lBQ3pDRyxTQUFTTixnQkFBZ0JHLE1BQU07UUFDakM7UUFFQSxNQUFNSSxlQUFlO1lBQ25CQyxTQUFTO1lBQ1RDLFVBQVVsQjtZQUNWbUIsT0FBT2pCO1lBQ1BrQixVQUFVaEI7WUFDVk07UUFDRjtRQUVBLCtFQUErRTtRQUMvRSxNQUFNVyxpQkFBaUJyQixTQUFTZ0I7UUFFaEMsbUNBQW1DO1FBQ25DLE9BQU85QixxREFBWUEsQ0FBQ29DLElBQUksQ0FBQ04sY0FBYztZQUFFTyxRQUFRO1FBQUk7SUFDdkQsRUFBRSxPQUFPQyxPQUFZO1FBQ25CQyxRQUFRRCxLQUFLLENBQUMsK0JBQStCQTtRQUM3QyxNQUFNRSxVQUNKRixPQUFPRSxXQUFXO1FBRXBCLE1BQU1ILFNBQVMsT0FBT0MsT0FBT0QsV0FBVyxXQUFXQyxNQUFNRCxNQUFNLEdBQUc7UUFFbEUsT0FBT3JDLHFEQUFZQSxDQUFDb0MsSUFBSSxDQUN0QjtZQUNFTCxTQUFTO1lBQ1RTO1FBQ0YsR0FDQTtZQUFFSDtRQUFPO0lBRWI7QUFDRjtBQUVBLDhFQUE4RTtBQUM5RSxpREFBaUQ7QUFDakQsOEVBQThFO0FBQzlFLGVBQWVGLGlCQUFpQnJCLE9BQWUsRUFBRTJCLElBQVM7SUFDeEQsSUFBSTtRQUNGLDhCQUE4QjtRQUM5QmxDLDZDQUFTQSxDQUFDRSxnQkFBZ0I7WUFBRWlDLFdBQVc7UUFBSztRQUU1Qyw2QkFBNkI7UUFDN0IsTUFBTUMsV0FBV25DLDBDQUFJQSxDQUFDQyxnQkFBZ0IsQ0FBQyxFQUFFSyxRQUFRLEtBQUssQ0FBQztRQUV2RCwwQ0FBMEM7UUFDMUMsTUFBTXNCLE9BQU9RLEtBQUtDLFNBQVMsQ0FBQ0osTUFBTSxNQUFNO1FBRXhDLE1BQU1uQyx3Q0FBRUEsQ0FBQ3dDLFNBQVMsQ0FBQ0gsVUFBVVAsTUFBTTtRQUNuQ0csUUFBUVEsR0FBRyxDQUFDLENBQUMsNEJBQTRCLEVBQUVKLFNBQVMsQ0FBQztJQUN2RCxFQUFFLE9BQU9LLEtBQUs7UUFDWiw4REFBOEQ7UUFDOURULFFBQVFELEtBQUssQ0FBQyxzQ0FBc0NVO0lBQ3REO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZW1lZGljYS1jbGluaWMtb2NyLy4vc3JjL2FwcC9hcGkvb2NyLW1lbnVzL3JvdXRlLnRzP2IwMTYiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2FwcC9hcGkvb2NyLW1lbnVzL3JvdXRlLnRzXHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgaGFuZGxlVXBsb2FkQW5kRXh0cmFjdE9jciB9IGZyb20gXCIuLi8uLi8uLi9zZXJ2aWNlcy9vY3JcIjtcclxuaW1wb3J0IHsgZXh0cmFjdFBhY2thZ2VzRnJvbU9jclRleHQgfSBmcm9tIFwiLi4vLi4vLi4vc2VydmljZXMvYWlFeHRyYWN0b3JcIjtcclxuaW1wb3J0IHsgUGFja2FnZVJvd30gZnJvbSBcIkAvbGliL3R5cGVzL29jclwiO1xyXG5pbXBvcnQge1xyXG4gIG5vcm1hbGl6ZVBhY2thZ2VSb3csXHJcbiAgdmFsaWRhdGVQYWNrYWdlQmF0Y2gsXHJcbn0gZnJvbSBcIi4uLy4uLy4uL3NlcnZpY2VzL25vcm1hbGl6ZXJcIjtcclxuXHJcbmltcG9ydCB7IHByb21pc2VzIGFzIGZzIH0gZnJvbSBcImZzXCI7XHJcbmltcG9ydCB7IG1rZGlyU3luYyB9IGZyb20gXCJmc1wiO1xyXG5pbXBvcnQgeyBqb2luIH0gZnJvbSBcInBhdGhcIjtcclxuXHJcbmNvbnN0IE9DUl9PVVRQVVRfRElSID0gam9pbihwcm9jZXNzLmN3ZCgpLCBcIm9jcl9vdXRwdXRzXCIpO1xyXG4vKipcclxuICogUE9TVCAvYXBpL29jci1tZW51c1xyXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqIDEuIEFjY2VwdHMgUERGIC8gaW1hZ2UgdXBsb2FkcyAoRm9ybURhdGE6IGZpbGUgb3IgZmlsZXNbXSkuXHJcbiAqIDIuIFJ1bnMgT0NSICsgQmVkcm9jayBleHRyYWN0aW9uLlxyXG4gKiAzLiBOb3JtYWxpemVzICYgdmFsaWRhdGVzIHBhY2thZ2VzLlxyXG4gKiA0LiBSZXR1cm5zIEpTT04gd2l0aCB7IHN1Y2Nlc3MsIGJhdGNoX2lkLCBmaWxlcywgcGFja2FnZXMsIHN1bW1hcnkgfS5cclxuICogNS4g4pyFIEFsc28gc2F2ZXMgdGhlIHNhbWUgSlNPTiBwYXlsb2FkIGFzIGEgcHJldHR5LXByaW50ZWQgZmlsZTpcclxuICogICAgICAuL29jcl9vdXRwdXRzLzxiYXRjaF9pZD4uanNvblxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyAxKSBVcGxvYWQgKyBPQ1JcclxuICAgIGNvbnN0IHsgYmF0Y2hJZCwgb2NyUGFnZXMsIGZpbGVzTWV0YSB9ID0gYXdhaXQgaGFuZGxlVXBsb2FkQW5kRXh0cmFjdE9jcihyZXEpO1xyXG5cclxuICAgIC8vIDIpIEFJIGV4dHJhY3Rpb24g4oaSIHJhdyBQYWNrYWdlUm93W11cclxuICAgIGNvbnN0IGV4dHJhY3RlZFBhY2thZ2VzID0gYXdhaXQgZXh0cmFjdFBhY2thZ2VzRnJvbU9jclRleHQob2NyUGFnZXMpO1xyXG5cclxuICAgIC8vIDMpIE5vcm1hbGlzZSArIHZhbGlkYXRlXHJcbiAgICBjb25zdCBub3JtYWxpemVkUGFja2FnZXM6IFBhY2thZ2VSb3dbXSA9IGV4dHJhY3RlZFBhY2thZ2VzLm1hcCgocGtnKSA9PlxyXG4gICAgICBub3JtYWxpemVQYWNrYWdlUm93KHBrZylcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgeyB2YWxpZFBhY2thZ2VzLCBwYWNrYWdlc1dpdGhXYXJuaW5ncywgaW52YWxpZFBhY2thZ2VzIH0gPVxyXG4gICAgICB2YWxpZGF0ZVBhY2thZ2VCYXRjaChub3JtYWxpemVkUGFja2FnZXMpO1xyXG5cclxuICAgIGNvbnN0IHN1bW1hcnkgPSB7XHJcbiAgICAgIHRvdGFsOiBub3JtYWxpemVkUGFja2FnZXMubGVuZ3RoLFxyXG4gICAgICB2YWxpZDogdmFsaWRQYWNrYWdlcy5sZW5ndGgsXHJcbiAgICAgIHdpdGhXYXJuaW5nczogcGFja2FnZXNXaXRoV2FybmluZ3MubGVuZ3RoLFxyXG4gICAgICBpbnZhbGlkOiBpbnZhbGlkUGFja2FnZXMubGVuZ3RoLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCByZXNwb25zZUJvZHkgPSB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGJhdGNoX2lkOiBiYXRjaElkLFxyXG4gICAgICBmaWxlczogZmlsZXNNZXRhLFxyXG4gICAgICBwYWNrYWdlczogbm9ybWFsaXplZFBhY2thZ2VzLFxyXG4gICAgICBzdW1tYXJ5LFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyA0KSDinIUgUGVyc2lzdCBhIHByZXR0eS1wcmludGVkIEpTT04gc25hcHNob3QgdG8gLi9vY3Jfb3V0cHV0cy88YmF0Y2hfaWQ+Lmpzb25cclxuICAgIGF3YWl0IHBlcnNpc3RPY3JSZXN1bHQoYmF0Y2hJZCwgcmVzcG9uc2VCb2R5KTtcclxuXHJcbiAgICAvLyA1KSBSZXR1cm4gSlNPTiByZXNwb25zZSBhcyB1c3VhbFxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlQm9keSwgeyBzdGF0dXM6IDIwMCB9KTtcclxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiT0NSIG1lbnUgcHJvY2Vzc2luZyBmYWlsZWQ6XCIsIGVycm9yKTtcclxuICAgIGNvbnN0IG1lc3NhZ2UgPVxyXG4gICAgICBlcnJvcj8ubWVzc2FnZSB8fCBcIk9DUiAvIEFJIGV4dHJhY3Rpb24gZmFpbGVkLiBQbGVhc2UgdHJ5IGFnYWluLlwiO1xyXG5cclxuICAgIGNvbnN0IHN0YXR1cyA9IHR5cGVvZiBlcnJvcj8uc3RhdHVzID09PSBcIm51bWJlclwiID8gZXJyb3Iuc3RhdHVzIDogNTAwO1xyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAge1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2UsXHJcbiAgICAgIH0sXHJcbiAgICAgIHsgc3RhdHVzIH1cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gSGVscGVyOiBTYXZlIE9DUiByZXN1bHQgYXMgcHJldHR5LXByaW50ZWQgSlNPTlxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuYXN5bmMgZnVuY3Rpb24gcGVyc2lzdE9jclJlc3VsdChiYXRjaElkOiBzdHJpbmcsIGRhdGE6IGFueSkge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBFbnN1cmUgLi9vY3Jfb3V0cHV0cyBleGlzdHNcclxuICAgIG1rZGlyU3luYyhPQ1JfT1VUUFVUX0RJUiwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcblxyXG4gICAgLy8gRmlsZSBuYW1lOiA8YmF0Y2hfaWQ+Lmpzb25cclxuICAgIGNvbnN0IGZpbGVQYXRoID0gam9pbihPQ1JfT1VUUFVUX0RJUiwgYCR7YmF0Y2hJZH0uanNvbmApO1xyXG5cclxuICAgIC8vIFByZXR0eS1wcmludGVkIEpTT04gd2l0aCAyLXNwYWNlIGluZGVudFxyXG4gICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpO1xyXG5cclxuICAgIGF3YWl0IGZzLndyaXRlRmlsZShmaWxlUGF0aCwganNvbiwgXCJ1dGY4XCIpO1xyXG4gICAgY29uc29sZS5sb2coYFtPQ1JdIFNhdmVkIEpTT04gc25hcHNob3Qg4oaSICR7ZmlsZVBhdGh9YCk7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAvLyBEb24ndCBjcmFzaCB0aGUgcmVxdWVzdCBpZiBmaWxlIHdyaXRpbmcgZmFpbHMg4oCTIGp1c3QgbG9nIGl0XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHBlcnNpc3QgT0NSIEpTT04gcmVzdWx0OlwiLCBlcnIpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiaGFuZGxlVXBsb2FkQW5kRXh0cmFjdE9jciIsImV4dHJhY3RQYWNrYWdlc0Zyb21PY3JUZXh0Iiwibm9ybWFsaXplUGFja2FnZVJvdyIsInZhbGlkYXRlUGFja2FnZUJhdGNoIiwicHJvbWlzZXMiLCJmcyIsIm1rZGlyU3luYyIsImpvaW4iLCJPQ1JfT1VUUFVUX0RJUiIsInByb2Nlc3MiLCJjd2QiLCJQT1NUIiwicmVxIiwiYmF0Y2hJZCIsIm9jclBhZ2VzIiwiZmlsZXNNZXRhIiwiZXh0cmFjdGVkUGFja2FnZXMiLCJub3JtYWxpemVkUGFja2FnZXMiLCJtYXAiLCJwa2ciLCJ2YWxpZFBhY2thZ2VzIiwicGFja2FnZXNXaXRoV2FybmluZ3MiLCJpbnZhbGlkUGFja2FnZXMiLCJzdW1tYXJ5IiwidG90YWwiLCJsZW5ndGgiLCJ2YWxpZCIsIndpdGhXYXJuaW5ncyIsImludmFsaWQiLCJyZXNwb25zZUJvZHkiLCJzdWNjZXNzIiwiYmF0Y2hfaWQiLCJmaWxlcyIsInBhY2thZ2VzIiwicGVyc2lzdE9jclJlc3VsdCIsImpzb24iLCJzdGF0dXMiLCJlcnJvciIsImNvbnNvbGUiLCJtZXNzYWdlIiwiZGF0YSIsInJlY3Vyc2l2ZSIsImZpbGVQYXRoIiwiSlNPTiIsInN0cmluZ2lmeSIsIndyaXRlRmlsZSIsImxvZyIsImVyciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/ocr-menus/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/validation.ts":
/*!*******************************!*\
  !*** ./src/lib/validation.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getFieldError: () => (/* binding */ getFieldError),\n/* harmony export */   isFieldInvalid: () => (/* binding */ isFieldInvalid),\n/* harmony export */   matchHospitalName: () => (/* binding */ matchHospitalName),\n/* harmony export */   matchTreatmentName: () => (/* binding */ matchTreatmentName),\n/* harmony export */   matchingReferenceData: () => (/* binding */ matchingReferenceData),\n/* harmony export */   validateAllRows: () => (/* binding */ validateAllRows),\n/* harmony export */   validateRow: () => (/* binding */ validateRow)\n/* harmony export */ });\n// src/lib/validation.ts\n// Shared validation + fuzzy matching for Clinic Menu OCR â†’ CSV\n/* -------------------------------------------------------------------------- */ /*  Curated reference data (hospital & treatment names)                       */ /* -------------------------------------------------------------------------- */ const HOSPITAL_NAMES = [\n    \"Bumrungrad Intl\",\n    \"Mery Plastic Surgery\",\n    \"Pruksa Clinic\",\n    \"SLC hospital\",\n    \"Panacee Medical Center\",\n    \"The Square Clinic\",\n    \"Vethjani Hospital\",\n    \"Phuket Plastic Surgery Institute\",\n    \"Wansiri Hospital\",\n    \"Prince Court\",\n    \"Raffles Medical\",\n    \"Sunway Medical Center\",\n    \"Thomson Hospital\",\n    \"China Medical University Hospital - ä¸­åœ‹é†«è—¥å¤§å­¸é™„è¨­é†«é™¢\"\n];\nconst TREATMENT_NAMES = [\n    \"Health Checkup\",\n    \"Cancer Screening\",\n    \"MRI Scan\",\n    \"CT Scan\",\n    \"PET-CT Scan\",\n    \"Blood Test\",\n    \"Cardiac Screening\",\n    \"Hip & Knee Replacement\",\n    \"Spinal Surgery\",\n    \"Brain Tumor Surgery\",\n    \"Heart Valve Repair\",\n    \"Kidney Transplant\",\n    \"Liver Transplant\",\n    \"LASIK Surgery\",\n    \"Cataract Surgery\",\n    \"Glaucoma Surgery\",\n    \"Gastric Sleeve\",\n    \"Gastric Bypass\",\n    \"Endoscopic Sleeve Gastroplasty\",\n    \"Gender-Affirming Surgery\",\n    \"Pacemaker Implantation\",\n    \"Prostate Surgery\",\n    \"Vasectomy Reversal\",\n    \"Hysterectomy\",\n    \"Fibroid Removal\",\n    \"Corneal Transplant\",\n    \"Deep Brain Stimulation (DBS)\",\n    \"Epilepsy Surgery\",\n    \"Spinal Cord Surgery\",\n    \"Facial Plastic Surgery\",\n    \"Breast Augmentation\",\n    \"Rhinoplasty\",\n    \"Liposuction\",\n    \"Botox Treatment\",\n    \"Dermal Fillers\",\n    \"Hair Transplant\",\n    \"Laser Resurfacing\",\n    \"Buccal Fat Removal\",\n    \"Chin Augmentation\",\n    \"Teeth Whitening\",\n    \"Veneer\",\n    \"Dental Implants\",\n    \"Root Canal\",\n    \"IVF (In Vitro Fertilization)\",\n    \"IUI (Intrauterine Insemination)\",\n    \"Egg Freezing\",\n    \"HRT (Hormone Replacement Therapy)\",\n    \"Chemotherapy\",\n    \"Radiation Therapy\",\n    \"Immunotherapy\",\n    \"Proton Therapy\",\n    \"Detox Retreats\",\n    \"IV Therapy\",\n    \"Anti-Aging Therapy\",\n    \"Physiotherapy\",\n    \"Acupuncture\",\n    \"Ayurveda\",\n    \"Thai Massage\"\n];\nconst MIN_HOSPITAL_SCORE = 0.72;\nconst MIN_TREATMENT_SCORE = 0.7;\nconst matchingReferenceData = {\n    hospitals: HOSPITAL_NAMES,\n    treatments: TREATMENT_NAMES\n};\n/* -------------------------------------------------------------------------- */ /*  Fuzzy matching helpers (Levenshtein-based)                                */ /* -------------------------------------------------------------------------- */ function normalize(value) {\n    return value.toLowerCase().replace(/[^a-z0-9]+/g, \"\").trim();\n}\nfunction levenshtein(a, b) {\n    if (a === b) return 0;\n    if (!a.length) return b.length;\n    if (!b.length) return a.length;\n    const matrix = Array.from({\n        length: a.length + 1\n    }, (_, i)=>Array.from({\n            length: b.length + 1\n        }, (_, j)=>i === 0 ? j : j === 0 ? i : 0));\n    for(let i = 1; i <= a.length; i++){\n        for(let j = 1; j <= b.length; j++){\n            if (a[i - 1] === b[j - 1]) {\n                matrix[i][j] = matrix[i - 1][j - 1];\n            } else {\n                matrix[i][j] = Math.min(matrix[i - 1][j], matrix[i][j - 1], matrix[i - 1][j - 1]) + 1;\n            }\n        }\n    }\n    return matrix[a.length][b.length];\n}\nfunction similarityScore(source, candidate) {\n    if (!source || !candidate) return 0;\n    const normalizedSource = normalize(source);\n    const normalizedCandidate = normalize(candidate);\n    if (!normalizedSource.length || !normalizedCandidate.length) return 0;\n    const distance = levenshtein(normalizedSource, normalizedCandidate);\n    const longest = Math.max(normalizedSource.length, normalizedCandidate.length);\n    return 1 - distance / longest;\n}\n/**\n * Fuzzy match a raw hospital name against the curated list.\n */ function matchHospitalName(raw) {\n    if (!raw?.trim()) {\n        return {\n            value: null,\n            score: 0\n        };\n    }\n    let bestMatch = {\n        value: null,\n        score: 0\n    };\n    for (const hospital of HOSPITAL_NAMES){\n        const score = similarityScore(raw, hospital);\n        if (score > bestMatch.score) {\n            bestMatch = {\n                value: hospital,\n                score\n            };\n        }\n    }\n    if (bestMatch.score < MIN_HOSPITAL_SCORE) {\n        return {\n            value: null,\n            score: bestMatch.score\n        };\n    }\n    return bestMatch;\n}\n/**\n * Fuzzy match a raw treatment name against the curated list.\n */ function matchTreatmentName(raw) {\n    if (!raw?.trim()) {\n        return {\n            value: null,\n            score: 0\n        };\n    }\n    let bestMatch = {\n        value: null,\n        score: 0\n    };\n    for (const treatment of TREATMENT_NAMES){\n        const score = similarityScore(raw, treatment);\n        if (score > bestMatch.score) {\n            bestMatch = {\n                value: treatment,\n                score\n            };\n        }\n    }\n    if (bestMatch.score < MIN_TREATMENT_SCORE) {\n        return {\n            value: null,\n            score: bestMatch.score\n        };\n    }\n    return bestMatch;\n}\n/* -------------------------------------------------------------------------- */ /*  Client-side row validation (for the table UI)                             */ /* -------------------------------------------------------------------------- */ const REQUIRED_FIELDS = [\n    \"title\",\n    \"hospital_name\",\n    \"treatment_name\",\n    \"price\",\n    \"currency\"\n];\nfunction validateRow(row) {\n    const errors = [];\n    // Required: title\n    if (!row.title?.trim()) {\n        errors.push({\n            field: \"title\",\n            message: \"Title is required\"\n        });\n    }\n    // Required: hospital_name\n    if (!row.hospital_name?.trim()) {\n        errors.push({\n            field: \"hospital_name\",\n            message: \"Hospital name is required\"\n        });\n    }\n    // Required: treatment_name\n    if (!row.treatment_name?.trim()) {\n        errors.push({\n            field: \"treatment_name\",\n            message: \"Treatment name is required\"\n        });\n    }\n    // Required: price\n    if (row.price === null || row.price === undefined) {\n        errors.push({\n            field: \"price\",\n            message: \"Price is required\"\n        });\n    } else if (isNaN(Number(row.price)) || Number(row.price) < 0) {\n        errors.push({\n            field: \"price\",\n            message: \"Price must be a valid positive number\"\n        });\n    }\n    // Required: currency\n    if (!row.currency?.trim()) {\n        errors.push({\n            field: \"currency\",\n            message: \"Currency is required\"\n        });\n    }\n    // Optional: commission 0â€“100\n    if (row.commission !== null && row.commission !== undefined) {\n        const num = Number(row.commission);\n        if (isNaN(num) || num < 0 || num > 100) {\n            errors.push({\n                field: \"commission\",\n                message: \"Commission must be between 0 and 100\"\n            });\n        }\n    }\n    // Optional: original_price >= 0\n    if (row.original_price !== null && row.original_price !== undefined) {\n        const num = Number(row.original_price);\n        if (isNaN(num) || num < 0) {\n            errors.push({\n                field: \"original_price\",\n                message: \"Original price must be a valid positive number\"\n            });\n        }\n    }\n    return {\n        rowId: row.id || \"\",\n        isValid: errors.length === 0,\n        errors\n    };\n}\nfunction validateAllRows(rows) {\n    const validations = new Map();\n    let valid = 0;\n    let invalid = 0;\n    let withWarnings = 0;\n    rows.forEach((row, index)=>{\n        // Generate a stable row key even if backend did not send an id\n        const rowId = row.id ?? `row_${index}`;\n        // Run validation on the row; RowValidation.rowId will be overwritten below\n        const baseValidation = validateRow(row);\n        const validation = {\n            ...baseValidation,\n            rowId\n        };\n        validations.set(rowId, validation);\n        if (validation.isValid) {\n            valid++;\n        } else {\n            invalid++;\n        }\n        if (row._meta?.warnings && row._meta.warnings.length > 0) {\n            withWarnings++;\n        }\n    });\n    return {\n        validations,\n        summary: {\n            valid,\n            invalid,\n            withWarnings\n        }\n    };\n}\nfunction getFieldError(validations, rowId, field) {\n    const rowValidation = validations.get(rowId);\n    if (!rowValidation) return undefined;\n    const error = rowValidation.errors.find((e)=>e.field === field);\n    return error?.message;\n}\nfunction isFieldInvalid(validations, rowId, field) {\n    return !!getFieldError(validations, rowId, field);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eEIsSUFBSStCLEtBQUssRUFBRUMsWUFBWWhDLElBQUkrQixLQUFLLENBQUNDLFFBQVEsQ0FBQzFELE1BQU0sR0FBRyxHQUFHO1lBQ3hEbUQ7UUFDRjtJQUNGO0lBRUEsT0FBTztRQUNMSjtRQUNBWSxTQUFTO1lBQUVWO1lBQU9DO1lBQVNDO1FBQWE7SUFDMUM7QUFDRjtBQUNPLFNBQVNTLGNBQ2RiLFdBQXVDLEVBQ3ZDTCxLQUFhLEVBQ2JaLEtBQWE7SUFFYixNQUFNK0IsZ0JBQWdCZCxZQUFZZSxHQUFHLENBQUNwQjtJQUN0QyxJQUFJLENBQUNtQixlQUFlLE9BQU8xQjtJQUMzQixNQUFNNEIsUUFBUUYsY0FBY2xDLE1BQU0sQ0FBQ3FDLElBQUksQ0FBQyxDQUFDQyxJQUFNQSxFQUFFbkMsS0FBSyxLQUFLQTtJQUMzRCxPQUFPaUMsT0FBT2hDO0FBQ2hCO0FBRU8sU0FBU21DLGVBQ2RuQixXQUF1QyxFQUN2Q0wsS0FBYSxFQUNiWixLQUFhO0lBRWIsT0FBTyxDQUFDLENBQUM4QixjQUFjYixhQUFhTCxPQUFPWjtBQUM3QyIsInNvdXJjZXMiOlsid2VicGFjazovL2xlbWVkaWNhLWNsaW5pYy1vY3IvLi9zcmMvbGliL3ZhbGlkYXRpb24udHM/NDYwZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvbGliL3ZhbGlkYXRpb24udHNcbi8vIFNoYXJlZCB2YWxpZGF0aW9uICsgZnV6enkgbWF0Y2hpbmcgZm9yIENsaW5pYyBNZW51IE9DUiDihpIgQ1NWXG5cbmltcG9ydCB0eXBlIHsgUGFja2FnZVJvdywgUm93VmFsaWRhdGlvbiwgVmFsaWRhdGlvbkVycm9yIH0gZnJvbSBcIkAvbGliL3R5cGVzL29jclwiO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogIEN1cmF0ZWQgcmVmZXJlbmNlIGRhdGEgKGhvc3BpdGFsICYgdHJlYXRtZW50IG5hbWVzKSAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmNvbnN0IEhPU1BJVEFMX05BTUVTID0gW1xuICBcIkJ1bXJ1bmdyYWQgSW50bFwiLFxuICBcIk1lcnkgUGxhc3RpYyBTdXJnZXJ5XCIsXG4gIFwiUHJ1a3NhIENsaW5pY1wiLFxuICBcIlNMQyBob3NwaXRhbFwiLFxuICBcIlBhbmFjZWUgTWVkaWNhbCBDZW50ZXJcIixcbiAgXCJUaGUgU3F1YXJlIENsaW5pY1wiLFxuICBcIlZldGhqYW5pIEhvc3BpdGFsXCIsXG4gIFwiUGh1a2V0IFBsYXN0aWMgU3VyZ2VyeSBJbnN0aXR1dGVcIixcbiAgXCJXYW5zaXJpIEhvc3BpdGFsXCIsXG4gIFwiUHJpbmNlIENvdXJ0XCIsXG4gIFwiUmFmZmxlcyBNZWRpY2FsXCIsXG4gIFwiU3Vud2F5IE1lZGljYWwgQ2VudGVyXCIsXG4gIFwiVGhvbXNvbiBIb3NwaXRhbFwiLFxuICBcIkNoaW5hIE1lZGljYWwgVW5pdmVyc2l0eSBIb3NwaXRhbCAtIOS4reWci+mGq+iXpeWkp+WtuOmZhOioremGq+mZolwiLFxuXTtcblxuY29uc3QgVFJFQVRNRU5UX05BTUVTID0gW1xuICBcIkhlYWx0aCBDaGVja3VwXCIsXG4gIFwiQ2FuY2VyIFNjcmVlbmluZ1wiLFxuICBcIk1SSSBTY2FuXCIsXG4gIFwiQ1QgU2NhblwiLFxuICBcIlBFVC1DVCBTY2FuXCIsXG4gIFwiQmxvb2QgVGVzdFwiLFxuICBcIkNhcmRpYWMgU2NyZWVuaW5nXCIsXG4gIFwiSGlwICYgS25lZSBSZXBsYWNlbWVudFwiLFxuICBcIlNwaW5hbCBTdXJnZXJ5XCIsXG4gIFwiQnJhaW4gVHVtb3IgU3VyZ2VyeVwiLFxuICBcIkhlYXJ0IFZhbHZlIFJlcGFpclwiLFxuICBcIktpZG5leSBUcmFuc3BsYW50XCIsXG4gIFwiTGl2ZXIgVHJhbnNwbGFudFwiLFxuICBcIkxBU0lLIFN1cmdlcnlcIixcbiAgXCJDYXRhcmFjdCBTdXJnZXJ5XCIsXG4gIFwiR2xhdWNvbWEgU3VyZ2VyeVwiLFxuICBcIkdhc3RyaWMgU2xlZXZlXCIsXG4gIFwiR2FzdHJpYyBCeXBhc3NcIixcbiAgXCJFbmRvc2NvcGljIFNsZWV2ZSBHYXN0cm9wbGFzdHlcIixcbiAgXCJHZW5kZXItQWZmaXJtaW5nIFN1cmdlcnlcIixcbiAgXCJQYWNlbWFrZXIgSW1wbGFudGF0aW9uXCIsXG4gIFwiUHJvc3RhdGUgU3VyZ2VyeVwiLFxuICBcIlZhc2VjdG9teSBSZXZlcnNhbFwiLFxuICBcIkh5c3RlcmVjdG9teVwiLFxuICBcIkZpYnJvaWQgUmVtb3ZhbFwiLFxuICBcIkNvcm5lYWwgVHJhbnNwbGFudFwiLFxuICBcIkRlZXAgQnJhaW4gU3RpbXVsYXRpb24gKERCUylcIixcbiAgXCJFcGlsZXBzeSBTdXJnZXJ5XCIsXG4gIFwiU3BpbmFsIENvcmQgU3VyZ2VyeVwiLFxuICBcIkZhY2lhbCBQbGFzdGljIFN1cmdlcnlcIixcbiAgXCJCcmVhc3QgQXVnbWVudGF0aW9uXCIsXG4gIFwiUmhpbm9wbGFzdHlcIixcbiAgXCJMaXBvc3VjdGlvblwiLFxuICBcIkJvdG94IFRyZWF0bWVudFwiLFxuICBcIkRlcm1hbCBGaWxsZXJzXCIsXG4gIFwiSGFpciBUcmFuc3BsYW50XCIsXG4gIFwiTGFzZXIgUmVzdXJmYWNpbmdcIixcbiAgXCJCdWNjYWwgRmF0IFJlbW92YWxcIixcbiAgXCJDaGluIEF1Z21lbnRhdGlvblwiLFxuICBcIlRlZXRoIFdoaXRlbmluZ1wiLFxuICBcIlZlbmVlclwiLFxuICBcIkRlbnRhbCBJbXBsYW50c1wiLFxuICBcIlJvb3QgQ2FuYWxcIixcbiAgXCJJVkYgKEluIFZpdHJvIEZlcnRpbGl6YXRpb24pXCIsXG4gIFwiSVVJIChJbnRyYXV0ZXJpbmUgSW5zZW1pbmF0aW9uKVwiLFxuICBcIkVnZyBGcmVlemluZ1wiLFxuICBcIkhSVCAoSG9ybW9uZSBSZXBsYWNlbWVudCBUaGVyYXB5KVwiLFxuICBcIkNoZW1vdGhlcmFweVwiLFxuICBcIlJhZGlhdGlvbiBUaGVyYXB5XCIsXG4gIFwiSW1tdW5vdGhlcmFweVwiLFxuICBcIlByb3RvbiBUaGVyYXB5XCIsXG4gIFwiRGV0b3ggUmV0cmVhdHNcIixcbiAgXCJJViBUaGVyYXB5XCIsXG4gIFwiQW50aS1BZ2luZyBUaGVyYXB5XCIsXG4gIFwiUGh5c2lvdGhlcmFweVwiLFxuICBcIkFjdXB1bmN0dXJlXCIsXG4gIFwiQXl1cnZlZGFcIixcbiAgXCJUaGFpIE1hc3NhZ2VcIixcbl07XG5cbmNvbnN0IE1JTl9IT1NQSVRBTF9TQ09SRSA9IDAuNzI7XG5jb25zdCBNSU5fVFJFQVRNRU5UX1NDT1JFID0gMC43O1xuXG5leHBvcnQgY29uc3QgbWF0Y2hpbmdSZWZlcmVuY2VEYXRhID0ge1xuICBob3NwaXRhbHM6IEhPU1BJVEFMX05BTUVTLFxuICB0cmVhdG1lbnRzOiBUUkVBVE1FTlRfTkFNRVMsXG59O1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogIEZ1enp5IG1hdGNoaW5nIGhlbHBlcnMgKExldmVuc2h0ZWluLWJhc2VkKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZSh2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgcmV0dXJuIHZhbHVlLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTldKy9nLCBcIlwiKS50cmltKCk7XG59XG5cbmZ1bmN0aW9uIGxldmVuc2h0ZWluKGE6IHN0cmluZywgYjogc3RyaW5nKTogbnVtYmVyIHtcbiAgaWYgKGEgPT09IGIpIHJldHVybiAwO1xuICBpZiAoIWEubGVuZ3RoKSByZXR1cm4gYi5sZW5ndGg7XG4gIGlmICghYi5sZW5ndGgpIHJldHVybiBhLmxlbmd0aDtcblxuICBjb25zdCBtYXRyaXg6IG51bWJlcltdW10gPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBhLmxlbmd0aCArIDEgfSwgKF8sIGkpID0+XG4gICAgQXJyYXkuZnJvbSh7IGxlbmd0aDogYi5sZW5ndGggKyAxIH0sIChfLCBqKSA9PiAoaSA9PT0gMCA/IGogOiBqID09PSAwID8gaSA6IDApKSxcbiAgKTtcblxuICBmb3IgKGxldCBpID0gMTsgaSA8PSBhLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQgaiA9IDE7IGogPD0gYi5sZW5ndGg7IGorKykge1xuICAgICAgaWYgKGFbaSAtIDFdID09PSBiW2ogLSAxXSkge1xuICAgICAgICBtYXRyaXhbaV1bal0gPSBtYXRyaXhbaSAtIDFdW2ogLSAxXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1hdHJpeFtpXVtqXSA9XG4gICAgICAgICAgTWF0aC5taW4obWF0cml4W2kgLSAxXVtqXSwgbWF0cml4W2ldW2ogLSAxXSwgbWF0cml4W2kgLSAxXVtqIC0gMV0pICsgMTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbWF0cml4W2EubGVuZ3RoXVtiLmxlbmd0aF07XG59XG5cbmZ1bmN0aW9uIHNpbWlsYXJpdHlTY29yZShzb3VyY2U6IHN0cmluZywgY2FuZGlkYXRlOiBzdHJpbmcpOiBudW1iZXIge1xuICBpZiAoIXNvdXJjZSB8fCAhY2FuZGlkYXRlKSByZXR1cm4gMDtcbiAgY29uc3Qgbm9ybWFsaXplZFNvdXJjZSA9IG5vcm1hbGl6ZShzb3VyY2UpO1xuICBjb25zdCBub3JtYWxpemVkQ2FuZGlkYXRlID0gbm9ybWFsaXplKGNhbmRpZGF0ZSk7XG4gIGlmICghbm9ybWFsaXplZFNvdXJjZS5sZW5ndGggfHwgIW5vcm1hbGl6ZWRDYW5kaWRhdGUubGVuZ3RoKSByZXR1cm4gMDtcbiAgY29uc3QgZGlzdGFuY2UgPSBsZXZlbnNodGVpbihub3JtYWxpemVkU291cmNlLCBub3JtYWxpemVkQ2FuZGlkYXRlKTtcbiAgY29uc3QgbG9uZ2VzdCA9IE1hdGgubWF4KG5vcm1hbGl6ZWRTb3VyY2UubGVuZ3RoLCBub3JtYWxpemVkQ2FuZGlkYXRlLmxlbmd0aCk7XG4gIHJldHVybiAxIC0gZGlzdGFuY2UgLyBsb25nZXN0O1xufVxuXG4vKipcbiAqIEZ1enp5IG1hdGNoIGEgcmF3IGhvc3BpdGFsIG5hbWUgYWdhaW5zdCB0aGUgY3VyYXRlZCBsaXN0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hIb3NwaXRhbE5hbWUocmF3OiBzdHJpbmcpOiB7IHZhbHVlOiBzdHJpbmcgfCBudWxsOyBzY29yZTogbnVtYmVyIH0ge1xuICBpZiAoIXJhdz8udHJpbSgpKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IG51bGwsIHNjb3JlOiAwIH07XG4gIH1cblxuICBsZXQgYmVzdE1hdGNoOiB7IHZhbHVlOiBzdHJpbmcgfCBudWxsOyBzY29yZTogbnVtYmVyIH0gPSB7IHZhbHVlOiBudWxsLCBzY29yZTogMCB9O1xuXG4gIGZvciAoY29uc3QgaG9zcGl0YWwgb2YgSE9TUElUQUxfTkFNRVMpIHtcbiAgICBjb25zdCBzY29yZSA9IHNpbWlsYXJpdHlTY29yZShyYXcsIGhvc3BpdGFsKTtcbiAgICBpZiAoc2NvcmUgPiBiZXN0TWF0Y2guc2NvcmUpIHtcbiAgICAgIGJlc3RNYXRjaCA9IHsgdmFsdWU6IGhvc3BpdGFsLCBzY29yZSB9O1xuICAgIH1cbiAgfVxuXG4gIGlmIChiZXN0TWF0Y2guc2NvcmUgPCBNSU5fSE9TUElUQUxfU0NPUkUpIHtcbiAgICByZXR1cm4geyB2YWx1ZTogbnVsbCwgc2NvcmU6IGJlc3RNYXRjaC5zY29yZSB9O1xuICB9XG5cbiAgcmV0dXJuIGJlc3RNYXRjaDtcbn1cblxuLyoqXG4gKiBGdXp6eSBtYXRjaCBhIHJhdyB0cmVhdG1lbnQgbmFtZSBhZ2FpbnN0IHRoZSBjdXJhdGVkIGxpc3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXRjaFRyZWF0bWVudE5hbWUocmF3OiBzdHJpbmcpOiB7IHZhbHVlOiBzdHJpbmcgfCBudWxsOyBzY29yZTogbnVtYmVyIH0ge1xuICBpZiAoIXJhdz8udHJpbSgpKSB7XG4gICAgcmV0dXJuIHsgdmFsdWU6IG51bGwsIHNjb3JlOiAwIH07XG4gIH1cblxuICBsZXQgYmVzdE1hdGNoOiB7IHZhbHVlOiBzdHJpbmcgfCBudWxsOyBzY29yZTogbnVtYmVyIH0gPSB7IHZhbHVlOiBudWxsLCBzY29yZTogMCB9O1xuXG4gIGZvciAoY29uc3QgdHJlYXRtZW50IG9mIFRSRUFUTUVOVF9OQU1FUykge1xuICAgIGNvbnN0IHNjb3JlID0gc2ltaWxhcml0eVNjb3JlKHJhdywgdHJlYXRtZW50KTtcbiAgICBpZiAoc2NvcmUgPiBiZXN0TWF0Y2guc2NvcmUpIHtcbiAgICAgIGJlc3RNYXRjaCA9IHsgdmFsdWU6IHRyZWF0bWVudCwgc2NvcmUgfTtcbiAgICB9XG4gIH1cblxuICBpZiAoYmVzdE1hdGNoLnNjb3JlIDwgTUlOX1RSRUFUTUVOVF9TQ09SRSkge1xuICAgIHJldHVybiB7IHZhbHVlOiBudWxsLCBzY29yZTogYmVzdE1hdGNoLnNjb3JlIH07XG4gIH1cblxuICByZXR1cm4gYmVzdE1hdGNoO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogIENsaWVudC1zaWRlIHJvdyB2YWxpZGF0aW9uIChmb3IgdGhlIHRhYmxlIFVJKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmNvbnN0IFJFUVVJUkVEX0ZJRUxEUzogKGtleW9mIFBhY2thZ2VSb3cpW10gPSBbXG4gIFwidGl0bGVcIixcbiAgXCJob3NwaXRhbF9uYW1lXCIsXG4gIFwidHJlYXRtZW50X25hbWVcIixcbiAgXCJwcmljZVwiLFxuICBcImN1cnJlbmN5XCIsXG5dO1xuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVSb3cocm93OiBQYWNrYWdlUm93KTogUm93VmFsaWRhdGlvbiB7XG4gIGNvbnN0IGVycm9yczogVmFsaWRhdGlvbkVycm9yW10gPSBbXTtcblxuICAvLyBSZXF1aXJlZDogdGl0bGVcbiAgaWYgKCFyb3cudGl0bGU/LnRyaW0oKSkge1xuICAgIGVycm9ycy5wdXNoKHsgZmllbGQ6IFwidGl0bGVcIiwgbWVzc2FnZTogXCJUaXRsZSBpcyByZXF1aXJlZFwiIH0pO1xuICB9XG5cbiAgLy8gUmVxdWlyZWQ6IGhvc3BpdGFsX25hbWVcbiAgaWYgKCFyb3cuaG9zcGl0YWxfbmFtZT8udHJpbSgpKSB7XG4gICAgZXJyb3JzLnB1c2goeyBmaWVsZDogXCJob3NwaXRhbF9uYW1lXCIsIG1lc3NhZ2U6IFwiSG9zcGl0YWwgbmFtZSBpcyByZXF1aXJlZFwiIH0pO1xuICB9XG5cbiAgLy8gUmVxdWlyZWQ6IHRyZWF0bWVudF9uYW1lXG4gIGlmICghcm93LnRyZWF0bWVudF9uYW1lPy50cmltKCkpIHtcbiAgICBlcnJvcnMucHVzaCh7IGZpZWxkOiBcInRyZWF0bWVudF9uYW1lXCIsIG1lc3NhZ2U6IFwiVHJlYXRtZW50IG5hbWUgaXMgcmVxdWlyZWRcIiB9KTtcbiAgfVxuXG4gIC8vIFJlcXVpcmVkOiBwcmljZVxuICBpZiAocm93LnByaWNlID09PSBudWxsIHx8IHJvdy5wcmljZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZXJyb3JzLnB1c2goeyBmaWVsZDogXCJwcmljZVwiLCBtZXNzYWdlOiBcIlByaWNlIGlzIHJlcXVpcmVkXCIgfSk7XG4gIH0gZWxzZSBpZiAoaXNOYU4oTnVtYmVyKHJvdy5wcmljZSkpIHx8IE51bWJlcihyb3cucHJpY2UpIDwgMCkge1xuICAgIGVycm9ycy5wdXNoKHtcbiAgICAgIGZpZWxkOiBcInByaWNlXCIsXG4gICAgICBtZXNzYWdlOiBcIlByaWNlIG11c3QgYmUgYSB2YWxpZCBwb3NpdGl2ZSBudW1iZXJcIixcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFJlcXVpcmVkOiBjdXJyZW5jeVxuICBpZiAoIXJvdy5jdXJyZW5jeT8udHJpbSgpKSB7XG4gICAgZXJyb3JzLnB1c2goeyBmaWVsZDogXCJjdXJyZW5jeVwiLCBtZXNzYWdlOiBcIkN1cnJlbmN5IGlzIHJlcXVpcmVkXCIgfSk7XG4gIH1cblxuICAvLyBPcHRpb25hbDogY29tbWlzc2lvbiAw4oCTMTAwXG4gIGlmIChyb3cuY29tbWlzc2lvbiAhPT0gbnVsbCAmJiByb3cuY29tbWlzc2lvbiAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgbnVtID0gTnVtYmVyKHJvdy5jb21taXNzaW9uKTtcbiAgICBpZiAoaXNOYU4obnVtKSB8fCBudW0gPCAwIHx8IG51bSA+IDEwMCkge1xuICAgICAgZXJyb3JzLnB1c2goe1xuICAgICAgICBmaWVsZDogXCJjb21taXNzaW9uXCIsXG4gICAgICAgIG1lc3NhZ2U6IFwiQ29tbWlzc2lvbiBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMTAwXCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyBPcHRpb25hbDogb3JpZ2luYWxfcHJpY2UgPj0gMFxuICBpZiAocm93Lm9yaWdpbmFsX3ByaWNlICE9PSBudWxsICYmIHJvdy5vcmlnaW5hbF9wcmljZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgbnVtID0gTnVtYmVyKHJvdy5vcmlnaW5hbF9wcmljZSk7XG4gICAgaWYgKGlzTmFOKG51bSkgfHwgbnVtIDwgMCkge1xuICAgICAgZXJyb3JzLnB1c2goe1xuICAgICAgICBmaWVsZDogXCJvcmlnaW5hbF9wcmljZVwiLFxuICAgICAgICBtZXNzYWdlOiBcIk9yaWdpbmFsIHByaWNlIG11c3QgYmUgYSB2YWxpZCBwb3NpdGl2ZSBudW1iZXJcIixcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgcm93SWQ6IHJvdy5pZCB8fCBcIlwiLFxuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVBbGxSb3dzKHJvd3M6IFBhY2thZ2VSb3dbXSk6IHtcbiAgdmFsaWRhdGlvbnM6IE1hcDxzdHJpbmcsIFJvd1ZhbGlkYXRpb24+O1xuICBzdW1tYXJ5OiB7IHZhbGlkOiBudW1iZXI7IGludmFsaWQ6IG51bWJlcjsgd2l0aFdhcm5pbmdzOiBudW1iZXIgfTtcbn0ge1xuICBjb25zdCB2YWxpZGF0aW9ucyA9IG5ldyBNYXA8c3RyaW5nLCBSb3dWYWxpZGF0aW9uPigpO1xuICBsZXQgdmFsaWQgPSAwO1xuICBsZXQgaW52YWxpZCA9IDA7XG4gIGxldCB3aXRoV2FybmluZ3MgPSAwO1xuXG4gIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4ge1xuICAgIC8vIEdlbmVyYXRlIGEgc3RhYmxlIHJvdyBrZXkgZXZlbiBpZiBiYWNrZW5kIGRpZCBub3Qgc2VuZCBhbiBpZFxuICAgIGNvbnN0IHJvd0lkID0gcm93LmlkID8/IGByb3dfJHtpbmRleH1gO1xuXG4gICAgLy8gUnVuIHZhbGlkYXRpb24gb24gdGhlIHJvdzsgUm93VmFsaWRhdGlvbi5yb3dJZCB3aWxsIGJlIG92ZXJ3cml0dGVuIGJlbG93XG4gICAgY29uc3QgYmFzZVZhbGlkYXRpb24gPSB2YWxpZGF0ZVJvdyhyb3cpO1xuXG4gICAgY29uc3QgdmFsaWRhdGlvbjogUm93VmFsaWRhdGlvbiA9IHtcbiAgICAgIC4uLmJhc2VWYWxpZGF0aW9uLFxuICAgICAgcm93SWQsXG4gICAgfTtcblxuICAgIHZhbGlkYXRpb25zLnNldChyb3dJZCwgdmFsaWRhdGlvbik7XG5cbiAgICBpZiAodmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICB2YWxpZCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnZhbGlkKys7XG4gICAgfVxuXG4gICAgaWYgKHJvdy5fbWV0YT8ud2FybmluZ3MgJiYgcm93Ll9tZXRhLndhcm5pbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgIHdpdGhXYXJuaW5ncysrO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHtcbiAgICB2YWxpZGF0aW9ucyxcbiAgICBzdW1tYXJ5OiB7IHZhbGlkLCBpbnZhbGlkLCB3aXRoV2FybmluZ3MgfSxcbiAgfTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBnZXRGaWVsZEVycm9yKFxuICB2YWxpZGF0aW9uczogTWFwPHN0cmluZywgUm93VmFsaWRhdGlvbj4sXG4gIHJvd0lkOiBzdHJpbmcsXG4gIGZpZWxkOiBzdHJpbmcsXG4pOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBjb25zdCByb3dWYWxpZGF0aW9uID0gdmFsaWRhdGlvbnMuZ2V0KHJvd0lkKTtcbiAgaWYgKCFyb3dWYWxpZGF0aW9uKSByZXR1cm4gdW5kZWZpbmVkO1xuICBjb25zdCBlcnJvciA9IHJvd1ZhbGlkYXRpb24uZXJyb3JzLmZpbmQoKGUpID0+IGUuZmllbGQgPT09IGZpZWxkKTtcbiAgcmV0dXJuIGVycm9yPy5tZXNzYWdlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGaWVsZEludmFsaWQoXG4gIHZhbGlkYXRpb25zOiBNYXA8c3RyaW5nLCBSb3dWYWxpZGF0aW9uPixcbiAgcm93SWQ6IHN0cmluZyxcbiAgZmllbGQ6IHN0cmluZyxcbik6IGJvb2xlYW4ge1xuICByZXR1cm4gISFnZXRGaWVsZEVycm9yKHZhbGlkYXRpb25zLCByb3dJZCwgZmllbGQpO1xufVxuIl0sIm5hbWVzIjpbIkhPU1BJVEFMX05BTUVTIiwiVFJFQVRNRU5UX05BTUVTIiwiTUlOX0hPU1BJVEFMX1NDT1JFIiwiTUlOX1RSRUFUTUVOVF9TQ09SRSIsIm1hdGNoaW5nUmVmZXJlbmNlRGF0YSIsImhvc3BpdGFscyIsInRyZWF0bWVudHMiLCJub3JtYWxpemUiLCJ2YWx1ZSIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsInRyaW0iLCJsZXZlbnNodGVpbiIsImEiLCJiIiwibGVuZ3RoIiwibWF0cml4IiwiQXJyYXkiLCJmcm9tIiwiXyIsImkiLCJqIiwiTWF0aCIsIm1pbiIsInNpbWlsYXJpdHlTY29yZSIsInNvdXJjZSIsImNhbmRpZGF0ZSIsIm5vcm1hbGl6ZWRTb3VyY2UiLCJub3JtYWxpemVkQ2FuZGlkYXRlIiwiZGlzdGFuY2UiLCJsb25nZXN0IiwibWF4IiwibWF0Y2hIb3NwaXRhbE5hbWUiLCJyYXciLCJzY29yZSIsImJlc3RNYXRjaCIsImhvc3BpdGFsIiwibWF0Y2hUcmVhdG1lbnROYW1lIiwidHJlYXRtZW50IiwiUkVRVUlSRURfRklFTERTIiwidmFsaWRhdGVSb3ciLCJyb3ciLCJlcnJvcnMiLCJ0aXRsZSIsInB1c2giLCJmaWVsZCIsIm1lc3NhZ2UiLCJob3NwaXRhbF9uYW1lIiwidHJlYXRtZW50X25hbWUiLCJwcmljZSIsInVuZGVmaW5lZCIsImlzTmFOIiwiTnVtYmVyIiwiY3VycmVuY3kiLCJjb21taXNzaW9uIiwibnVtIiwib3JpZ2luYWxfcHJpY2UiLCJyb3dJZCIsImlkIiwiaXNWYWxpZCIsInZhbGlkYXRlQWxsUm93cyIsInJvd3MiLCJ2YWxpZGF0aW9ucyIsIk1hcCIsInZhbGlkIiwiaW52YWxpZCIsIndpdGhXYXJuaW5ncyIsImZvckVhY2giLCJpbmRleCIsImJhc2VWYWxpZGF0aW9uIiwidmFsaWRhdGlvbiIsInNldCIsIl9tZXRhIiwid2FybmluZ3MiLCJzdW1tYXJ5IiwiZ2V0RmllbGRFcnJvciIsInJvd1ZhbGlkYXRpb24iLCJnZXQiLCJlcnJvciIsImZpbmQiLCJlIiwiaXNGaWVsZEludmFsaWQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/validation.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/aiExtractor.ts":
/*!*************************************!*\
  !*** ./src/services/aiExtractor.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractPackagesFromOcrText: () => (/* binding */ extractPackagesFromOcrText)\n/* harmony export */ });\n/* harmony import */ var _bedrockClient__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./bedrockClient */ \"(rsc)/./src/services/bedrockClient.ts\");\n/* harmony import */ var _normalizer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./normalizer */ \"(rsc)/./src/services/normalizer.ts\");\n\n\n/**\r\n * extractPackagesFromOcrText\r\n * --------------------------\r\n * Builds a structured prompt from OCR output, invokes Claude via Bedrock,\r\n * and returns normalized PackageRow objects ready for CSV serialization.\r\n */ async function extractPackagesFromOcrText(ocrPages) {\n    if (!ocrPages.length) {\n        return [];\n    }\n    const prompt = buildPrompt(ocrPages);\n    const rawResponse = await (0,_bedrockClient__WEBPACK_IMPORTED_MODULE_0__.callBedrockForExtraction)(prompt, {\n        maxTokens: 6000,\n        temperature: 0.1\n    });\n    const cleaned = sanitizeModelResponse(rawResponse);\n    let parsed;\n    try {\n        parsed = JSON.parse(cleaned || \"{}\");\n    } catch (err) {\n        // Log a short preview so you can see what Claude actually returned\n        console.error(\"[Bedrock OCR] Non-JSON output preview:\", rawResponse.slice(0, 500));\n        console.error(\"[Bedrock OCR] Cleaned preview:\", cleaned.slice(0, 500));\n        throw new Error(\"Bedrock returned invalid JSON for OCR extraction.\");\n    }\n    const packages = Array.isArray(parsed?.packages) ? parsed.packages : [];\n    return packages.map((row)=>(0,_normalizer__WEBPACK_IMPORTED_MODULE_1__.normalizePackageRow)(row));\n}\nfunction buildPrompt(pages) {\n    const ordered = [\n        ...pages\n    ].sort((a, b)=>{\n        if (a.fileId === b.fileId) {\n            return a.pageNumber - b.pageNumber;\n        }\n        return a.fileId.localeCompare(b.fileId);\n    });\n    const joinedPages = ordered.map((page)=>`--- PAGE ${page.pageNumber} (${page.fileName}) ---\\n${page.rawText}\\n`).join(\"\\n\");\n    return `\r\nYou are an assistant helping an admin system convert clinic menus into structured package data\r\nfor a bulk CSV upload.\r\n\r\nThe OCR input may:\r\n- Span multiple pages.\r\n- Use two-column layouts.\r\n- Mix English, Chinese and regional languages.\r\n\r\nIMPORTANT:\r\n- Scan ALL pages and ALL lines.\r\n- **EVERY clearly priced item must become a separate package**, even inside sections\r\n  like \"Express IV Drips\" or \"Premium IV Drips\".\r\n- Do NOT stop after the first few items if more prices appear later.\r\n- Section headers (e.g. \"IV DRIP MENU\") are NOT packages by themselves unless they\r\n  clearly show a price and read like a purchasable item.\r\n\r\nOUTPUT FORMAT\r\n-------------\r\nReturn VALID JSON only (no markdown, no backticks, no comments) with this exact top-level shape:\r\n\r\n{\r\n  \"packages\": [ { /* PackageRow */ }, ... ]\r\n}\r\n\r\nEach package object must contain ALL of these keys:\r\n\r\n- title: string\r\n- description: string\r\n- details: string\r\n- hospital_name: string\r\n- treatment_name: string\r\n- sub_treatments: string\r\n- price: number or null\r\n- original_price: number or null\r\n- currency: \"USD\" | \"THB\" | \"EUR\" | \"GBP\" | \"SGD\" | \"MYR\" | \"KRW\"\r\n- duration: string\r\n- treatment_category: string\r\n- anaesthesia: string\r\n- commission: number or null\r\n- featured: boolean\r\n- status: \"active\" | \"inactive\"\r\n- doctor_name: string\r\n- is_le_package: boolean\r\n- includes: string\r\n- image_file_id: string | null\r\n- hospital_location: string\r\n- category: string\r\n- hospital_country: string\r\n- translation_title: string\r\n- translation_description: string\r\n- translation_details: string\r\n- translation: string\r\n- _meta: {\r\n    source_file: string,\r\n    source_page: number,\r\n    confidence_score: number,\r\n    warnings: string[]\r\n  }\r\n\r\nIf any value is unknown:\r\n- Use \"\" for strings\r\n- null for numbers\r\n- false for booleans (featured, is_le_package) unless explicitly stated\r\n- status defaults to \"active\" if unclear\r\n\r\nLANGUAGE & TRANSLATION\r\n----------------------\r\n- If the package text is already in ENGLISH:\r\n  - Keep title / description / details in English.\r\n  - translation_title / translation_description / translation_details â†’ \"\".\r\n  - translation â†’ \"\" or \"EN\".\r\n- If the package text is NOT English (e.g. Chinese, Thai):\r\n  - Keep the original language in title / description / details.\r\n  - Provide a good Chinese translation:\r\n      - translation_title: title translated to Chinese.\r\n      - translation_description: description translated to Chinese.\r\n      - translation_details: details translated to Chinese.\r\n  - Set translation to a short language code like \"ZH\" or \"TH->ZH\".\r\n- If the text is unreadable, leave translation_* as \"\" and add a warning.\r\n\r\nCANONICAL TREATMENT NAMES\r\n-------------------------\r\nWhen you infer or normalize treatment_name, you MUST prefer the following\r\ncanonical names whenever they clearly match the menu context. Use these exact\r\nstrings (including capitalization and spacing) where appropriate:\r\n\r\nDiagnostics:\r\n- \"Health Checkup\"\r\n- \"Cancer Screening\"\r\n- \"MRI Scan\"\r\n- \"CT Scan\"\r\n- \"PET-CT Scan\"\r\n- \"Blood Test\"\r\n- \"Cardiac Screening\"\r\n\r\nSurgery:\r\n- \"Hip & Knee Replacement\"\r\n- \"Spinal Surgery\"\r\n- \"Brain Tumor Surgery\"\r\n- \"Heart Valve Repair\"\r\n- \"Kidney Transplant\"\r\n- \"Liver Transplant\"\r\n- \"LASIK Surgery\"\r\n- \"Cataract Surgery\"\r\n- \"Glaucoma Surgery\"\r\n- \"Gastric Sleeve\"\r\n- \"Gastric Bypass\"\r\n- \"Endoscopic Sleeve Gastroplasty\"\r\n- \"Gender-Affirming Surgery\"\r\n- \"Pacemaker Implantation\"\r\n- \"Prostate Surgery\"\r\n- \"Vasectomy Reversal\"\r\n- \"Hysterectomy\"\r\n- \"Fibroid Removal\"\r\n- \"Corneal Transplant\"\r\n- \"Deep Brain Stimulation (DBS)\"\r\n- \"Epilepsy Surgery\"\r\n- \"Spinal Cord Surgery\"\r\n\r\nCosmetic & Plastic Surgery:\r\n- \"Facial Plastic Surgery\"\r\n- \"Breast Augmentation\"\r\n- \"Rhinoplasty\"\r\n- \"Liposuction\"\r\n- \"Botox Treatment\"\r\n- \"Dermal Fillers\"\r\n- \"Hair Transplant\"\r\n- \"Laser Resurfacing\"\r\n- \"Buccal Fat Removal\"\r\n- \"Chin Augmentation\"\r\n- \"Teeth Whitening\"\r\n- \"Veneer\"\r\n\r\nTreatment:\r\n- \"Dental Implants\"\r\n- \"Root Canal\"\r\n- \"IVF (In Vitro Fertilization)\"\r\n- \"IUI (Intrauterine Insemination)\"\r\n- \"Egg Freezing\"\r\n- \"HRT (Hormone Replacement Therapy)\"\r\n\r\nOncology:\r\n- \"Chemotherapy\"\r\n- \"Radiation Therapy\"\r\n- \"Immunotherapy\"\r\n- \"Proton Therapy\"\r\n\r\nWellness:\r\n- \"Detox Retreats\"\r\n- \"IV Therapy\"\r\n- \"Anti-Aging Therapy\"\r\n- \"Physiotherapy\"\r\n\r\nTraditional Medicine:\r\n- \"Acupuncture\"\r\n- \"Ayurveda\"\r\n- \"Thai Massage\"\r\n\r\nRules:\r\n- If a menu item clearly matches one of the above, set treatment_name to that exact string.\r\n- If no canonical name fits, you may use a best-effort descriptive treatment_name\r\n  such as \"IV Drip Therapy\", \"Skin Rejuvenation Package\", etc.\r\n\r\nFIELD MAPPING HINTS\r\n-------------------\r\n- Each distinct line or block with a price (e.g. \"Hydration Drip Â£100\") is its own package.\r\n- Use the local price symbol or context to infer currency, e.g.:\r\n    - \"Â£\" â†’ GBP\r\n    - \"RM\" â†’ MYR\r\n    - \"à¸¿\" â†’ THB\r\n    - \"S$\" â†’ SGD\r\n    - \"$\" with US context â†’ USD\r\n- treatment_name: use a canonical name from the list above whenever possible.\r\n- sub_treatments: comma-separated sub-focuses (e.g. \"Hydration,Skin Rejuvenation\").\r\n- includes: formatted inclusions like \"Consultation,Drip,Follow Up\".\r\n\r\n_Example warnings in _meta.warnings_:\r\n- \"Hospital not recognized: â€¦\"\r\n- \"Treatment not recognized: â€¦\"\r\n- \"Missing price for package â€¦\"\r\n- \"Currency not recognized\"\r\n\r\nCSV header order for reference:\r\ntitle,description,details,hospital_name,treatment_name,Sub Treatments,price,original_price,currency,duration,treatment_category,anaesthesia,commission,featured,status,doctor_name,is_le_package,includes,image_file_id,hospital_location,category,hospital_country,translation_title,translation_description,translation_details,translation\r\n\r\nOCR INPUT (ALL PAGES):\r\n${joinedPages}\r\n`;\n}\n/**\r\n * sanitizeModelResponse\r\n * ---------------------\r\n * 1. Strips obvious markdown fences (``` / ```json).\r\n * 2. Trims leading/trailing noise outside the FIRST '{' and LAST '}'.\r\n *    This protects against Claude adding prose like \"I'll help you...\"\r\n *    before the JSON, or extra commentary after it.\r\n */ function sanitizeModelResponse(value) {\n    if (!value) return \"\";\n    let cleaned = value.trim();\n    // Strip common markdown fences\n    cleaned = cleaned.replace(/^```json/i, \"\").replace(/^```/, \"\").replace(/```$/, \"\").trim();\n    // Grab only the innermost JSON object: from first '{' to last '}'.\n    const firstBrace = cleaned.indexOf(\"{\");\n    const lastBrace = cleaned.lastIndexOf(\"}\");\n    if (firstBrace !== -1 && lastBrace !== -1 && lastBrace > firstBrace) {\n        cleaned = cleaned.slice(firstBrace, lastBrace + 1).trim();\n    }\n    return cleaned;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvc2VydmljZXMvYWlFeHRyYWN0b3IudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQzJEO0FBQ1I7QUFFbkQ7Ozs7O0NBS0MsR0FDTSxlQUFlRSwyQkFDcEJDLFFBQW1CO0lBRW5CLElBQUksQ0FBQ0EsU0FBU0MsTUFBTSxFQUFFO1FBQ3BCLE9BQU8sRUFBRTtJQUNYO0lBRUEsTUFBTUMsU0FBU0MsWUFBWUg7SUFDM0IsTUFBTUksY0FBYyxNQUFNUCx3RUFBd0JBLENBQUNLLFFBQVE7UUFDekRHLFdBQVc7UUFDWEMsYUFBYTtJQUNmO0lBRUEsTUFBTUMsVUFBVUMsc0JBQXNCSjtJQUV0QyxJQUFJSztJQUNKLElBQUk7UUFDRkEsU0FBU0MsS0FBS0MsS0FBSyxDQUFDSixXQUFXO0lBQ2pDLEVBQUUsT0FBT0ssS0FBSztRQUNaLG1FQUFtRTtRQUNuRUMsUUFBUUMsS0FBSyxDQUNYLDBDQUNBVixZQUFZVyxLQUFLLENBQUMsR0FBRztRQUV2QkYsUUFBUUMsS0FBSyxDQUFDLGtDQUFrQ1AsUUFBUVEsS0FBSyxDQUFDLEdBQUc7UUFDakUsTUFBTSxJQUFJQyxNQUFNO0lBQ2xCO0lBRUEsTUFBTUMsV0FBa0JDLE1BQU1DLE9BQU8sQ0FBQ1YsUUFBUVEsWUFBWVIsT0FBT1EsUUFBUSxHQUFHLEVBQUU7SUFDOUUsT0FBT0EsU0FBU0csR0FBRyxDQUFDLENBQUNDLE1BQVF2QixnRUFBbUJBLENBQUN1QjtBQUNuRDtBQUVBLFNBQVNsQixZQUFZbUIsS0FBZ0I7SUFDbkMsTUFBTUMsVUFBVTtXQUFJRDtLQUFNLENBQUNFLElBQUksQ0FBQyxDQUFDQyxHQUFHQztRQUNsQyxJQUFJRCxFQUFFRSxNQUFNLEtBQUtELEVBQUVDLE1BQU0sRUFBRTtZQUN6QixPQUFPRixFQUFFRyxVQUFVLEdBQUdGLEVBQUVFLFVBQVU7UUFDcEM7UUFDQSxPQUFPSCxFQUFFRSxNQUFNLENBQUNFLGFBQWEsQ0FBQ0gsRUFBRUMsTUFBTTtJQUN4QztJQUVBLE1BQU1HLGNBQWNQLFFBQ2pCSCxHQUFHLENBQ0YsQ0FBQ1csT0FDQyxDQUFDLFNBQVMsRUFBRUEsS0FBS0gsVUFBVSxDQUFDLEVBQUUsRUFBRUcsS0FBS0MsUUFBUSxDQUFDLE9BQU8sRUFBRUQsS0FBS0UsT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUUxRUMsSUFBSSxDQUFDO0lBRVIsT0FBTyxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBMkxWLEVBQUVKLFlBQVk7QUFDZCxDQUFDO0FBQ0Q7QUFFQTs7Ozs7OztDQU9DLEdBQ0QsU0FBU3RCLHNCQUFzQjJCLEtBQWE7SUFDMUMsSUFBSSxDQUFDQSxPQUFPLE9BQU87SUFFbkIsSUFBSTVCLFVBQVU0QixNQUFNQyxJQUFJO0lBRXhCLCtCQUErQjtJQUMvQjdCLFVBQVVBLFFBQ1A4QixPQUFPLENBQUMsYUFBYSxJQUNyQkEsT0FBTyxDQUFDLFFBQVEsSUFDaEJBLE9BQU8sQ0FBQyxRQUFRLElBQ2hCRCxJQUFJO0lBRVAsbUVBQW1FO0lBQ25FLE1BQU1FLGFBQWEvQixRQUFRZ0MsT0FBTyxDQUFDO0lBQ25DLE1BQU1DLFlBQVlqQyxRQUFRa0MsV0FBVyxDQUFDO0lBRXRDLElBQUlILGVBQWUsQ0FBQyxLQUFLRSxjQUFjLENBQUMsS0FBS0EsWUFBWUYsWUFBWTtRQUNuRS9CLFVBQVVBLFFBQVFRLEtBQUssQ0FBQ3VCLFlBQVlFLFlBQVksR0FBR0osSUFBSTtJQUN6RDtJQUVBLE9BQU83QjtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGVtZWRpY2EtY2xpbmljLW9jci8uL3NyYy9zZXJ2aWNlcy9haUV4dHJhY3Rvci50cz9mZjYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgUGFja2FnZVJvdywgT2NyUGFnZSB9IGZyb20gXCJAL2xpYi90eXBlcy9vY3JcIjtcclxuaW1wb3J0IHsgY2FsbEJlZHJvY2tGb3JFeHRyYWN0aW9uIH0gZnJvbSBcIi4vYmVkcm9ja0NsaWVudFwiO1xyXG5pbXBvcnQgeyBub3JtYWxpemVQYWNrYWdlUm93IH0gZnJvbSBcIi4vbm9ybWFsaXplclwiO1xyXG5cclxuLyoqXHJcbiAqIGV4dHJhY3RQYWNrYWdlc0Zyb21PY3JUZXh0XHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAqIEJ1aWxkcyBhIHN0cnVjdHVyZWQgcHJvbXB0IGZyb20gT0NSIG91dHB1dCwgaW52b2tlcyBDbGF1ZGUgdmlhIEJlZHJvY2ssXHJcbiAqIGFuZCByZXR1cm5zIG5vcm1hbGl6ZWQgUGFja2FnZVJvdyBvYmplY3RzIHJlYWR5IGZvciBDU1Ygc2VyaWFsaXphdGlvbi5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleHRyYWN0UGFja2FnZXNGcm9tT2NyVGV4dChcclxuICBvY3JQYWdlczogT2NyUGFnZVtdXHJcbik6IFByb21pc2U8UGFja2FnZVJvd1tdPiB7XHJcbiAgaWYgKCFvY3JQYWdlcy5sZW5ndGgpIHtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHByb21wdCA9IGJ1aWxkUHJvbXB0KG9jclBhZ2VzKTtcclxuICBjb25zdCByYXdSZXNwb25zZSA9IGF3YWl0IGNhbGxCZWRyb2NrRm9yRXh0cmFjdGlvbihwcm9tcHQsIHtcclxuICAgIG1heFRva2VuczogNjAwMCxcclxuICAgIHRlbXBlcmF0dXJlOiAwLjEsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGNsZWFuZWQgPSBzYW5pdGl6ZU1vZGVsUmVzcG9uc2UocmF3UmVzcG9uc2UpO1xyXG5cclxuICBsZXQgcGFyc2VkOiBhbnk7XHJcbiAgdHJ5IHtcclxuICAgIHBhcnNlZCA9IEpTT04ucGFyc2UoY2xlYW5lZCB8fCBcInt9XCIpO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgLy8gTG9nIGEgc2hvcnQgcHJldmlldyBzbyB5b3UgY2FuIHNlZSB3aGF0IENsYXVkZSBhY3R1YWxseSByZXR1cm5lZFxyXG4gICAgY29uc29sZS5lcnJvcihcclxuICAgICAgXCJbQmVkcm9jayBPQ1JdIE5vbi1KU09OIG91dHB1dCBwcmV2aWV3OlwiLFxyXG4gICAgICByYXdSZXNwb25zZS5zbGljZSgwLCA1MDApXHJcbiAgICApO1xyXG4gICAgY29uc29sZS5lcnJvcihcIltCZWRyb2NrIE9DUl0gQ2xlYW5lZCBwcmV2aWV3OlwiLCBjbGVhbmVkLnNsaWNlKDAsIDUwMCkpO1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiQmVkcm9jayByZXR1cm5lZCBpbnZhbGlkIEpTT04gZm9yIE9DUiBleHRyYWN0aW9uLlwiKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHBhY2thZ2VzOiBhbnlbXSA9IEFycmF5LmlzQXJyYXkocGFyc2VkPy5wYWNrYWdlcykgPyBwYXJzZWQucGFja2FnZXMgOiBbXTtcclxuICByZXR1cm4gcGFja2FnZXMubWFwKChyb3cpID0+IG5vcm1hbGl6ZVBhY2thZ2VSb3cocm93KSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGJ1aWxkUHJvbXB0KHBhZ2VzOiBPY3JQYWdlW10pOiBzdHJpbmcge1xyXG4gIGNvbnN0IG9yZGVyZWQgPSBbLi4ucGFnZXNdLnNvcnQoKGEsIGIpID0+IHtcclxuICAgIGlmIChhLmZpbGVJZCA9PT0gYi5maWxlSWQpIHtcclxuICAgICAgcmV0dXJuIGEucGFnZU51bWJlciAtIGIucGFnZU51bWJlcjtcclxuICAgIH1cclxuICAgIHJldHVybiBhLmZpbGVJZC5sb2NhbGVDb21wYXJlKGIuZmlsZUlkKTtcclxuICB9KTtcclxuXHJcbiAgY29uc3Qgam9pbmVkUGFnZXMgPSBvcmRlcmVkXHJcbiAgICAubWFwKFxyXG4gICAgICAocGFnZSkgPT5cclxuICAgICAgICBgLS0tIFBBR0UgJHtwYWdlLnBhZ2VOdW1iZXJ9ICgke3BhZ2UuZmlsZU5hbWV9KSAtLS1cXG4ke3BhZ2UucmF3VGV4dH1cXG5gXHJcbiAgICApXHJcbiAgICAuam9pbihcIlxcblwiKTtcclxuXHJcbiAgcmV0dXJuIGBcclxuWW91IGFyZSBhbiBhc3Npc3RhbnQgaGVscGluZyBhbiBhZG1pbiBzeXN0ZW0gY29udmVydCBjbGluaWMgbWVudXMgaW50byBzdHJ1Y3R1cmVkIHBhY2thZ2UgZGF0YVxyXG5mb3IgYSBidWxrIENTViB1cGxvYWQuXHJcblxyXG5UaGUgT0NSIGlucHV0IG1heTpcclxuLSBTcGFuIG11bHRpcGxlIHBhZ2VzLlxyXG4tIFVzZSB0d28tY29sdW1uIGxheW91dHMuXHJcbi0gTWl4IEVuZ2xpc2gsIENoaW5lc2UgYW5kIHJlZ2lvbmFsIGxhbmd1YWdlcy5cclxuXHJcbklNUE9SVEFOVDpcclxuLSBTY2FuIEFMTCBwYWdlcyBhbmQgQUxMIGxpbmVzLlxyXG4tICoqRVZFUlkgY2xlYXJseSBwcmljZWQgaXRlbSBtdXN0IGJlY29tZSBhIHNlcGFyYXRlIHBhY2thZ2UqKiwgZXZlbiBpbnNpZGUgc2VjdGlvbnNcclxuICBsaWtlIFwiRXhwcmVzcyBJViBEcmlwc1wiIG9yIFwiUHJlbWl1bSBJViBEcmlwc1wiLlxyXG4tIERvIE5PVCBzdG9wIGFmdGVyIHRoZSBmaXJzdCBmZXcgaXRlbXMgaWYgbW9yZSBwcmljZXMgYXBwZWFyIGxhdGVyLlxyXG4tIFNlY3Rpb24gaGVhZGVycyAoZS5nLiBcIklWIERSSVAgTUVOVVwiKSBhcmUgTk9UIHBhY2thZ2VzIGJ5IHRoZW1zZWx2ZXMgdW5sZXNzIHRoZXlcclxuICBjbGVhcmx5IHNob3cgYSBwcmljZSBhbmQgcmVhZCBsaWtlIGEgcHVyY2hhc2FibGUgaXRlbS5cclxuXHJcbk9VVFBVVCBGT1JNQVRcclxuLS0tLS0tLS0tLS0tLVxyXG5SZXR1cm4gVkFMSUQgSlNPTiBvbmx5IChubyBtYXJrZG93biwgbm8gYmFja3RpY2tzLCBubyBjb21tZW50cykgd2l0aCB0aGlzIGV4YWN0IHRvcC1sZXZlbCBzaGFwZTpcclxuXHJcbntcclxuICBcInBhY2thZ2VzXCI6IFsgeyAvKiBQYWNrYWdlUm93ICovIH0sIC4uLiBdXHJcbn1cclxuXHJcbkVhY2ggcGFja2FnZSBvYmplY3QgbXVzdCBjb250YWluIEFMTCBvZiB0aGVzZSBrZXlzOlxyXG5cclxuLSB0aXRsZTogc3RyaW5nXHJcbi0gZGVzY3JpcHRpb246IHN0cmluZ1xyXG4tIGRldGFpbHM6IHN0cmluZ1xyXG4tIGhvc3BpdGFsX25hbWU6IHN0cmluZ1xyXG4tIHRyZWF0bWVudF9uYW1lOiBzdHJpbmdcclxuLSBzdWJfdHJlYXRtZW50czogc3RyaW5nXHJcbi0gcHJpY2U6IG51bWJlciBvciBudWxsXHJcbi0gb3JpZ2luYWxfcHJpY2U6IG51bWJlciBvciBudWxsXHJcbi0gY3VycmVuY3k6IFwiVVNEXCIgfCBcIlRIQlwiIHwgXCJFVVJcIiB8IFwiR0JQXCIgfCBcIlNHRFwiIHwgXCJNWVJcIiB8IFwiS1JXXCJcclxuLSBkdXJhdGlvbjogc3RyaW5nXHJcbi0gdHJlYXRtZW50X2NhdGVnb3J5OiBzdHJpbmdcclxuLSBhbmFlc3RoZXNpYTogc3RyaW5nXHJcbi0gY29tbWlzc2lvbjogbnVtYmVyIG9yIG51bGxcclxuLSBmZWF0dXJlZDogYm9vbGVhblxyXG4tIHN0YXR1czogXCJhY3RpdmVcIiB8IFwiaW5hY3RpdmVcIlxyXG4tIGRvY3Rvcl9uYW1lOiBzdHJpbmdcclxuLSBpc19sZV9wYWNrYWdlOiBib29sZWFuXHJcbi0gaW5jbHVkZXM6IHN0cmluZ1xyXG4tIGltYWdlX2ZpbGVfaWQ6IHN0cmluZyB8IG51bGxcclxuLSBob3NwaXRhbF9sb2NhdGlvbjogc3RyaW5nXHJcbi0gY2F0ZWdvcnk6IHN0cmluZ1xyXG4tIGhvc3BpdGFsX2NvdW50cnk6IHN0cmluZ1xyXG4tIHRyYW5zbGF0aW9uX3RpdGxlOiBzdHJpbmdcclxuLSB0cmFuc2xhdGlvbl9kZXNjcmlwdGlvbjogc3RyaW5nXHJcbi0gdHJhbnNsYXRpb25fZGV0YWlsczogc3RyaW5nXHJcbi0gdHJhbnNsYXRpb246IHN0cmluZ1xyXG4tIF9tZXRhOiB7XHJcbiAgICBzb3VyY2VfZmlsZTogc3RyaW5nLFxyXG4gICAgc291cmNlX3BhZ2U6IG51bWJlcixcclxuICAgIGNvbmZpZGVuY2Vfc2NvcmU6IG51bWJlcixcclxuICAgIHdhcm5pbmdzOiBzdHJpbmdbXVxyXG4gIH1cclxuXHJcbklmIGFueSB2YWx1ZSBpcyB1bmtub3duOlxyXG4tIFVzZSBcIlwiIGZvciBzdHJpbmdzXHJcbi0gbnVsbCBmb3IgbnVtYmVyc1xyXG4tIGZhbHNlIGZvciBib29sZWFucyAoZmVhdHVyZWQsIGlzX2xlX3BhY2thZ2UpIHVubGVzcyBleHBsaWNpdGx5IHN0YXRlZFxyXG4tIHN0YXR1cyBkZWZhdWx0cyB0byBcImFjdGl2ZVwiIGlmIHVuY2xlYXJcclxuXHJcbkxBTkdVQUdFICYgVFJBTlNMQVRJT05cclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4tIElmIHRoZSBwYWNrYWdlIHRleHQgaXMgYWxyZWFkeSBpbiBFTkdMSVNIOlxyXG4gIC0gS2VlcCB0aXRsZSAvIGRlc2NyaXB0aW9uIC8gZGV0YWlscyBpbiBFbmdsaXNoLlxyXG4gIC0gdHJhbnNsYXRpb25fdGl0bGUgLyB0cmFuc2xhdGlvbl9kZXNjcmlwdGlvbiAvIHRyYW5zbGF0aW9uX2RldGFpbHMg4oaSIFwiXCIuXHJcbiAgLSB0cmFuc2xhdGlvbiDihpIgXCJcIiBvciBcIkVOXCIuXHJcbi0gSWYgdGhlIHBhY2thZ2UgdGV4dCBpcyBOT1QgRW5nbGlzaCAoZS5nLiBDaGluZXNlLCBUaGFpKTpcclxuICAtIEtlZXAgdGhlIG9yaWdpbmFsIGxhbmd1YWdlIGluIHRpdGxlIC8gZGVzY3JpcHRpb24gLyBkZXRhaWxzLlxyXG4gIC0gUHJvdmlkZSBhIGdvb2QgQ2hpbmVzZSB0cmFuc2xhdGlvbjpcclxuICAgICAgLSB0cmFuc2xhdGlvbl90aXRsZTogdGl0bGUgdHJhbnNsYXRlZCB0byBDaGluZXNlLlxyXG4gICAgICAtIHRyYW5zbGF0aW9uX2Rlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB0cmFuc2xhdGVkIHRvIENoaW5lc2UuXHJcbiAgICAgIC0gdHJhbnNsYXRpb25fZGV0YWlsczogZGV0YWlscyB0cmFuc2xhdGVkIHRvIENoaW5lc2UuXHJcbiAgLSBTZXQgdHJhbnNsYXRpb24gdG8gYSBzaG9ydCBsYW5ndWFnZSBjb2RlIGxpa2UgXCJaSFwiIG9yIFwiVEgtPlpIXCIuXHJcbi0gSWYgdGhlIHRleHQgaXMgdW5yZWFkYWJsZSwgbGVhdmUgdHJhbnNsYXRpb25fKiBhcyBcIlwiIGFuZCBhZGQgYSB3YXJuaW5nLlxyXG5cclxuQ0FOT05JQ0FMIFRSRUFUTUVOVCBOQU1FU1xyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbldoZW4geW91IGluZmVyIG9yIG5vcm1hbGl6ZSB0cmVhdG1lbnRfbmFtZSwgeW91IE1VU1QgcHJlZmVyIHRoZSBmb2xsb3dpbmdcclxuY2Fub25pY2FsIG5hbWVzIHdoZW5ldmVyIHRoZXkgY2xlYXJseSBtYXRjaCB0aGUgbWVudSBjb250ZXh0LiBVc2UgdGhlc2UgZXhhY3Rcclxuc3RyaW5ncyAoaW5jbHVkaW5nIGNhcGl0YWxpemF0aW9uIGFuZCBzcGFjaW5nKSB3aGVyZSBhcHByb3ByaWF0ZTpcclxuXHJcbkRpYWdub3N0aWNzOlxyXG4tIFwiSGVhbHRoIENoZWNrdXBcIlxyXG4tIFwiQ2FuY2VyIFNjcmVlbmluZ1wiXHJcbi0gXCJNUkkgU2NhblwiXHJcbi0gXCJDVCBTY2FuXCJcclxuLSBcIlBFVC1DVCBTY2FuXCJcclxuLSBcIkJsb29kIFRlc3RcIlxyXG4tIFwiQ2FyZGlhYyBTY3JlZW5pbmdcIlxyXG5cclxuU3VyZ2VyeTpcclxuLSBcIkhpcCAmIEtuZWUgUmVwbGFjZW1lbnRcIlxyXG4tIFwiU3BpbmFsIFN1cmdlcnlcIlxyXG4tIFwiQnJhaW4gVHVtb3IgU3VyZ2VyeVwiXHJcbi0gXCJIZWFydCBWYWx2ZSBSZXBhaXJcIlxyXG4tIFwiS2lkbmV5IFRyYW5zcGxhbnRcIlxyXG4tIFwiTGl2ZXIgVHJhbnNwbGFudFwiXHJcbi0gXCJMQVNJSyBTdXJnZXJ5XCJcclxuLSBcIkNhdGFyYWN0IFN1cmdlcnlcIlxyXG4tIFwiR2xhdWNvbWEgU3VyZ2VyeVwiXHJcbi0gXCJHYXN0cmljIFNsZWV2ZVwiXHJcbi0gXCJHYXN0cmljIEJ5cGFzc1wiXHJcbi0gXCJFbmRvc2NvcGljIFNsZWV2ZSBHYXN0cm9wbGFzdHlcIlxyXG4tIFwiR2VuZGVyLUFmZmlybWluZyBTdXJnZXJ5XCJcclxuLSBcIlBhY2VtYWtlciBJbXBsYW50YXRpb25cIlxyXG4tIFwiUHJvc3RhdGUgU3VyZ2VyeVwiXHJcbi0gXCJWYXNlY3RvbXkgUmV2ZXJzYWxcIlxyXG4tIFwiSHlzdGVyZWN0b215XCJcclxuLSBcIkZpYnJvaWQgUmVtb3ZhbFwiXHJcbi0gXCJDb3JuZWFsIFRyYW5zcGxhbnRcIlxyXG4tIFwiRGVlcCBCcmFpbiBTdGltdWxhdGlvbiAoREJTKVwiXHJcbi0gXCJFcGlsZXBzeSBTdXJnZXJ5XCJcclxuLSBcIlNwaW5hbCBDb3JkIFN1cmdlcnlcIlxyXG5cclxuQ29zbWV0aWMgJiBQbGFzdGljIFN1cmdlcnk6XHJcbi0gXCJGYWNpYWwgUGxhc3RpYyBTdXJnZXJ5XCJcclxuLSBcIkJyZWFzdCBBdWdtZW50YXRpb25cIlxyXG4tIFwiUmhpbm9wbGFzdHlcIlxyXG4tIFwiTGlwb3N1Y3Rpb25cIlxyXG4tIFwiQm90b3ggVHJlYXRtZW50XCJcclxuLSBcIkRlcm1hbCBGaWxsZXJzXCJcclxuLSBcIkhhaXIgVHJhbnNwbGFudFwiXHJcbi0gXCJMYXNlciBSZXN1cmZhY2luZ1wiXHJcbi0gXCJCdWNjYWwgRmF0IFJlbW92YWxcIlxyXG4tIFwiQ2hpbiBBdWdtZW50YXRpb25cIlxyXG4tIFwiVGVldGggV2hpdGVuaW5nXCJcclxuLSBcIlZlbmVlclwiXHJcblxyXG5UcmVhdG1lbnQ6XHJcbi0gXCJEZW50YWwgSW1wbGFudHNcIlxyXG4tIFwiUm9vdCBDYW5hbFwiXHJcbi0gXCJJVkYgKEluIFZpdHJvIEZlcnRpbGl6YXRpb24pXCJcclxuLSBcIklVSSAoSW50cmF1dGVyaW5lIEluc2VtaW5hdGlvbilcIlxyXG4tIFwiRWdnIEZyZWV6aW5nXCJcclxuLSBcIkhSVCAoSG9ybW9uZSBSZXBsYWNlbWVudCBUaGVyYXB5KVwiXHJcblxyXG5PbmNvbG9neTpcclxuLSBcIkNoZW1vdGhlcmFweVwiXHJcbi0gXCJSYWRpYXRpb24gVGhlcmFweVwiXHJcbi0gXCJJbW11bm90aGVyYXB5XCJcclxuLSBcIlByb3RvbiBUaGVyYXB5XCJcclxuXHJcbldlbGxuZXNzOlxyXG4tIFwiRGV0b3ggUmV0cmVhdHNcIlxyXG4tIFwiSVYgVGhlcmFweVwiXHJcbi0gXCJBbnRpLUFnaW5nIFRoZXJhcHlcIlxyXG4tIFwiUGh5c2lvdGhlcmFweVwiXHJcblxyXG5UcmFkaXRpb25hbCBNZWRpY2luZTpcclxuLSBcIkFjdXB1bmN0dXJlXCJcclxuLSBcIkF5dXJ2ZWRhXCJcclxuLSBcIlRoYWkgTWFzc2FnZVwiXHJcblxyXG5SdWxlczpcclxuLSBJZiBhIG1lbnUgaXRlbSBjbGVhcmx5IG1hdGNoZXMgb25lIG9mIHRoZSBhYm92ZSwgc2V0IHRyZWF0bWVudF9uYW1lIHRvIHRoYXQgZXhhY3Qgc3RyaW5nLlxyXG4tIElmIG5vIGNhbm9uaWNhbCBuYW1lIGZpdHMsIHlvdSBtYXkgdXNlIGEgYmVzdC1lZmZvcnQgZGVzY3JpcHRpdmUgdHJlYXRtZW50X25hbWVcclxuICBzdWNoIGFzIFwiSVYgRHJpcCBUaGVyYXB5XCIsIFwiU2tpbiBSZWp1dmVuYXRpb24gUGFja2FnZVwiLCBldGMuXHJcblxyXG5GSUVMRCBNQVBQSU5HIEhJTlRTXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLSBFYWNoIGRpc3RpbmN0IGxpbmUgb3IgYmxvY2sgd2l0aCBhIHByaWNlIChlLmcuIFwiSHlkcmF0aW9uIERyaXAgwqMxMDBcIikgaXMgaXRzIG93biBwYWNrYWdlLlxyXG4tIFVzZSB0aGUgbG9jYWwgcHJpY2Ugc3ltYm9sIG9yIGNvbnRleHQgdG8gaW5mZXIgY3VycmVuY3ksIGUuZy46XHJcbiAgICAtIFwiwqNcIiDihpIgR0JQXHJcbiAgICAtIFwiUk1cIiDihpIgTVlSXHJcbiAgICAtIFwi4Li/XCIg4oaSIFRIQlxyXG4gICAgLSBcIlMkXCIg4oaSIFNHRFxyXG4gICAgLSBcIiRcIiB3aXRoIFVTIGNvbnRleHQg4oaSIFVTRFxyXG4tIHRyZWF0bWVudF9uYW1lOiB1c2UgYSBjYW5vbmljYWwgbmFtZSBmcm9tIHRoZSBsaXN0IGFib3ZlIHdoZW5ldmVyIHBvc3NpYmxlLlxyXG4tIHN1Yl90cmVhdG1lbnRzOiBjb21tYS1zZXBhcmF0ZWQgc3ViLWZvY3VzZXMgKGUuZy4gXCJIeWRyYXRpb24sU2tpbiBSZWp1dmVuYXRpb25cIikuXHJcbi0gaW5jbHVkZXM6IGZvcm1hdHRlZCBpbmNsdXNpb25zIGxpa2UgXCJDb25zdWx0YXRpb24sRHJpcCxGb2xsb3cgVXBcIi5cclxuXHJcbl9FeGFtcGxlIHdhcm5pbmdzIGluIF9tZXRhLndhcm5pbmdzXzpcclxuLSBcIkhvc3BpdGFsIG5vdCByZWNvZ25pemVkOiDigKZcIlxyXG4tIFwiVHJlYXRtZW50IG5vdCByZWNvZ25pemVkOiDigKZcIlxyXG4tIFwiTWlzc2luZyBwcmljZSBmb3IgcGFja2FnZSDigKZcIlxyXG4tIFwiQ3VycmVuY3kgbm90IHJlY29nbml6ZWRcIlxyXG5cclxuQ1NWIGhlYWRlciBvcmRlciBmb3IgcmVmZXJlbmNlOlxyXG50aXRsZSxkZXNjcmlwdGlvbixkZXRhaWxzLGhvc3BpdGFsX25hbWUsdHJlYXRtZW50X25hbWUsU3ViIFRyZWF0bWVudHMscHJpY2Usb3JpZ2luYWxfcHJpY2UsY3VycmVuY3ksZHVyYXRpb24sdHJlYXRtZW50X2NhdGVnb3J5LGFuYWVzdGhlc2lhLGNvbW1pc3Npb24sZmVhdHVyZWQsc3RhdHVzLGRvY3Rvcl9uYW1lLGlzX2xlX3BhY2thZ2UsaW5jbHVkZXMsaW1hZ2VfZmlsZV9pZCxob3NwaXRhbF9sb2NhdGlvbixjYXRlZ29yeSxob3NwaXRhbF9jb3VudHJ5LHRyYW5zbGF0aW9uX3RpdGxlLHRyYW5zbGF0aW9uX2Rlc2NyaXB0aW9uLHRyYW5zbGF0aW9uX2RldGFpbHMsdHJhbnNsYXRpb25cclxuXHJcbk9DUiBJTlBVVCAoQUxMIFBBR0VTKTpcclxuJHtqb2luZWRQYWdlc31cclxuYDtcclxufVxyXG5cclxuLyoqXHJcbiAqIHNhbml0aXplTW9kZWxSZXNwb25zZVxyXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICogMS4gU3RyaXBzIG9idmlvdXMgbWFya2Rvd24gZmVuY2VzIChgYGAgLyBgYGBqc29uKS5cclxuICogMi4gVHJpbXMgbGVhZGluZy90cmFpbGluZyBub2lzZSBvdXRzaWRlIHRoZSBGSVJTVCAneycgYW5kIExBU1QgJ30nLlxyXG4gKiAgICBUaGlzIHByb3RlY3RzIGFnYWluc3QgQ2xhdWRlIGFkZGluZyBwcm9zZSBsaWtlIFwiSSdsbCBoZWxwIHlvdS4uLlwiXHJcbiAqICAgIGJlZm9yZSB0aGUgSlNPTiwgb3IgZXh0cmEgY29tbWVudGFyeSBhZnRlciBpdC5cclxuICovXHJcbmZ1bmN0aW9uIHNhbml0aXplTW9kZWxSZXNwb25zZSh2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuICBpZiAoIXZhbHVlKSByZXR1cm4gXCJcIjtcclxuXHJcbiAgbGV0IGNsZWFuZWQgPSB2YWx1ZS50cmltKCk7XHJcblxyXG4gIC8vIFN0cmlwIGNvbW1vbiBtYXJrZG93biBmZW5jZXNcclxuICBjbGVhbmVkID0gY2xlYW5lZFxyXG4gICAgLnJlcGxhY2UoL15gYGBqc29uL2ksIFwiXCIpXHJcbiAgICAucmVwbGFjZSgvXmBgYC8sIFwiXCIpXHJcbiAgICAucmVwbGFjZSgvYGBgJC8sIFwiXCIpXHJcbiAgICAudHJpbSgpO1xyXG5cclxuICAvLyBHcmFiIG9ubHkgdGhlIGlubmVybW9zdCBKU09OIG9iamVjdDogZnJvbSBmaXJzdCAneycgdG8gbGFzdCAnfScuXHJcbiAgY29uc3QgZmlyc3RCcmFjZSA9IGNsZWFuZWQuaW5kZXhPZihcIntcIik7XHJcbiAgY29uc3QgbGFzdEJyYWNlID0gY2xlYW5lZC5sYXN0SW5kZXhPZihcIn1cIik7XHJcblxyXG4gIGlmIChmaXJzdEJyYWNlICE9PSAtMSAmJiBsYXN0QnJhY2UgIT09IC0xICYmIGxhc3RCcmFjZSA+IGZpcnN0QnJhY2UpIHtcclxuICAgIGNsZWFuZWQgPSBjbGVhbmVkLnNsaWNlKGZpcnN0QnJhY2UsIGxhc3RCcmFjZSArIDEpLnRyaW0oKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBjbGVhbmVkO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJjYWxsQmVkcm9ja0ZvckV4dHJhY3Rpb24iLCJub3JtYWxpemVQYWNrYWdlUm93IiwiZXh0cmFjdFBhY2thZ2VzRnJvbU9jclRleHQiLCJvY3JQYWdlcyIsImxlbmd0aCIsInByb21wdCIsImJ1aWxkUHJvbXB0IiwicmF3UmVzcG9uc2UiLCJtYXhUb2tlbnMiLCJ0ZW1wZXJhdHVyZSIsImNsZWFuZWQiLCJzYW5pdGl6ZU1vZGVsUmVzcG9uc2UiLCJwYXJzZWQiLCJKU09OIiwicGFyc2UiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJzbGljZSIsIkVycm9yIiwicGFja2FnZXMiLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJyb3ciLCJwYWdlcyIsIm9yZGVyZWQiLCJzb3J0IiwiYSIsImIiLCJmaWxlSWQiLCJwYWdlTnVtYmVyIiwibG9jYWxlQ29tcGFyZSIsImpvaW5lZFBhZ2VzIiwicGFnZSIsImZpbGVOYW1lIiwicmF3VGV4dCIsImpvaW4iLCJ2YWx1ZSIsInRyaW0iLCJyZXBsYWNlIiwiZmlyc3RCcmFjZSIsImluZGV4T2YiLCJsYXN0QnJhY2UiLCJsYXN0SW5kZXhPZiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/services/aiExtractor.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/bedrockClient.ts":
/*!***************************************!*\
  !*** ./src/services/bedrockClient.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   callBedrockForExtraction: () => (/* binding */ callBedrockForExtraction)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_bedrock_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aws-sdk/client-bedrock-runtime */ \"(rsc)/./node_modules/@aws-sdk/client-bedrock-runtime/dist-es/commands/InvokeModelCommand.js\");\n/* harmony import */ var _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../bedrock-config.ts/bedrock-config */ \"(rsc)/./bedrock-config.ts/bedrock-config.ts\");\n\n\n/**\r\n * Default model ID resolution (matches bedrock-config.ts pattern)\r\n * Falls back to CLAUDE_SONNET_MODEL_ID if no env var is set\r\n */ const DEFAULT_MODEL_ID = process.env.BEDROCK_LIGHT_MODEL_ID || process.env.BEDROCK_MODEL_ID || _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__.CLAUDE_SONNET_MODEL_ID;\n/**\r\n * Extracts region from an AWS ARN or returns the configured region\r\n */ function getRegionFromArn(arn) {\n    const match = arn.match(/arn:aws:bedrock:([^:]+):/);\n    return match ? match[1] : null;\n}\n/**\r\n * resolveModelId\r\n * --------------\r\n * Resolves the model identifier, applying inference profile ARN mapping\r\n * when appropriate. Matches the pattern used in processMedicalRecordWithClaude.\r\n * \r\n * If DEFAULT_MODEL_ID is already an ARN, it will be used directly.\r\n * If it's a plain model ID, it will be mapped to a profile ARN if available.\r\n */ function resolveModelId(preferred) {\n    const configuredRegion = process.env.AWS_REGION || process.env.AWS_BEDROCK_REGION || \"us-east-1\";\n    let modelId = preferred || DEFAULT_MODEL_ID;\n    // If DEFAULT_MODEL_ID is already an ARN (starts with \"arn:aws:bedrock:\"), use it directly\n    const isAlreadyArn = modelId.startsWith(\"arn:aws:bedrock:\");\n    if (isAlreadyArn) {\n        // Validate that ARN region matches configured region\n        const arnRegion = getRegionFromArn(modelId);\n        if (arnRegion && arnRegion !== configuredRegion) {\n            console.error(`\\n[Bedrock OCR] âŒ REGION MISMATCH DETECTED:\\n` + `  â€¢ Your AWS_REGION is set to: ${configuredRegion}\\n` + `  â€¢ But your inference profile ARN is for region: ${arnRegion}\\n` + `  â€¢ This WILL cause \"model identifier invalid\" errors.\\n\\n` + `SOLUTION: Change AWS_REGION in .env.local to match the ARN region:\\n` + `  AWS_REGION=${arnRegion}\\n\\n` + `Or create new inference profiles in ${configuredRegion} and update your ARNs.\\n`);\n        }\n        console.log(\"[Bedrock OCR] Using inference profile ARN:\", modelId.substring(0, 80) + \"...\");\n        return modelId;\n    }\n    // Map plain model ID â†’ inference profile ARN when appropriate (same logic as bedrock-config.ts)\n    const resolvedModelId = modelId === _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__.CLAUDE_SONNET_MODEL_ID && _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__.CLAUDE_SONNET_PROFILE_ARN ? _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__.CLAUDE_SONNET_PROFILE_ARN : modelId === _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__.CLAUDE_OPUS_MODEL_ID && _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__.CLAUDE_OPUS_PROFILE_ARN ? _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__.CLAUDE_OPUS_PROFILE_ARN : modelId;\n    // If resolved to an ARN, check region match\n    if (resolvedModelId.startsWith(\"arn:aws:bedrock:\")) {\n        const arnRegion = getRegionFromArn(resolvedModelId);\n        if (arnRegion && arnRegion !== configuredRegion) {\n            console.error(`\\n[Bedrock OCR] âŒ REGION MISMATCH DETECTED:\\n` + `  â€¢ Your AWS_REGION is set to: ${configuredRegion}\\n` + `  â€¢ But your profile ARN (from BEDROCK_PROFILE_ARN) is for region: ${arnRegion}\\n` + `  â€¢ This WILL cause \"model identifier invalid\" errors.\\n\\n` + `SOLUTION: Change AWS_REGION in .env.local to match the ARN region:\\n` + `  AWS_REGION=${arnRegion}\\n\\n` + `Or create new inference profiles in ${configuredRegion} and update your ARNs.\\n`);\n        }\n    }\n    if (!resolvedModelId || resolvedModelId.trim() === \"\") {\n        throw new Error(\"No Bedrock model configured. Set BEDROCK_LIGHT_MODEL_ID or BEDROCK_MODEL_ID in .env.local.\");\n    }\n    console.log(\"[Bedrock OCR] Using model:\", resolvedModelId);\n    return resolvedModelId;\n}\n/**\r\n * callBedrockForExtraction\r\n * ------------------------\r\n * Invokes Claude on AWS Bedrock with the provided prompt and returns\r\n * the plain-text response body. Uses the shared bedrockClient from\r\n * bedrock-config.ts to ensure region and credentials match the working\r\n * medical records processing code.\r\n *\r\n * Matches the Anthropic payload format and model resolution pattern\r\n * from processMedicalRecordWithClaude.\r\n */ async function callBedrockForExtraction(prompt, options) {\n    let resolvedModelId;\n    try {\n        // Resolve model ID first (throws if missing)\n        resolvedModelId = resolveModelId(options?.modelId);\n        const maxTokens = options?.maxTokens ?? 4000;\n        const temperature = options?.temperature ?? 0.2;\n        const input = {\n            modelId: resolvedModelId,\n            contentType: \"application/json\",\n            accept: \"application/json\",\n            body: JSON.stringify({\n                anthropic_version: \"bedrock-2023-05-31\",\n                max_tokens: maxTokens,\n                temperature,\n                messages: [\n                    {\n                        role: \"user\",\n                        content: prompt\n                    }\n                ]\n            })\n        };\n        const command = new _aws_sdk_client_bedrock_runtime__WEBPACK_IMPORTED_MODULE_1__.InvokeModelCommand(input);\n        const response = await _bedrock_config_ts_bedrock_config__WEBPACK_IMPORTED_MODULE_0__.bedrockClient.send(command);\n        // Convert raw response into text (same pattern as bedrock-config.ts)\n        const rawText = await (async ()=>{\n            const body = response.body;\n            if (typeof body?.transformToByteArray === \"function\") {\n                return new TextDecoder().decode(await body.transformToByteArray());\n            }\n            if (body instanceof Uint8Array) {\n                return new TextDecoder().decode(body);\n            }\n            return String(body ?? \"\");\n        })();\n        const responseBody = JSON.parse(rawText || \"{}\");\n        const claudeText = responseBody?.content?.[0]?.text || \"\";\n        return claudeText;\n    } catch (error) {\n        const msg = error instanceof Error ? error.message : \"Unknown error\";\n        // Include resolved model ID in validation error logs for debugging\n        if (msg.includes(\"ValidationException\")) {\n            console.error(\"[Bedrock OCR] Validation error for model:\", resolvedModelId || \"unknown\", error);\n        }\n        // Re-throw with context (matches bedrock-config.ts error handling)\n        if (msg.includes(\"UnrecognizedClientException\") || msg.includes(\"InvalidSignatureException\")) {\n            throw new Error(\"AWS Bedrock authentication failed.\");\n        }\n        if (msg.includes(\"ValidationException\")) {\n            throw new Error(\"AWS Bedrock validation error: \" + msg);\n        }\n        if (msg.includes(\"ModelNotReadyException\") || msg.includes(\"ThrottlingException\")) {\n            throw new Error(\"AWS Bedrock temporarily unavailable.\");\n        }\n        if (msg.includes(\"AccessDeniedException\")) {\n            throw new Error(\"Permission denied for AWS Bedrock.\");\n        }\n        throw new Error(\"Bedrock extraction failed: \" + msg);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LDZCQUE2QkYsSUFBSUUsUUFBUSxDQUFDLHdCQUF3QjtZQUNqRixNQUFNLElBQUloQyxNQUFNO1FBQ2xCO1FBQ0EsSUFBSThCLElBQUlFLFFBQVEsQ0FBQywwQkFBMEI7WUFDekMsTUFBTSxJQUFJaEMsTUFBTTtRQUNsQjtRQUVBLE1BQU0sSUFBSUEsTUFBTSxnQ0FBZ0M4QjtJQUNsRDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbGVtZWRpY2EtY2xpbmljLW9jci8uL3NyYy9zZXJ2aWNlcy9iZWRyb2NrQ2xpZW50LnRzPzA3YTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW52b2tlTW9kZWxDb21tYW5kIH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1iZWRyb2NrLXJ1bnRpbWVcIjtcclxuaW1wb3J0IHtcclxuICBiZWRyb2NrQ2xpZW50LFxyXG4gIENMQVVERV9PUFVTX01PREVMX0lELFxyXG4gIENMQVVERV9TT05ORVRfTU9ERUxfSUQsXHJcbiAgQ0xBVURFX09QVVNfUFJPRklMRV9BUk4sXHJcbiAgQ0xBVURFX1NPTk5FVF9QUk9GSUxFX0FSTixcclxufSBmcm9tIFwiLi4vLi4vYmVkcm9jay1jb25maWcudHMvYmVkcm9jay1jb25maWdcIjtcclxuXHJcbi8qKlxyXG4gKiBEZWZhdWx0IG1vZGVsIElEIHJlc29sdXRpb24gKG1hdGNoZXMgYmVkcm9jay1jb25maWcudHMgcGF0dGVybilcclxuICogRmFsbHMgYmFjayB0byBDTEFVREVfU09OTkVUX01PREVMX0lEIGlmIG5vIGVudiB2YXIgaXMgc2V0XHJcbiAqL1xyXG5jb25zdCBERUZBVUxUX01PREVMX0lEID1cclxuICBwcm9jZXNzLmVudi5CRURST0NLX0xJR0hUX01PREVMX0lEIHx8XHJcbiAgcHJvY2Vzcy5lbnYuQkVEUk9DS19NT0RFTF9JRCB8fFxyXG4gIENMQVVERV9TT05ORVRfTU9ERUxfSUQ7XHJcblxyXG4vKipcclxuICogRXh0cmFjdHMgcmVnaW9uIGZyb20gYW4gQVdTIEFSTiBvciByZXR1cm5zIHRoZSBjb25maWd1cmVkIHJlZ2lvblxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0UmVnaW9uRnJvbUFybihhcm46IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gIGNvbnN0IG1hdGNoID0gYXJuLm1hdGNoKC9hcm46YXdzOmJlZHJvY2s6KFteOl0rKTovKTtcclxuICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXSA6IG51bGw7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiByZXNvbHZlTW9kZWxJZFxyXG4gKiAtLS0tLS0tLS0tLS0tLVxyXG4gKiBSZXNvbHZlcyB0aGUgbW9kZWwgaWRlbnRpZmllciwgYXBwbHlpbmcgaW5mZXJlbmNlIHByb2ZpbGUgQVJOIG1hcHBpbmdcclxuICogd2hlbiBhcHByb3ByaWF0ZS4gTWF0Y2hlcyB0aGUgcGF0dGVybiB1c2VkIGluIHByb2Nlc3NNZWRpY2FsUmVjb3JkV2l0aENsYXVkZS5cclxuICogXHJcbiAqIElmIERFRkFVTFRfTU9ERUxfSUQgaXMgYWxyZWFkeSBhbiBBUk4sIGl0IHdpbGwgYmUgdXNlZCBkaXJlY3RseS5cclxuICogSWYgaXQncyBhIHBsYWluIG1vZGVsIElELCBpdCB3aWxsIGJlIG1hcHBlZCB0byBhIHByb2ZpbGUgQVJOIGlmIGF2YWlsYWJsZS5cclxuICovXHJcbmZ1bmN0aW9uIHJlc29sdmVNb2RlbElkKHByZWZlcnJlZD86IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgY29uc3QgY29uZmlndXJlZFJlZ2lvbiA9IHByb2Nlc3MuZW52LkFXU19SRUdJT04gfHwgcHJvY2Vzcy5lbnYuQVdTX0JFRFJPQ0tfUkVHSU9OIHx8IFwidXMtZWFzdC0xXCI7XHJcbiAgbGV0IG1vZGVsSWQgPSBwcmVmZXJyZWQgfHwgREVGQVVMVF9NT0RFTF9JRDtcclxuXHJcbiAgLy8gSWYgREVGQVVMVF9NT0RFTF9JRCBpcyBhbHJlYWR5IGFuIEFSTiAoc3RhcnRzIHdpdGggXCJhcm46YXdzOmJlZHJvY2s6XCIpLCB1c2UgaXQgZGlyZWN0bHlcclxuICBjb25zdCBpc0FscmVhZHlBcm4gPSBtb2RlbElkLnN0YXJ0c1dpdGgoXCJhcm46YXdzOmJlZHJvY2s6XCIpO1xyXG5cclxuICBpZiAoaXNBbHJlYWR5QXJuKSB7XHJcbiAgICAvLyBWYWxpZGF0ZSB0aGF0IEFSTiByZWdpb24gbWF0Y2hlcyBjb25maWd1cmVkIHJlZ2lvblxyXG4gICAgY29uc3QgYXJuUmVnaW9uID0gZ2V0UmVnaW9uRnJvbUFybihtb2RlbElkKTtcclxuICAgIGlmIChhcm5SZWdpb24gJiYgYXJuUmVnaW9uICE9PSBjb25maWd1cmVkUmVnaW9uKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXHJcbiAgICAgICAgYFxcbltCZWRyb2NrIE9DUl0g4p2MIFJFR0lPTiBNSVNNQVRDSCBERVRFQ1RFRDpcXG5gICtcclxuICAgICAgICBgICDigKIgWW91ciBBV1NfUkVHSU9OIGlzIHNldCB0bzogJHtjb25maWd1cmVkUmVnaW9ufVxcbmAgK1xyXG4gICAgICAgIGAgIOKAoiBCdXQgeW91ciBpbmZlcmVuY2UgcHJvZmlsZSBBUk4gaXMgZm9yIHJlZ2lvbjogJHthcm5SZWdpb259XFxuYCArXHJcbiAgICAgICAgYCAg4oCiIFRoaXMgV0lMTCBjYXVzZSBcIm1vZGVsIGlkZW50aWZpZXIgaW52YWxpZFwiIGVycm9ycy5cXG5cXG5gICtcclxuICAgICAgICBgU09MVVRJT046IENoYW5nZSBBV1NfUkVHSU9OIGluIC5lbnYubG9jYWwgdG8gbWF0Y2ggdGhlIEFSTiByZWdpb246XFxuYCArXHJcbiAgICAgICAgYCAgQVdTX1JFR0lPTj0ke2FyblJlZ2lvbn1cXG5cXG5gICtcclxuICAgICAgICBgT3IgY3JlYXRlIG5ldyBpbmZlcmVuY2UgcHJvZmlsZXMgaW4gJHtjb25maWd1cmVkUmVnaW9ufSBhbmQgdXBkYXRlIHlvdXIgQVJOcy5cXG5gXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhcIltCZWRyb2NrIE9DUl0gVXNpbmcgaW5mZXJlbmNlIHByb2ZpbGUgQVJOOlwiLCBtb2RlbElkLnN1YnN0cmluZygwLCA4MCkgKyBcIi4uLlwiKTtcclxuICAgIHJldHVybiBtb2RlbElkO1xyXG4gIH1cclxuXHJcbiAgLy8gTWFwIHBsYWluIG1vZGVsIElEIOKGkiBpbmZlcmVuY2UgcHJvZmlsZSBBUk4gd2hlbiBhcHByb3ByaWF0ZSAoc2FtZSBsb2dpYyBhcyBiZWRyb2NrLWNvbmZpZy50cylcclxuICBjb25zdCByZXNvbHZlZE1vZGVsSWQgPVxyXG4gICAgbW9kZWxJZCA9PT0gQ0xBVURFX1NPTk5FVF9NT0RFTF9JRCAmJiBDTEFVREVfU09OTkVUX1BST0ZJTEVfQVJOXHJcbiAgICAgID8gQ0xBVURFX1NPTk5FVF9QUk9GSUxFX0FSTlxyXG4gICAgICA6IG1vZGVsSWQgPT09IENMQVVERV9PUFVTX01PREVMX0lEICYmIENMQVVERV9PUFVTX1BST0ZJTEVfQVJOXHJcbiAgICAgID8gQ0xBVURFX09QVVNfUFJPRklMRV9BUk5cclxuICAgICAgOiBtb2RlbElkO1xyXG5cclxuICAvLyBJZiByZXNvbHZlZCB0byBhbiBBUk4sIGNoZWNrIHJlZ2lvbiBtYXRjaFxyXG4gIGlmIChyZXNvbHZlZE1vZGVsSWQuc3RhcnRzV2l0aChcImFybjphd3M6YmVkcm9jazpcIikpIHtcclxuICAgIGNvbnN0IGFyblJlZ2lvbiA9IGdldFJlZ2lvbkZyb21Bcm4ocmVzb2x2ZWRNb2RlbElkKTtcclxuICAgIGlmIChhcm5SZWdpb24gJiYgYXJuUmVnaW9uICE9PSBjb25maWd1cmVkUmVnaW9uKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXHJcbiAgICAgICAgYFxcbltCZWRyb2NrIE9DUl0g4p2MIFJFR0lPTiBNSVNNQVRDSCBERVRFQ1RFRDpcXG5gICtcclxuICAgICAgICBgICDigKIgWW91ciBBV1NfUkVHSU9OIGlzIHNldCB0bzogJHtjb25maWd1cmVkUmVnaW9ufVxcbmAgK1xyXG4gICAgICAgIGAgIOKAoiBCdXQgeW91ciBwcm9maWxlIEFSTiAoZnJvbSBCRURST0NLX1BST0ZJTEVfQVJOKSBpcyBmb3IgcmVnaW9uOiAke2FyblJlZ2lvbn1cXG5gICtcclxuICAgICAgICBgICDigKIgVGhpcyBXSUxMIGNhdXNlIFwibW9kZWwgaWRlbnRpZmllciBpbnZhbGlkXCIgZXJyb3JzLlxcblxcbmAgK1xyXG4gICAgICAgIGBTT0xVVElPTjogQ2hhbmdlIEFXU19SRUdJT04gaW4gLmVudi5sb2NhbCB0byBtYXRjaCB0aGUgQVJOIHJlZ2lvbjpcXG5gICtcclxuICAgICAgICBgICBBV1NfUkVHSU9OPSR7YXJuUmVnaW9ufVxcblxcbmAgK1xyXG4gICAgICAgIGBPciBjcmVhdGUgbmV3IGluZmVyZW5jZSBwcm9maWxlcyBpbiAke2NvbmZpZ3VyZWRSZWdpb259IGFuZCB1cGRhdGUgeW91ciBBUk5zLlxcbmBcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGlmICghcmVzb2x2ZWRNb2RlbElkIHx8IHJlc29sdmVkTW9kZWxJZC50cmltKCkgPT09IFwiXCIpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgXCJObyBCZWRyb2NrIG1vZGVsIGNvbmZpZ3VyZWQuIFNldCBCRURST0NLX0xJR0hUX01PREVMX0lEIG9yIEJFRFJPQ0tfTU9ERUxfSUQgaW4gLmVudi5sb2NhbC5cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGNvbnNvbGUubG9nKFwiW0JlZHJvY2sgT0NSXSBVc2luZyBtb2RlbDpcIiwgcmVzb2x2ZWRNb2RlbElkKTtcclxuICByZXR1cm4gcmVzb2x2ZWRNb2RlbElkO1xyXG59XHJcblxyXG4vKipcclxuICogY2FsbEJlZHJvY2tGb3JFeHRyYWN0aW9uXHJcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gKiBJbnZva2VzIENsYXVkZSBvbiBBV1MgQmVkcm9jayB3aXRoIHRoZSBwcm92aWRlZCBwcm9tcHQgYW5kIHJldHVybnNcclxuICogdGhlIHBsYWluLXRleHQgcmVzcG9uc2UgYm9keS4gVXNlcyB0aGUgc2hhcmVkIGJlZHJvY2tDbGllbnQgZnJvbVxyXG4gKiBiZWRyb2NrLWNvbmZpZy50cyB0byBlbnN1cmUgcmVnaW9uIGFuZCBjcmVkZW50aWFscyBtYXRjaCB0aGUgd29ya2luZ1xyXG4gKiBtZWRpY2FsIHJlY29yZHMgcHJvY2Vzc2luZyBjb2RlLlxyXG4gKlxyXG4gKiBNYXRjaGVzIHRoZSBBbnRocm9waWMgcGF5bG9hZCBmb3JtYXQgYW5kIG1vZGVsIHJlc29sdXRpb24gcGF0dGVyblxyXG4gKiBmcm9tIHByb2Nlc3NNZWRpY2FsUmVjb3JkV2l0aENsYXVkZS5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYWxsQmVkcm9ja0ZvckV4dHJhY3Rpb24oXHJcbiAgcHJvbXB0OiBzdHJpbmcsXHJcbiAgb3B0aW9ucz86IHsgbW9kZWxJZD86IHN0cmluZzsgbWF4VG9rZW5zPzogbnVtYmVyOyB0ZW1wZXJhdHVyZT86IG51bWJlciB9XHJcbik6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgbGV0IHJlc29sdmVkTW9kZWxJZDogc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICAvLyBSZXNvbHZlIG1vZGVsIElEIGZpcnN0ICh0aHJvd3MgaWYgbWlzc2luZylcclxuICAgIHJlc29sdmVkTW9kZWxJZCA9IHJlc29sdmVNb2RlbElkKG9wdGlvbnM/Lm1vZGVsSWQpO1xyXG4gICAgY29uc3QgbWF4VG9rZW5zID0gb3B0aW9ucz8ubWF4VG9rZW5zID8/IDQwMDA7XHJcbiAgICBjb25zdCB0ZW1wZXJhdHVyZSA9IG9wdGlvbnM/LnRlbXBlcmF0dXJlID8/IDAuMjtcclxuXHJcbiAgICBjb25zdCBpbnB1dCA9IHtcclxuICAgICAgbW9kZWxJZDogcmVzb2x2ZWRNb2RlbElkLFxyXG4gICAgICBjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhbnRocm9waWNfdmVyc2lvbjogXCJiZWRyb2NrLTIwMjMtMDUtMzFcIixcclxuICAgICAgICBtYXhfdG9rZW5zOiBtYXhUb2tlbnMsXHJcbiAgICAgICAgdGVtcGVyYXR1cmUsXHJcbiAgICAgICAgbWVzc2FnZXM6IFt7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBwcm9tcHQgfV0sXHJcbiAgICAgIH0pLFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBjb21tYW5kID0gbmV3IEludm9rZU1vZGVsQ29tbWFuZChpbnB1dCk7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGJlZHJvY2tDbGllbnQuc2VuZChjb21tYW5kKTtcclxuXHJcbiAgICAvLyBDb252ZXJ0IHJhdyByZXNwb25zZSBpbnRvIHRleHQgKHNhbWUgcGF0dGVybiBhcyBiZWRyb2NrLWNvbmZpZy50cylcclxuICAgIGNvbnN0IHJhd1RleHQgPSBhd2FpdCAoYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBib2R5OiBhbnkgPSAocmVzcG9uc2UgYXMgYW55KS5ib2R5O1xyXG4gICAgICBpZiAodHlwZW9mIGJvZHk/LnRyYW5zZm9ybVRvQnl0ZUFycmF5ID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGF3YWl0IGJvZHkudHJhbnNmb3JtVG9CeXRlQXJyYXkoKSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGJvZHkgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShib2R5KTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gU3RyaW5nKGJvZHkgPz8gXCJcIik7XHJcbiAgICB9KSgpO1xyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlQm9keSA9IEpTT04ucGFyc2UocmF3VGV4dCB8fCBcInt9XCIpO1xyXG4gICAgY29uc3QgY2xhdWRlVGV4dCA9IHJlc3BvbnNlQm9keT8uY29udGVudD8uWzBdPy50ZXh0IHx8IFwiXCI7XHJcblxyXG4gICAgcmV0dXJuIGNsYXVkZVRleHQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnN0IG1zZyA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yXCI7XHJcbiAgICBcclxuICAgIC8vIEluY2x1ZGUgcmVzb2x2ZWQgbW9kZWwgSUQgaW4gdmFsaWRhdGlvbiBlcnJvciBsb2dzIGZvciBkZWJ1Z2dpbmdcclxuICAgIGlmIChtc2cuaW5jbHVkZXMoXCJWYWxpZGF0aW9uRXhjZXB0aW9uXCIpKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJbQmVkcm9jayBPQ1JdIFZhbGlkYXRpb24gZXJyb3IgZm9yIG1vZGVsOlwiLCByZXNvbHZlZE1vZGVsSWQgfHwgXCJ1bmtub3duXCIsIGVycm9yKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZS10aHJvdyB3aXRoIGNvbnRleHQgKG1hdGNoZXMgYmVkcm9jay1jb25maWcudHMgZXJyb3IgaGFuZGxpbmcpXHJcbiAgICBpZiAobXNnLmluY2x1ZGVzKFwiVW5yZWNvZ25pemVkQ2xpZW50RXhjZXB0aW9uXCIpIHx8IG1zZy5pbmNsdWRlcyhcIkludmFsaWRTaWduYXR1cmVFeGNlcHRpb25cIikpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQVdTIEJlZHJvY2sgYXV0aGVudGljYXRpb24gZmFpbGVkLlwiKTtcclxuICAgIH1cclxuICAgIGlmIChtc2cuaW5jbHVkZXMoXCJWYWxpZGF0aW9uRXhjZXB0aW9uXCIpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkFXUyBCZWRyb2NrIHZhbGlkYXRpb24gZXJyb3I6IFwiICsgbXNnKTtcclxuICAgIH1cclxuICAgIGlmIChtc2cuaW5jbHVkZXMoXCJNb2RlbE5vdFJlYWR5RXhjZXB0aW9uXCIpIHx8IG1zZy5pbmNsdWRlcyhcIlRocm90dGxpbmdFeGNlcHRpb25cIikpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQVdTIEJlZHJvY2sgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuXCIpO1xyXG4gICAgfVxyXG4gICAgaWYgKG1zZy5pbmNsdWRlcyhcIkFjY2Vzc0RlbmllZEV4Y2VwdGlvblwiKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQZXJtaXNzaW9uIGRlbmllZCBmb3IgQVdTIEJlZHJvY2suXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHRocm93IG5ldyBFcnJvcihcIkJlZHJvY2sgZXh0cmFjdGlvbiBmYWlsZWQ6IFwiICsgbXNnKTtcclxuICB9XHJcbn1cclxuXHJcbiJdLCJuYW1lcyI6WyJJbnZva2VNb2RlbENvbW1hbmQiLCJiZWRyb2NrQ2xpZW50IiwiQ0xBVURFX09QVVNfTU9ERUxfSUQiLCJDTEFVREVfU09OTkVUX01PREVMX0lEIiwiQ0xBVURFX09QVVNfUFJPRklMRV9BUk4iLCJDTEFVREVfU09OTkVUX1BST0ZJTEVfQVJOIiwiREVGQVVMVF9NT0RFTF9JRCIsInByb2Nlc3MiLCJlbnYiLCJCRURST0NLX0xJR0hUX01PREVMX0lEIiwiQkVEUk9DS19NT0RFTF9JRCIsImdldFJlZ2lvbkZyb21Bcm4iLCJhcm4iLCJtYXRjaCIsInJlc29sdmVNb2RlbElkIiwicHJlZmVycmVkIiwiY29uZmlndXJlZFJlZ2lvbiIsIkFXU19SRUdJT04iLCJBV1NfQkVEUk9DS19SRUdJT04iLCJtb2RlbElkIiwiaXNBbHJlYWR5QXJuIiwic3RhcnRzV2l0aCIsImFyblJlZ2lvbiIsImNvbnNvbGUiLCJlcnJvciIsImxvZyIsInN1YnN0cmluZyIsInJlc29sdmVkTW9kZWxJZCIsInRyaW0iLCJFcnJvciIsImNhbGxCZWRyb2NrRm9yRXh0cmFjdGlvbiIsInByb21wdCIsIm9wdGlvbnMiLCJtYXhUb2tlbnMiLCJ0ZW1wZXJhdHVyZSIsImlucHV0IiwiY29udGVudFR5cGUiLCJhY2NlcHQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFudGhyb3BpY192ZXJzaW9uIiwibWF4X3Rva2VucyIsIm1lc3NhZ2VzIiwicm9sZSIsImNvbnRlbnQiLCJjb21tYW5kIiwicmVzcG9uc2UiLCJzZW5kIiwicmF3VGV4dCIsInRyYW5zZm9ybVRvQnl0ZUFycmF5IiwiVGV4dERlY29kZXIiLCJkZWNvZGUiLCJVaW50OEFycmF5IiwiU3RyaW5nIiwicmVzcG9uc2VCb2R5IiwicGFyc2UiLCJjbGF1ZGVUZXh0IiwidGV4dCIsIm1zZyIsIm1lc3NhZ2UiLCJpbmNsdWRlcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/services/bedrockClient.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/normalizer.ts":
/*!************************************!*\
  !*** ./src/services/normalizer.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   normalizePackageRow: () => (/* binding */ normalizePackageRow),\n/* harmony export */   validatePackageBatch: () => (/* binding */ validatePackageBatch)\n/* harmony export */ });\n/* harmony import */ var _lib_validation__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/validation */ \"(rsc)/./src/lib/validation.ts\");\n\nconst REQUIRED_FIELDS = [\n    \"title\",\n    \"hospital_name\",\n    \"treatment_name\",\n    \"price\",\n    \"currency\"\n];\nconst ALLOWED_CURRENCIES = [\n    \"USD\",\n    \"THB\",\n    \"EUR\",\n    \"GBP\",\n    \"SGD\",\n    \"MYR\",\n    \"KRW\"\n];\n/**\r\n * normalizePackageRow\r\n * -------------------\r\n * Cleans and normalizes a partially filled PackageRow object.\r\n * - Trims string fields and normalizes currency codes\r\n * - Parses numeric fields (price, original_price, commission)\r\n * - Applies default booleans/status values\r\n * - Runs fuzzy matching helpers and captures warnings\r\n */ function normalizePackageRow(row) {\n    const warnings = [\n        ...row._meta?.warnings ?? []\n    ];\n    const matcher = {\n        ...row._meta?.matcher ?? {}\n    };\n    const sanitized = {\n        title: normalizeString(row.title),\n        description: normalizeOptional(row.description),\n        details: normalizeOptional(row.details),\n        hospital_name: normalizeString(row.hospital_name),\n        treatment_name: normalizeString(row.treatment_name),\n        sub_treatments: normalizeOptional(row.sub_treatments),\n        price: parseNumber(row.price, \"price\", warnings),\n        original_price: parseOptionalNumber(row.original_price, \"original_price\", warnings),\n        currency: normalizeCurrency(row.currency, warnings),\n        duration: normalizeOptional(row.duration),\n        treatment_category: normalizeOptional(row.treatment_category),\n        anaesthesia: normalizeOptional(row.anaesthesia),\n        commission: parseOptionalNumber(row.commission, \"commission\", warnings),\n        featured: normalizeBoolean(row.featured, false),\n        status: normalizeStatus(row.status, warnings),\n        doctor_name: normalizeOptional(row.doctor_name),\n        is_le_package: normalizeBoolean(row.is_le_package, false),\n        includes: normalizeOptional(row.includes),\n        image_file_id: normalizeOptional(row.image_file_id),\n        hospital_location: normalizeOptional(row.hospital_location),\n        category: normalizeOptional(row.category),\n        hospital_country: normalizeOptional(row.hospital_country),\n        translation_title: normalizeOptional(row.translation_title),\n        translation_description: normalizeOptional(row.translation_description),\n        translation_details: normalizeOptional(row.translation_details),\n        translation: normalizeOptional(row.translation),\n        _meta: {\n            ...row._meta,\n            warnings,\n            matcher\n        }\n    };\n    applyMatching(\"hospital\", sanitized, matcher, warnings);\n    applyMatching(\"treatment\", sanitized, matcher, warnings);\n    return sanitized;\n}\n/**\r\n * validatePackageBatch\r\n * --------------------\r\n * Splits a list of PackageRow objects into valid / warning / invalid buckets.\r\n */ function validatePackageBatch(rows) {\n    const validPackages = [];\n    const packagesWithWarnings = [];\n    const invalidPackages = [];\n    for (const row of rows){\n        const missingRequired = REQUIRED_FIELDS.filter((field)=>{\n            if (field === \"price\") {\n                return row.price === null || row.price === undefined;\n            }\n            return !row[field]?.toString().trim();\n        });\n        if (missingRequired.length) {\n            row._meta = {\n                ...row._meta,\n                warnings: [\n                    ...row._meta?.warnings ?? [],\n                    `Missing required fields: ${missingRequired.join(\", \")}`\n                ]\n            };\n            invalidPackages.push(row);\n            continue;\n        }\n        const hasWarnings = (row._meta?.warnings ?? []).length > 0;\n        if (hasWarnings) {\n            packagesWithWarnings.push(row);\n        } else {\n            validPackages.push(row);\n        }\n    }\n    return {\n        validPackages,\n        packagesWithWarnings,\n        invalidPackages\n    };\n}\nfunction normalizeString(value) {\n    return (value ?? \"\").trim();\n}\nfunction normalizeOptional(value) {\n    const trimmed = (value ?? \"\").trim();\n    return trimmed.length ? trimmed : undefined;\n}\nfunction parseNumber(value, field, warnings) {\n    if (value === null || value === undefined || value === \"\") {\n        warnings.push(`${field} missing; set to null`);\n        return null;\n    }\n    const parsed = Number(value);\n    if (Number.isNaN(parsed)) {\n        warnings.push(`${field} is not a number; set to null`);\n        return null;\n    }\n    return parsed;\n}\nfunction parseOptionalNumber(value, field, warnings) {\n    if (value === null || value === undefined || value === \"\") {\n        return undefined;\n    }\n    const parsed = Number(value);\n    if (Number.isNaN(parsed)) {\n        warnings.push(`${field} is not a number; set to null`);\n        return null;\n    }\n    return parsed;\n}\nfunction normalizeCurrency(value, warnings) {\n    if (!value) {\n        warnings.push(\"currency missing; defaulting to USD\");\n        return \"USD\";\n    }\n    const upper = value.trim().toUpperCase().replace(\"à¸¿\", \"THB\");\n    if (!ALLOWED_CURRENCIES.includes(upper)) {\n        warnings.push(`currency ${value} not supported; defaulting to USD`);\n        return \"USD\";\n    }\n    return upper;\n}\nfunction normalizeBoolean(value, fallback) {\n    if (typeof value === \"boolean\") return value;\n    if (typeof value === \"string\") {\n        const normalized = value.toLowerCase();\n        if ([\n            \"true\",\n            \"1\",\n            \"yes\"\n        ].includes(normalized)) return true;\n        if ([\n            \"false\",\n            \"0\",\n            \"no\"\n        ].includes(normalized)) return false;\n    }\n    if (typeof value === \"number\") {\n        return value === 1;\n    }\n    return fallback;\n}\nfunction normalizeStatus(value, warnings) {\n    if (value === \"active\" || value === \"inactive\") {\n        return value;\n    }\n    warnings.push(\"status missing; defaulting to active\");\n    return \"active\";\n}\nfunction applyMatching(type, row, matcher, warnings) {\n    if (type === \"hospital\" && row.hospital_name) {\n        const result = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_0__.matchHospitalName)(row.hospital_name);\n        matcher.hospitalScore = result.score;\n        if (result.value) {\n            row.hospital_name = result.value;\n        } else if (row.hospital_name) {\n            warnings.push(`Hospital not recognized: ${row.hospital_name}`);\n        }\n    }\n    if (type === \"treatment\" && row.treatment_name) {\n        const result = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_0__.matchTreatmentName)(row.treatment_name);\n        matcher.treatmentScore = result.score;\n        if (result.value) {\n            row.treatment_name = result.value;\n        } else {\n            warnings.push(`Treatment not recognized: ${row.treatment_name}`);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUFBa0I7SUFDckQsSUFBSXFELFVBQVUsWUFBWUEsVUFBVSxZQUFZO1FBQzlDLE9BQU9BO0lBQ1Q7SUFDQXJELFNBQVNtRCxJQUFJLENBQUM7SUFDZCxPQUFPO0FBQ1Q7QUFFQSxTQUFTZCxjQUNQMkIsSUFBOEIsRUFDOUJqRSxHQUFlLEVBQ2ZHLE9BQWtELEVBQ2xERixRQUFrQjtJQUVsQixJQUFJZ0UsU0FBUyxjQUFjakUsSUFBSVUsYUFBYSxFQUFFO1FBQzVDLE1BQU13RCxTQUFTdkUsa0VBQWlCQSxDQUFDSyxJQUFJVSxhQUFhO1FBQ2xEUCxRQUFRZ0UsYUFBYSxHQUFHRCxPQUFPRSxLQUFLO1FBQ3BDLElBQUlGLE9BQU9aLEtBQUssRUFBRTtZQUNoQnRELElBQUlVLGFBQWEsR0FBR3dELE9BQU9aLEtBQUs7UUFDbEMsT0FBTyxJQUFJdEQsSUFBSVUsYUFBYSxFQUFFO1lBQzVCVCxTQUFTbUQsSUFBSSxDQUFDLENBQUMseUJBQXlCLEVBQUVwRCxJQUFJVSxhQUFhLENBQUMsQ0FBQztRQUMvRDtJQUNGO0lBRUEsSUFBSXVELFNBQVMsZUFBZWpFLElBQUlXLGNBQWMsRUFBRTtRQUM5QyxNQUFNdUQsU0FBU3RFLG1FQUFrQkEsQ0FBQ0ksSUFBSVcsY0FBYztRQUNwRFIsUUFBUWtFLGNBQWMsR0FBR0gsT0FBT0UsS0FBSztRQUNyQyxJQUFJRixPQUFPWixLQUFLLEVBQUU7WUFDaEJ0RCxJQUFJVyxjQUFjLEdBQUd1RCxPQUFPWixLQUFLO1FBQ25DLE9BQU87WUFDTHJELFNBQVNtRCxJQUFJLENBQUMsQ0FBQywwQkFBMEIsRUFBRXBELElBQUlXLGNBQWMsQ0FBQyxDQUFDO1FBQ2pFO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2xlbWVkaWNhLWNsaW5pYy1vY3IvLi9zcmMvc2VydmljZXMvbm9ybWFsaXplci50cz8yNGRiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgUGFja2FnZVJvd30gZnJvbSBcIkAvbGliL3R5cGVzL29jclwiO1xyXG5pbXBvcnQgeyBtYXRjaEhvc3BpdGFsTmFtZSwgbWF0Y2hUcmVhdG1lbnROYW1lIH0gZnJvbSBcIkAvbGliL3ZhbGlkYXRpb25cIjtcclxuXHJcbmNvbnN0IFJFUVVJUkVEX0ZJRUxEUzogQXJyYXk8a2V5b2YgUGFja2FnZVJvdz4gPSBbXHJcbiAgXCJ0aXRsZVwiLFxyXG4gIFwiaG9zcGl0YWxfbmFtZVwiLFxyXG4gIFwidHJlYXRtZW50X25hbWVcIixcclxuICBcInByaWNlXCIsXHJcbiAgXCJjdXJyZW5jeVwiLFxyXG5dO1xyXG5cclxuY29uc3QgQUxMT1dFRF9DVVJSRU5DSUVTID0gW1wiVVNEXCIsIFwiVEhCXCIsIFwiRVVSXCIsIFwiR0JQXCIsIFwiU0dEXCIsIFwiTVlSXCIsIFwiS1JXXCJdO1xyXG5cclxuLyoqXHJcbiAqIG5vcm1hbGl6ZVBhY2thZ2VSb3dcclxuICogLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gKiBDbGVhbnMgYW5kIG5vcm1hbGl6ZXMgYSBwYXJ0aWFsbHkgZmlsbGVkIFBhY2thZ2VSb3cgb2JqZWN0LlxyXG4gKiAtIFRyaW1zIHN0cmluZyBmaWVsZHMgYW5kIG5vcm1hbGl6ZXMgY3VycmVuY3kgY29kZXNcclxuICogLSBQYXJzZXMgbnVtZXJpYyBmaWVsZHMgKHByaWNlLCBvcmlnaW5hbF9wcmljZSwgY29tbWlzc2lvbilcclxuICogLSBBcHBsaWVzIGRlZmF1bHQgYm9vbGVhbnMvc3RhdHVzIHZhbHVlc1xyXG4gKiAtIFJ1bnMgZnV6enkgbWF0Y2hpbmcgaGVscGVycyBhbmQgY2FwdHVyZXMgd2FybmluZ3NcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVQYWNrYWdlUm93KHJvdzogUGFydGlhbDxQYWNrYWdlUm93Pik6IFBhY2thZ2VSb3cge1xyXG4gIGNvbnN0IHdhcm5pbmdzID0gWy4uLihyb3cuX21ldGE/Lndhcm5pbmdzID8/IFtdKV07XHJcbiAgY29uc3QgbWF0Y2hlciA9IHsgLi4uKHJvdy5fbWV0YT8ubWF0Y2hlciA/PyB7fSkgfTtcclxuXHJcbiAgY29uc3Qgc2FuaXRpemVkOiBQYWNrYWdlUm93ID0ge1xyXG4gICAgdGl0bGU6IG5vcm1hbGl6ZVN0cmluZyhyb3cudGl0bGUpLFxyXG4gICAgZGVzY3JpcHRpb246IG5vcm1hbGl6ZU9wdGlvbmFsKHJvdy5kZXNjcmlwdGlvbiksXHJcbiAgICBkZXRhaWxzOiBub3JtYWxpemVPcHRpb25hbChyb3cuZGV0YWlscyksXHJcbiAgICBob3NwaXRhbF9uYW1lOiBub3JtYWxpemVTdHJpbmcocm93Lmhvc3BpdGFsX25hbWUpLFxyXG4gICAgdHJlYXRtZW50X25hbWU6IG5vcm1hbGl6ZVN0cmluZyhyb3cudHJlYXRtZW50X25hbWUpLFxyXG4gICAgc3ViX3RyZWF0bWVudHM6IG5vcm1hbGl6ZU9wdGlvbmFsKHJvdy5zdWJfdHJlYXRtZW50cyksXHJcbiAgICBwcmljZTogcGFyc2VOdW1iZXIocm93LnByaWNlLCBcInByaWNlXCIsIHdhcm5pbmdzKSxcclxuICAgIG9yaWdpbmFsX3ByaWNlOiBwYXJzZU9wdGlvbmFsTnVtYmVyKHJvdy5vcmlnaW5hbF9wcmljZSwgXCJvcmlnaW5hbF9wcmljZVwiLCB3YXJuaW5ncyksXHJcbiAgICBjdXJyZW5jeTogbm9ybWFsaXplQ3VycmVuY3kocm93LmN1cnJlbmN5LCB3YXJuaW5ncyksXHJcbiAgICBkdXJhdGlvbjogbm9ybWFsaXplT3B0aW9uYWwocm93LmR1cmF0aW9uKSxcclxuICAgIHRyZWF0bWVudF9jYXRlZ29yeTogbm9ybWFsaXplT3B0aW9uYWwocm93LnRyZWF0bWVudF9jYXRlZ29yeSksXHJcbiAgICBhbmFlc3RoZXNpYTogbm9ybWFsaXplT3B0aW9uYWwocm93LmFuYWVzdGhlc2lhKSxcclxuICAgIGNvbW1pc3Npb246IHBhcnNlT3B0aW9uYWxOdW1iZXIocm93LmNvbW1pc3Npb24sIFwiY29tbWlzc2lvblwiLCB3YXJuaW5ncyksXHJcbiAgICBmZWF0dXJlZDogbm9ybWFsaXplQm9vbGVhbihyb3cuZmVhdHVyZWQsIGZhbHNlKSxcclxuICAgIHN0YXR1czogbm9ybWFsaXplU3RhdHVzKHJvdy5zdGF0dXMsIHdhcm5pbmdzKSxcclxuICAgIGRvY3Rvcl9uYW1lOiBub3JtYWxpemVPcHRpb25hbChyb3cuZG9jdG9yX25hbWUpLFxyXG4gICAgaXNfbGVfcGFja2FnZTogbm9ybWFsaXplQm9vbGVhbihyb3cuaXNfbGVfcGFja2FnZSwgZmFsc2UpLFxyXG4gICAgaW5jbHVkZXM6IG5vcm1hbGl6ZU9wdGlvbmFsKHJvdy5pbmNsdWRlcyksXHJcbiAgICBpbWFnZV9maWxlX2lkOiBub3JtYWxpemVPcHRpb25hbChyb3cuaW1hZ2VfZmlsZV9pZCksXHJcbiAgICBob3NwaXRhbF9sb2NhdGlvbjogbm9ybWFsaXplT3B0aW9uYWwocm93Lmhvc3BpdGFsX2xvY2F0aW9uKSxcclxuICAgIGNhdGVnb3J5OiBub3JtYWxpemVPcHRpb25hbChyb3cuY2F0ZWdvcnkpLFxyXG4gICAgaG9zcGl0YWxfY291bnRyeTogbm9ybWFsaXplT3B0aW9uYWwocm93Lmhvc3BpdGFsX2NvdW50cnkpLFxyXG4gICAgdHJhbnNsYXRpb25fdGl0bGU6IG5vcm1hbGl6ZU9wdGlvbmFsKHJvdy50cmFuc2xhdGlvbl90aXRsZSksXHJcbiAgICB0cmFuc2xhdGlvbl9kZXNjcmlwdGlvbjogbm9ybWFsaXplT3B0aW9uYWwocm93LnRyYW5zbGF0aW9uX2Rlc2NyaXB0aW9uKSxcclxuICAgIHRyYW5zbGF0aW9uX2RldGFpbHM6IG5vcm1hbGl6ZU9wdGlvbmFsKHJvdy50cmFuc2xhdGlvbl9kZXRhaWxzKSxcclxuICAgIHRyYW5zbGF0aW9uOiBub3JtYWxpemVPcHRpb25hbChyb3cudHJhbnNsYXRpb24pLFxyXG4gICAgX21ldGE6IHtcclxuICAgICAgLi4ucm93Ll9tZXRhLFxyXG4gICAgICB3YXJuaW5ncyxcclxuICAgICAgbWF0Y2hlcixcclxuICAgIH0sXHJcbiAgfTtcclxuXHJcbiAgYXBwbHlNYXRjaGluZyhcImhvc3BpdGFsXCIsIHNhbml0aXplZCwgbWF0Y2hlciwgd2FybmluZ3MpO1xyXG4gIGFwcGx5TWF0Y2hpbmcoXCJ0cmVhdG1lbnRcIiwgc2FuaXRpemVkLCBtYXRjaGVyLCB3YXJuaW5ncyk7XHJcblxyXG4gIHJldHVybiBzYW5pdGl6ZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiB2YWxpZGF0ZVBhY2thZ2VCYXRjaFxyXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gKiBTcGxpdHMgYSBsaXN0IG9mIFBhY2thZ2VSb3cgb2JqZWN0cyBpbnRvIHZhbGlkIC8gd2FybmluZyAvIGludmFsaWQgYnVja2V0cy5cclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBhY2thZ2VCYXRjaChyb3dzOiBQYWNrYWdlUm93W10pOiB7XHJcbiAgdmFsaWRQYWNrYWdlczogUGFja2FnZVJvd1tdO1xyXG4gIHBhY2thZ2VzV2l0aFdhcm5pbmdzOiBQYWNrYWdlUm93W107XHJcbiAgaW52YWxpZFBhY2thZ2VzOiBQYWNrYWdlUm93W107XHJcbn0ge1xyXG4gIGNvbnN0IHZhbGlkUGFja2FnZXM6IFBhY2thZ2VSb3dbXSA9IFtdO1xyXG4gIGNvbnN0IHBhY2thZ2VzV2l0aFdhcm5pbmdzOiBQYWNrYWdlUm93W10gPSBbXTtcclxuICBjb25zdCBpbnZhbGlkUGFja2FnZXM6IFBhY2thZ2VSb3dbXSA9IFtdO1xyXG5cclxuICBmb3IgKGNvbnN0IHJvdyBvZiByb3dzKSB7XHJcbiAgICBjb25zdCBtaXNzaW5nUmVxdWlyZWQgPSBSRVFVSVJFRF9GSUVMRFMuZmlsdGVyKChmaWVsZCkgPT4ge1xyXG4gICAgICBpZiAoZmllbGQgPT09IFwicHJpY2VcIikge1xyXG4gICAgICAgIHJldHVybiByb3cucHJpY2UgPT09IG51bGwgfHwgcm93LnByaWNlID09PSB1bmRlZmluZWQ7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuICFyb3dbZmllbGRdPy50b1N0cmluZygpLnRyaW0oKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGlmIChtaXNzaW5nUmVxdWlyZWQubGVuZ3RoKSB7XHJcbiAgICAgIHJvdy5fbWV0YSA9IHtcclxuICAgICAgICAuLi5yb3cuX21ldGEsXHJcbiAgICAgICAgd2FybmluZ3M6IFtcclxuICAgICAgICAgIC4uLihyb3cuX21ldGE/Lndhcm5pbmdzID8/IFtdKSxcclxuICAgICAgICAgIGBNaXNzaW5nIHJlcXVpcmVkIGZpZWxkczogJHttaXNzaW5nUmVxdWlyZWQuam9pbihcIiwgXCIpfWAsXHJcbiAgICAgICAgXSxcclxuICAgICAgfTtcclxuICAgICAgaW52YWxpZFBhY2thZ2VzLnB1c2gocm93KTtcclxuICAgICAgY29udGludWU7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaGFzV2FybmluZ3MgPSAocm93Ll9tZXRhPy53YXJuaW5ncyA/PyBbXSkubGVuZ3RoID4gMDtcclxuICAgIGlmIChoYXNXYXJuaW5ncykge1xyXG4gICAgICBwYWNrYWdlc1dpdGhXYXJuaW5ncy5wdXNoKHJvdyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB2YWxpZFBhY2thZ2VzLnB1c2gocm93KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB7IHZhbGlkUGFja2FnZXMsIHBhY2thZ2VzV2l0aFdhcm5pbmdzLCBpbnZhbGlkUGFja2FnZXMgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gbm9ybWFsaXplU3RyaW5nKHZhbHVlOiBzdHJpbmcgfCB1bmRlZmluZWQpOiBzdHJpbmcge1xyXG4gIHJldHVybiAodmFsdWUgPz8gXCJcIikudHJpbSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBub3JtYWxpemVPcHRpb25hbCh2YWx1ZTogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XHJcbiAgY29uc3QgdHJpbW1lZCA9ICh2YWx1ZSA/PyBcIlwiKS50cmltKCk7XHJcbiAgcmV0dXJuIHRyaW1tZWQubGVuZ3RoID8gdHJpbW1lZCA6IHVuZGVmaW5lZDtcclxufVxyXG5cclxuZnVuY3Rpb24gcGFyc2VOdW1iZXIodmFsdWU6IGFueSwgZmllbGQ6IHN0cmluZywgd2FybmluZ3M6IHN0cmluZ1tdKTogbnVtYmVyIHwgbnVsbCB7XHJcbiAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IFwiXCIpIHtcclxuICAgIHdhcm5pbmdzLnB1c2goYCR7ZmllbGR9IG1pc3Npbmc7IHNldCB0byBudWxsYCk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgY29uc3QgcGFyc2VkID0gTnVtYmVyKHZhbHVlKTtcclxuICBpZiAoTnVtYmVyLmlzTmFOKHBhcnNlZCkpIHtcclxuICAgIHdhcm5pbmdzLnB1c2goYCR7ZmllbGR9IGlzIG5vdCBhIG51bWJlcjsgc2V0IHRvIG51bGxgKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuICByZXR1cm4gcGFyc2VkO1xyXG59XHJcblxyXG5mdW5jdGlvbiBwYXJzZU9wdGlvbmFsTnVtYmVyKFxyXG4gIHZhbHVlOiBhbnksXHJcbiAgZmllbGQ6IHN0cmluZyxcclxuICB3YXJuaW5nczogc3RyaW5nW11cclxuKTogbnVtYmVyIHwgbnVsbCB8IHVuZGVmaW5lZCB7XHJcbiAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09IFwiXCIpIHtcclxuICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgfVxyXG4gIGNvbnN0IHBhcnNlZCA9IE51bWJlcih2YWx1ZSk7XHJcbiAgaWYgKE51bWJlci5pc05hTihwYXJzZWQpKSB7XHJcbiAgICB3YXJuaW5ncy5wdXNoKGAke2ZpZWxkfSBpcyBub3QgYSBudW1iZXI7IHNldCB0byBudWxsYCk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgcmV0dXJuIHBhcnNlZDtcclxufVxyXG5cclxuZnVuY3Rpb24gbm9ybWFsaXplQ3VycmVuY3kodmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCwgd2FybmluZ3M6IHN0cmluZ1tdKTogc3RyaW5nIHtcclxuICBpZiAoIXZhbHVlKSB7XHJcbiAgICB3YXJuaW5ncy5wdXNoKFwiY3VycmVuY3kgbWlzc2luZzsgZGVmYXVsdGluZyB0byBVU0RcIik7XHJcbiAgICByZXR1cm4gXCJVU0RcIjtcclxuICB9XHJcbiAgY29uc3QgdXBwZXIgPSB2YWx1ZS50cmltKCkudG9VcHBlckNhc2UoKS5yZXBsYWNlKFwi4Li/XCIsIFwiVEhCXCIpO1xyXG4gIGlmICghQUxMT1dFRF9DVVJSRU5DSUVTLmluY2x1ZGVzKHVwcGVyKSkge1xyXG4gICAgd2FybmluZ3MucHVzaChgY3VycmVuY3kgJHt2YWx1ZX0gbm90IHN1cHBvcnRlZDsgZGVmYXVsdGluZyB0byBVU0RgKTtcclxuICAgIHJldHVybiBcIlVTRFwiO1xyXG4gIH1cclxuICByZXR1cm4gdXBwZXI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5vcm1hbGl6ZUJvb2xlYW4odmFsdWU6IGFueSwgZmFsbGJhY2s6IGJvb2xlYW4pOiBib29sZWFuIHtcclxuICBpZiAodHlwZW9mIHZhbHVlID09PSBcImJvb2xlYW5cIikgcmV0dXJuIHZhbHVlO1xyXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcclxuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB2YWx1ZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgaWYgKFtcInRydWVcIiwgXCIxXCIsIFwieWVzXCJdLmluY2x1ZGVzKG5vcm1hbGl6ZWQpKSByZXR1cm4gdHJ1ZTtcclxuICAgIGlmIChbXCJmYWxzZVwiLCBcIjBcIiwgXCJub1wiXS5pbmNsdWRlcyhub3JtYWxpemVkKSkgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm51bWJlclwiKSB7XHJcbiAgICByZXR1cm4gdmFsdWUgPT09IDE7XHJcbiAgfVxyXG4gIHJldHVybiBmYWxsYmFjaztcclxufVxyXG5cclxuZnVuY3Rpb24gbm9ybWFsaXplU3RhdHVzKHZhbHVlOiBhbnksIHdhcm5pbmdzOiBzdHJpbmdbXSk6IFwiYWN0aXZlXCIgfCBcImluYWN0aXZlXCIge1xyXG4gIGlmICh2YWx1ZSA9PT0gXCJhY3RpdmVcIiB8fCB2YWx1ZSA9PT0gXCJpbmFjdGl2ZVwiKSB7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG4gIHdhcm5pbmdzLnB1c2goXCJzdGF0dXMgbWlzc2luZzsgZGVmYXVsdGluZyB0byBhY3RpdmVcIik7XHJcbiAgcmV0dXJuIFwiYWN0aXZlXCI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFwcGx5TWF0Y2hpbmcoXHJcbiAgdHlwZTogXCJob3NwaXRhbFwiIHwgXCJ0cmVhdG1lbnRcIixcclxuICByb3c6IFBhY2thZ2VSb3csXHJcbiAgbWF0Y2hlcjogUmVjb3JkPHN0cmluZywgbnVtYmVyIHwgbnVsbCB8IHVuZGVmaW5lZD4sXHJcbiAgd2FybmluZ3M6IHN0cmluZ1tdXHJcbikge1xyXG4gIGlmICh0eXBlID09PSBcImhvc3BpdGFsXCIgJiYgcm93Lmhvc3BpdGFsX25hbWUpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IG1hdGNoSG9zcGl0YWxOYW1lKHJvdy5ob3NwaXRhbF9uYW1lKTtcclxuICAgIG1hdGNoZXIuaG9zcGl0YWxTY29yZSA9IHJlc3VsdC5zY29yZTtcclxuICAgIGlmIChyZXN1bHQudmFsdWUpIHtcclxuICAgICAgcm93Lmhvc3BpdGFsX25hbWUgPSByZXN1bHQudmFsdWU7XHJcbiAgICB9IGVsc2UgaWYgKHJvdy5ob3NwaXRhbF9uYW1lKSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goYEhvc3BpdGFsIG5vdCByZWNvZ25pemVkOiAke3Jvdy5ob3NwaXRhbF9uYW1lfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaWYgKHR5cGUgPT09IFwidHJlYXRtZW50XCIgJiYgcm93LnRyZWF0bWVudF9uYW1lKSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBtYXRjaFRyZWF0bWVudE5hbWUocm93LnRyZWF0bWVudF9uYW1lKTtcclxuICAgIG1hdGNoZXIudHJlYXRtZW50U2NvcmUgPSByZXN1bHQuc2NvcmU7XHJcbiAgICBpZiAocmVzdWx0LnZhbHVlKSB7XHJcbiAgICAgIHJvdy50cmVhdG1lbnRfbmFtZSA9IHJlc3VsdC52YWx1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHdhcm5pbmdzLnB1c2goYFRyZWF0bWVudCBub3QgcmVjb2duaXplZDogJHtyb3cudHJlYXRtZW50X25hbWV9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4iXSwibmFtZXMiOlsibWF0Y2hIb3NwaXRhbE5hbWUiLCJtYXRjaFRyZWF0bWVudE5hbWUiLCJSRVFVSVJFRF9GSUVMRFMiLCJBTExPV0VEX0NVUlJFTkNJRVMiLCJub3JtYWxpemVQYWNrYWdlUm93Iiwicm93Iiwid2FybmluZ3MiLCJfbWV0YSIsIm1hdGNoZXIiLCJzYW5pdGl6ZWQiLCJ0aXRsZSIsIm5vcm1hbGl6ZVN0cmluZyIsImRlc2NyaXB0aW9uIiwibm9ybWFsaXplT3B0aW9uYWwiLCJkZXRhaWxzIiwiaG9zcGl0YWxfbmFtZSIsInRyZWF0bWVudF9uYW1lIiwic3ViX3RyZWF0bWVudHMiLCJwcmljZSIsInBhcnNlTnVtYmVyIiwib3JpZ2luYWxfcHJpY2UiLCJwYXJzZU9wdGlvbmFsTnVtYmVyIiwiY3VycmVuY3kiLCJub3JtYWxpemVDdXJyZW5jeSIsImR1cmF0aW9uIiwidHJlYXRtZW50X2NhdGVnb3J5IiwiYW5hZXN0aGVzaWEiLCJjb21taXNzaW9uIiwiZmVhdHVyZWQiLCJub3JtYWxpemVCb29sZWFuIiwic3RhdHVzIiwibm9ybWFsaXplU3RhdHVzIiwiZG9jdG9yX25hbWUiLCJpc19sZV9wYWNrYWdlIiwiaW5jbHVkZXMiLCJpbWFnZV9maWxlX2lkIiwiaG9zcGl0YWxfbG9jYXRpb24iLCJjYXRlZ29yeSIsImhvc3BpdGFsX2NvdW50cnkiLCJ0cmFuc2xhdGlvbl90aXRsZSIsInRyYW5zbGF0aW9uX2Rlc2NyaXB0aW9uIiwidHJhbnNsYXRpb25fZGV0YWlscyIsInRyYW5zbGF0aW9uIiwiYXBwbHlNYXRjaGluZyIsInZhbGlkYXRlUGFja2FnZUJhdGNoIiwicm93cyIsInZhbGlkUGFja2FnZXMiLCJwYWNrYWdlc1dpdGhXYXJuaW5ncyIsImludmFsaWRQYWNrYWdlcyIsIm1pc3NpbmdSZXF1aXJlZCIsImZpbHRlciIsImZpZWxkIiwidW5kZWZpbmVkIiwidG9TdHJpbmciLCJ0cmltIiwibGVuZ3RoIiwiam9pbiIsInB1c2giLCJoYXNXYXJuaW5ncyIsInZhbHVlIiwidHJpbW1lZCIsInBhcnNlZCIsIk51bWJlciIsImlzTmFOIiwidXBwZXIiLCJ0b1VwcGVyQ2FzZSIsInJlcGxhY2UiLCJmYWxsYmFjayIsIm5vcm1hbGl6ZWQiLCJ0b0xvd2VyQ2FzZSIsInR5cGUiLCJyZXN1bHQiLCJob3NwaXRhbFNjb3JlIiwic2NvcmUiLCJ0cmVhdG1lbnRTY29yZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/services/normalizer.ts\n");

/***/ }),

/***/ "(rsc)/./src/services/ocr.ts":
/*!*****************************!*\
  !*** ./src/services/ocr.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handleUploadAndExtractOcr: () => (/* binding */ handleUploadAndExtractOcr),\n/* harmony export */   runOcrOnFiles: () => (/* binding */ runOcrOnFiles)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var tesseract_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! tesseract.js */ \"(rsc)/./node_modules/tesseract.js/src/index.js\");\n/* harmony import */ var tesseract_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(tesseract_js__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pdf-parse */ \"(rsc)/./node_modules/pdf-parse/index.js\");\n/* harmony import */ var pdf_parse__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(pdf_parse__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\n\nconst OCR_DEBUG_DIR = (0,path__WEBPACK_IMPORTED_MODULE_1__.join)(process.cwd(), \"tmp\", \"ocr-debug\");\n// Toggle with an env var so prod isnâ€™t spammed\nconst OCR_DEBUG_ENABLED = process.env.OCR_DEBUG === \"1\";\nconst TEMP_DIR = (0,path__WEBPACK_IMPORTED_MODULE_1__.join)(process.cwd(), \"tmp\", \"ocr-uploads\");\nconst MAX_FILE_SIZE_BYTES = Number(process.env.OCR_MAX_FILE_MB || 25) * 1024 * 1024;\nconst ALLOWED_MIME_TYPES = new Set([\n    \"application/pdf\",\n    \"image/jpeg\",\n    \"image/png\",\n    \"image/heic\",\n    \"image/heif\"\n]);\n// -----------------------------------------------------------------------------\n// OCR language + timeout config\n// -----------------------------------------------------------------------------\n// Languages for Tesseract OCR. Override via .env.local, e.g.\n//   OCR_LANGS=eng+chi_sim\n//   OCR_LANGS=eng+chi_sim+tha+ms\n//\n// IMPORTANT: More languages = heavier + slower. For Chinese-heavy menus, try:\n//   OCR_LANGS=eng+chi_sim\n//\nconst OCR_LANGS = process.env.OCR_LANGS || \"eng+chi_sim+tha+ms+kor\";\n// Max time (ms) we are willing to wait for a single Tesseract.recognize() call.\n// Prevents \"Chinese JPEG runs forever\" hangs.\nconst OCR_TIMEOUT_MS = Number(process.env.OCR_TIMEOUT_MS || 60000);\n/**\r\n * handleUploadAndExtractOcr\r\n * -------------------------\r\n * Accepts uploaded files from a NextRequest, validates them, writes the content\r\n * to a temp folder, runs OCR per page, and returns a list of OcrPage objects.\r\n */ async function handleUploadAndExtractOcr(req) {\n    ensureTempDirectory();\n    // ðŸ”¹ Generate the batch ID ONCE and reuse it everywhere\n    const batchId = generateFriendlyBatchId();\n    const formData = await req.formData();\n    const incomingFiles = extractFilesFromFormData(formData);\n    if (!incomingFiles.length) {\n        throw createHttpError(400, \"No file provided. Please append `file` or `files[]` to FormData.\");\n    }\n    const savedFiles = [];\n    for (const file of incomingFiles){\n        if (!ALLOWED_MIME_TYPES.has(file.type)) {\n            throw createHttpError(400, \"Unsupported file type. Please upload PDF, JPG, PNG, or HEIC.\");\n        }\n        if (file.size > MAX_FILE_SIZE_BYTES) {\n            throw createHttpError(413, `File exceeds the maximum allowed size of ${Math.round(MAX_FILE_SIZE_BYTES / (1024 * 1024))} MB.`);\n        }\n        const fileId = (0,crypto__WEBPACK_IMPORTED_MODULE_2__.randomUUID)();\n        // ðŸ”¹ Use only the last path segment (strip folder parts)\n        const originalName = file.name || `upload-${fileId}`;\n        const baseName = originalName.split(/[\\\\/]/).pop() || originalName;\n        // ðŸ”¹ Sanitize for filesystem (no weird chars / slashes)\n        const safeName = baseName.replace(/[^\\w.\\-]+/g, \"_\");\n        const tempPath = (0,path__WEBPACK_IMPORTED_MODULE_1__.join)(TEMP_DIR, `${fileId}-${safeName}`);\n        const buffer = Buffer.from(await file.arrayBuffer());\n        await fs__WEBPACK_IMPORTED_MODULE_0__.promises.writeFile(tempPath, buffer);\n        savedFiles.push({\n            fileId,\n            fileName: baseName,\n            mimeType: file.type,\n            path: tempPath\n        });\n    }\n    const ocrPages = await runOcrOnFiles(savedFiles);\n    const filesMeta = summarizeFiles(savedFiles, ocrPages);\n    // ðŸ”¹ Only valid now because batchId is defined above\n    if (OCR_DEBUG_ENABLED) {\n        await saveOcrDebugSnapshot(batchId, ocrPages);\n    }\n    return {\n        batchId,\n        ocrPages,\n        filesMeta\n    };\n}\n/**\r\n * runOcrOnFiles\r\n * --------------\r\n * Runs OCR on each page of the uploaded files and returns\r\n * OcrPage objects that retain page ordering and metadata.\r\n */ async function runOcrOnFiles(files) {\n    const pages = [];\n    for (const file of files){\n        if (file.mimeType === \"application/pdf\") {\n            const pdfPages = await runOcrOnPdf(file);\n            pages.push(...pdfPages);\n            continue;\n        }\n        // Image file: use Tesseract directly with multi-language support\n        const buffer = await fs__WEBPACK_IMPORTED_MODULE_0__.promises.readFile(file.path);\n        const text = await runTesseract(buffer);\n        pages.push({\n            fileId: file.fileId,\n            fileName: file.fileName,\n            pageNumber: 1,\n            rawText: cleanText(text)\n        });\n    }\n    return pages;\n}\nasync function saveOcrDebugSnapshot(batchId, pages) {\n    try {\n        (0,fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync)(OCR_DEBUG_DIR, {\n            recursive: true\n        });\n        for (const page of pages){\n            const safeFile = page.fileName.replace(/[^\\w.-]+/g, \"_\");\n            const debugName = `${batchId}_p${page.pageNumber}_${safeFile}.txt`;\n            const debugPath = (0,path__WEBPACK_IMPORTED_MODULE_1__.join)(OCR_DEBUG_DIR, debugName);\n            const content = `BATCH: ${batchId}\\n` + `FILE:  ${page.fileName}\\n` + `PAGE:  ${page.pageNumber}\\n` + `----------------------------------------\\n` + page.rawText;\n            await fs__WEBPACK_IMPORTED_MODULE_0__.promises.writeFile(debugPath, content, \"utf8\");\n        }\n        console.log(`[OCR DEBUG] Saved page-level text for batch ${batchId} to ${OCR_DEBUG_DIR}`);\n    } catch (err) {\n        console.error(\"[OCR DEBUG] Failed to save snapshot:\", err);\n    }\n}\n/**\r\n * runOcrOnPdf\r\n * -----------\r\n * Uses pdf-parse to extract text per page.\r\n * If pdf-parse returns nothing, we still emit one empty page entry.\r\n *\r\n * NOTE: This path is text-based; if you need image-based PDF OCR later,\r\n * you can add a Tesseract fallback here that rasterizes pages.\r\n */ async function runOcrOnPdf(file) {\n    const buffer = await fs__WEBPACK_IMPORTED_MODULE_0__.promises.readFile(file.path);\n    const pageTexts = [];\n    const options = {\n        pagerender: async (pageData)=>{\n            const textContent = await pageData.getTextContent();\n            const textItems = textContent.items.map((item)=>item?.str ?? \"\").join(\" \");\n            const cleaned = cleanText(textItems);\n            pageTexts.push(cleaned);\n            return cleaned;\n        }\n    };\n    const parsed = await pdf_parse__WEBPACK_IMPORTED_MODULE_4___default()(buffer, options);\n    // Fallback: if pagerender didn't push anything but parsed.text exists,\n    // split by blank lines to approximate pages/sections.\n    if (!pageTexts.length && parsed.text) {\n        parsed.text.split(/\\n{2,}/).map((chunk)=>cleanText(chunk)).filter(Boolean).forEach((chunk)=>pageTexts.push(chunk));\n    }\n    // Still nothing? Emit a single empty page so the AI has the context of\n    // \"file exists but OCR returned no text\".\n    if (!pageTexts.length) {\n        pageTexts.push(\"\");\n    }\n    return pageTexts.map((rawText, index)=>({\n            fileId: file.fileId,\n            fileName: file.fileName,\n            pageNumber: index + 1,\n            rawText\n        }));\n}\n/**\r\n * runTesseract\r\n * ------------\r\n * Runs Tesseract OCR on an image buffer using the languages configured\r\n * by OCR_LANGS (default: eng+chi_sim+tha+ms+kor).\r\n *\r\n * Make sure you have the corresponding .traineddata files installed\r\n * if you are using a native Tesseract installation. For tesseract.js,\r\n * it will download language data from the CDN on first use.\r\n *\r\n * A safety timeout (OCR_TIMEOUT_MS) is applied so a problematic image\r\n * doesnâ€™t hang the entire request indefinitely.\r\n */ async function runTesseract(buffer) {\n    const recognizePromise = tesseract_js__WEBPACK_IMPORTED_MODULE_3___default().recognize(buffer, OCR_LANGS);\n    const timeoutPromise = new Promise((_, reject)=>{\n        setTimeout(()=>reject(new Error(`Tesseract OCR timed out after ${OCR_TIMEOUT_MS} ms (languages: ${OCR_LANGS})`)), OCR_TIMEOUT_MS);\n    });\n    const result = await Promise.race([\n        recognizePromise,\n        timeoutPromise\n    ]);\n    return result.data?.text || \"\";\n}\n/**\r\n * cleanText\r\n * ---------\r\n * Normalizes whitespace but preserves line breaks so that menu items\r\n * remain visually separated for the LLM.\r\n */ function cleanText(text) {\n    return text.replace(/\\r\\n/g, \"\\n\") // normalise Windows line endings\n    .replace(/\\r/g, \"\\n\").replace(/[ \\t]+/g, \" \") // collapse spaces/tabs\n    .replace(/\\n{2,}/g, \"\\n\") // collapse multiple blank lines\n    .trim();\n}\nfunction ensureTempDirectory() {\n    (0,fs__WEBPACK_IMPORTED_MODULE_0__.mkdirSync)(TEMP_DIR, {\n        recursive: true\n    });\n}\nfunction extractFilesFromFormData(formData) {\n    const files = [];\n    // Single / multiple: \"file\"\n    const fileEntries = formData.getAll(\"file\");\n    for (const entry of fileEntries){\n        if (entry instanceof File) {\n            files.push(entry);\n        }\n    }\n    // Multiple: \"files\" or \"files[]\"\n    const multiples = [\n        ...formData.getAll(\"files\"),\n        ...formData.getAll(\"files[]\")\n    ];\n    for (const entry of multiples){\n        if (entry instanceof File) {\n            files.push(entry);\n        }\n    }\n    return files;\n}\nfunction summarizeFiles(files, pages) {\n    return files.map((file)=>({\n            file_id: file.fileId,\n            original_name: file.fileName,\n            page_count: pages.filter((page)=>page.fileId === file.fileId).length\n        }));\n}\nfunction createHttpError(status, message) {\n    const error = new Error(message);\n    error.status = status;\n    return error;\n}\nfunction generateFriendlyBatchId() {\n    const now = new Date();\n    const pad = (n)=>n.toString().padStart(2, \"0\");\n    const y = now.getFullYear();\n    const m = pad(now.getMonth() + 1);\n    const d = pad(now.getDate());\n    const hh = pad(now.getHours());\n    const mm = pad(now.getMinutes());\n    const ss = pad(now.getSeconds());\n    const rand = Math.random().toString(36).slice(2, 6); // 4-char slug\n    return `b_${y}${m}${d}_${hh}${mm}${ss}_${rand}`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFFRSxFQUFFLEVBQUVFLEVBQUUsQ0FBQyxFQUFFRSxHQUFHLEVBQUVFLEdBQUcsRUFBRUUsR0FBRyxDQUFDLEVBQUVFLEtBQUssQ0FBQztBQUNqRCIsInNvdXJjZXMiOlsid2VicGFjazovL2xlbWVkaWNhLWNsaW5pYy1vY3IvLi9zcmMvc2VydmljZXMvb2NyLnRzP2Q1OTgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJvbWlzZXMgYXMgZnMgfSBmcm9tIFwiZnNcIjtcclxuaW1wb3J0IHsgbWtkaXJTeW5jIH0gZnJvbSBcImZzXCI7XHJcbmltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB7IGpvaW4gfSBmcm9tIFwicGF0aFwiO1xyXG5pbXBvcnQgeyByYW5kb21VVUlEIH0gZnJvbSBcImNyeXB0b1wiO1xyXG5pbXBvcnQgVGVzc2VyYWN0IGZyb20gXCJ0ZXNzZXJhY3QuanNcIjtcclxuaW1wb3J0IHBkZlBhcnNlIGZyb20gXCJwZGYtcGFyc2VcIjtcclxuaW1wb3J0IHR5cGUgeyBPY3JQYWdlIH0gZnJvbSBcIkAvbGliL3R5cGVzL29jclwiO1xyXG5cclxuXHJcbmNvbnN0IE9DUl9ERUJVR19ESVIgPSBqb2luKHByb2Nlc3MuY3dkKCksIFwidG1wXCIsIFwib2NyLWRlYnVnXCIpO1xyXG4vLyBUb2dnbGUgd2l0aCBhbiBlbnYgdmFyIHNvIHByb2QgaXNu4oCZdCBzcGFtbWVkXHJcbmNvbnN0IE9DUl9ERUJVR19FTkFCTEVEID0gcHJvY2Vzcy5lbnYuT0NSX0RFQlVHID09PSBcIjFcIjtcclxuXHJcblxyXG5jb25zdCBURU1QX0RJUiA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgXCJ0bXBcIiwgXCJvY3ItdXBsb2Fkc1wiKTtcclxuY29uc3QgTUFYX0ZJTEVfU0laRV9CWVRFUyA9XHJcbiAgTnVtYmVyKHByb2Nlc3MuZW52Lk9DUl9NQVhfRklMRV9NQiB8fCAyNSkgKiAxMDI0ICogMTAyNDtcclxuY29uc3QgQUxMT1dFRF9NSU1FX1RZUEVTID0gbmV3IFNldChbXHJcbiAgXCJhcHBsaWNhdGlvbi9wZGZcIixcclxuICBcImltYWdlL2pwZWdcIixcclxuICBcImltYWdlL3BuZ1wiLFxyXG4gIFwiaW1hZ2UvaGVpY1wiLFxyXG4gIFwiaW1hZ2UvaGVpZlwiLFxyXG5dKTtcclxuXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIE9DUiBsYW5ndWFnZSArIHRpbWVvdXQgY29uZmlnXHJcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIExhbmd1YWdlcyBmb3IgVGVzc2VyYWN0IE9DUi4gT3ZlcnJpZGUgdmlhIC5lbnYubG9jYWwsIGUuZy5cclxuLy8gICBPQ1JfTEFOR1M9ZW5nK2NoaV9zaW1cclxuLy8gICBPQ1JfTEFOR1M9ZW5nK2NoaV9zaW0rdGhhK21zXHJcbi8vXHJcbi8vIElNUE9SVEFOVDogTW9yZSBsYW5ndWFnZXMgPSBoZWF2aWVyICsgc2xvd2VyLiBGb3IgQ2hpbmVzZS1oZWF2eSBtZW51cywgdHJ5OlxyXG4vLyAgIE9DUl9MQU5HUz1lbmcrY2hpX3NpbVxyXG4vL1xyXG5jb25zdCBPQ1JfTEFOR1MgPSBwcm9jZXNzLmVudi5PQ1JfTEFOR1MgfHwgXCJlbmcrY2hpX3NpbSt0aGErbXMra29yXCI7XHJcblxyXG4vLyBNYXggdGltZSAobXMpIHdlIGFyZSB3aWxsaW5nIHRvIHdhaXQgZm9yIGEgc2luZ2xlIFRlc3NlcmFjdC5yZWNvZ25pemUoKSBjYWxsLlxyXG4vLyBQcmV2ZW50cyBcIkNoaW5lc2UgSlBFRyBydW5zIGZvcmV2ZXJcIiBoYW5ncy5cclxuY29uc3QgT0NSX1RJTUVPVVRfTVMgPSBOdW1iZXIocHJvY2Vzcy5lbnYuT0NSX1RJTUVPVVRfTVMgfHwgNjAwMDApO1xyXG5cclxuLyoqXHJcbiAqIGhhbmRsZVVwbG9hZEFuZEV4dHJhY3RPY3JcclxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gKiBBY2NlcHRzIHVwbG9hZGVkIGZpbGVzIGZyb20gYSBOZXh0UmVxdWVzdCwgdmFsaWRhdGVzIHRoZW0sIHdyaXRlcyB0aGUgY29udGVudFxyXG4gKiB0byBhIHRlbXAgZm9sZGVyLCBydW5zIE9DUiBwZXIgcGFnZSwgYW5kIHJldHVybnMgYSBsaXN0IG9mIE9jclBhZ2Ugb2JqZWN0cy5cclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVVcGxvYWRBbmRFeHRyYWN0T2NyKHJlcTogTmV4dFJlcXVlc3QpOiBQcm9taXNlPHtcclxuICBiYXRjaElkOiBzdHJpbmc7XHJcbiAgb2NyUGFnZXM6IE9jclBhZ2VbXTtcclxuICBmaWxlc01ldGE6IHtcclxuICAgIGZpbGVfaWQ6IHN0cmluZztcclxuICAgIG9yaWdpbmFsX25hbWU6IHN0cmluZztcclxuICAgIHBhZ2VfY291bnQ/OiBudW1iZXI7XHJcbiAgfVtdO1xyXG59PiB7XHJcbiAgZW5zdXJlVGVtcERpcmVjdG9yeSgpO1xyXG5cclxuICAvLyDwn5S5IEdlbmVyYXRlIHRoZSBiYXRjaCBJRCBPTkNFIGFuZCByZXVzZSBpdCBldmVyeXdoZXJlXHJcbiAgY29uc3QgYmF0Y2hJZCA9IGdlbmVyYXRlRnJpZW5kbHlCYXRjaElkKCk7XHJcblxyXG4gIGNvbnN0IGZvcm1EYXRhID0gYXdhaXQgcmVxLmZvcm1EYXRhKCk7XHJcbiAgY29uc3QgaW5jb21pbmdGaWxlcyA9IGV4dHJhY3RGaWxlc0Zyb21Gb3JtRGF0YShmb3JtRGF0YSk7XHJcblxyXG4gIGlmICghaW5jb21pbmdGaWxlcy5sZW5ndGgpIHtcclxuICAgIHRocm93IGNyZWF0ZUh0dHBFcnJvcihcclxuICAgICAgNDAwLFxyXG4gICAgICBcIk5vIGZpbGUgcHJvdmlkZWQuIFBsZWFzZSBhcHBlbmQgYGZpbGVgIG9yIGBmaWxlc1tdYCB0byBGb3JtRGF0YS5cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHNhdmVkRmlsZXM6IFNhdmVkRmlsZVtdID0gW107XHJcblxyXG4gIGZvciAoY29uc3QgZmlsZSBvZiBpbmNvbWluZ0ZpbGVzKSB7XHJcbiAgICBpZiAoIUFMTE9XRURfTUlNRV9UWVBFUy5oYXMoZmlsZS50eXBlKSkge1xyXG4gICAgICB0aHJvdyBjcmVhdGVIdHRwRXJyb3IoXHJcbiAgICAgICAgNDAwLFxyXG4gICAgICAgIFwiVW5zdXBwb3J0ZWQgZmlsZSB0eXBlLiBQbGVhc2UgdXBsb2FkIFBERiwgSlBHLCBQTkcsIG9yIEhFSUMuXCJcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIGlmIChmaWxlLnNpemUgPiBNQVhfRklMRV9TSVpFX0JZVEVTKSB7XHJcbiAgICAgIHRocm93IGNyZWF0ZUh0dHBFcnJvcihcclxuICAgICAgICA0MTMsXHJcbiAgICAgICAgYEZpbGUgZXhjZWVkcyB0aGUgbWF4aW11bSBhbGxvd2VkIHNpemUgb2YgJHtNYXRoLnJvdW5kKFxyXG4gICAgICAgICAgTUFYX0ZJTEVfU0laRV9CWVRFUyAvICgxMDI0ICogMTAyNClcclxuICAgICAgICApfSBNQi5gXHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZmlsZUlkID0gcmFuZG9tVVVJRCgpO1xyXG5cclxuICAgIC8vIPCflLkgVXNlIG9ubHkgdGhlIGxhc3QgcGF0aCBzZWdtZW50IChzdHJpcCBmb2xkZXIgcGFydHMpXHJcbiAgICBjb25zdCBvcmlnaW5hbE5hbWUgPSBmaWxlLm5hbWUgfHwgYHVwbG9hZC0ke2ZpbGVJZH1gO1xyXG4gICAgY29uc3QgYmFzZU5hbWUgPSBvcmlnaW5hbE5hbWUuc3BsaXQoL1tcXFxcL10vKS5wb3AoKSB8fCBvcmlnaW5hbE5hbWU7XHJcblxyXG4gICAgLy8g8J+UuSBTYW5pdGl6ZSBmb3IgZmlsZXN5c3RlbSAobm8gd2VpcmQgY2hhcnMgLyBzbGFzaGVzKVxyXG4gICAgY29uc3Qgc2FmZU5hbWUgPSBiYXNlTmFtZS5yZXBsYWNlKC9bXlxcdy5cXC1dKy9nLCBcIl9cIik7XHJcblxyXG4gICAgY29uc3QgdGVtcFBhdGggPSBqb2luKFRFTVBfRElSLCBgJHtmaWxlSWR9LSR7c2FmZU5hbWV9YCk7XHJcblxyXG4gICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmZyb20oYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpKTtcclxuICAgIGF3YWl0IGZzLndyaXRlRmlsZSh0ZW1wUGF0aCwgYnVmZmVyKTtcclxuXHJcbiAgICBzYXZlZEZpbGVzLnB1c2goe1xyXG4gICAgICBmaWxlSWQsXHJcbiAgICAgIGZpbGVOYW1lOiBiYXNlTmFtZSwgICAvLyBrZWVwIGEgbmljZSBkaXNwbGF5IG5hbWUgKG5vIGZvbGRlcnMpXHJcbiAgICAgIG1pbWVUeXBlOiBmaWxlLnR5cGUsXHJcbiAgICAgIHBhdGg6IHRlbXBQYXRoLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBvY3JQYWdlcyA9IGF3YWl0IHJ1bk9jck9uRmlsZXMoc2F2ZWRGaWxlcyk7XHJcbiAgY29uc3QgZmlsZXNNZXRhID0gc3VtbWFyaXplRmlsZXMoc2F2ZWRGaWxlcywgb2NyUGFnZXMpO1xyXG5cclxuICAvLyDwn5S5IE9ubHkgdmFsaWQgbm93IGJlY2F1c2UgYmF0Y2hJZCBpcyBkZWZpbmVkIGFib3ZlXHJcbiAgaWYgKE9DUl9ERUJVR19FTkFCTEVEKSB7XHJcbiAgICBhd2FpdCBzYXZlT2NyRGVidWdTbmFwc2hvdChiYXRjaElkLCBvY3JQYWdlcyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgYmF0Y2hJZCwgICAgICAvLyByZXVzZSB0aGUgc2FtZSBiYXRjaElkIGhlcmVcclxuICAgIG9jclBhZ2VzLFxyXG4gICAgZmlsZXNNZXRhLFxyXG4gIH07XHJcbn1cclxuXHJcblxyXG50eXBlIFNhdmVkRmlsZSA9IHtcclxuICBmaWxlSWQ6IHN0cmluZztcclxuICBmaWxlTmFtZTogc3RyaW5nO1xyXG4gIG1pbWVUeXBlOiBzdHJpbmc7XHJcbiAgcGF0aDogc3RyaW5nO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIHJ1bk9jck9uRmlsZXNcclxuICogLS0tLS0tLS0tLS0tLS1cclxuICogUnVucyBPQ1Igb24gZWFjaCBwYWdlIG9mIHRoZSB1cGxvYWRlZCBmaWxlcyBhbmQgcmV0dXJuc1xyXG4gKiBPY3JQYWdlIG9iamVjdHMgdGhhdCByZXRhaW4gcGFnZSBvcmRlcmluZyBhbmQgbWV0YWRhdGEuXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuT2NyT25GaWxlcyhmaWxlczogU2F2ZWRGaWxlW10pOiBQcm9taXNlPE9jclBhZ2VbXT4ge1xyXG4gIGNvbnN0IHBhZ2VzOiBPY3JQYWdlW10gPSBbXTtcclxuXHJcbiAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XHJcbiAgICBpZiAoZmlsZS5taW1lVHlwZSA9PT0gXCJhcHBsaWNhdGlvbi9wZGZcIikge1xyXG4gICAgICBjb25zdCBwZGZQYWdlcyA9IGF3YWl0IHJ1bk9jck9uUGRmKGZpbGUpO1xyXG4gICAgICBwYWdlcy5wdXNoKC4uLnBkZlBhZ2VzKTtcclxuICAgICAgY29udGludWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW1hZ2UgZmlsZTogdXNlIFRlc3NlcmFjdCBkaXJlY3RseSB3aXRoIG11bHRpLWxhbmd1YWdlIHN1cHBvcnRcclxuICAgIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGZzLnJlYWRGaWxlKGZpbGUucGF0aCk7XHJcbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcnVuVGVzc2VyYWN0KGJ1ZmZlcik7XHJcbiAgICBwYWdlcy5wdXNoKHtcclxuICAgICAgZmlsZUlkOiBmaWxlLmZpbGVJZCxcclxuICAgICAgZmlsZU5hbWU6IGZpbGUuZmlsZU5hbWUsXHJcbiAgICAgIHBhZ2VOdW1iZXI6IDEsXHJcbiAgICAgIHJhd1RleHQ6IGNsZWFuVGV4dCh0ZXh0KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHBhZ2VzO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBzYXZlT2NyRGVidWdTbmFwc2hvdChiYXRjaElkOiBzdHJpbmcsIHBhZ2VzOiBPY3JQYWdlW10pIHtcclxuICB0cnkge1xyXG4gICAgbWtkaXJTeW5jKE9DUl9ERUJVR19ESVIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xyXG5cclxuICAgIGZvciAoY29uc3QgcGFnZSBvZiBwYWdlcykge1xyXG4gICAgICBjb25zdCBzYWZlRmlsZSA9IHBhZ2UuZmlsZU5hbWUucmVwbGFjZSgvW15cXHcuLV0rL2csIFwiX1wiKTtcclxuICAgICAgY29uc3QgZGVidWdOYW1lID0gYCR7YmF0Y2hJZH1fcCR7cGFnZS5wYWdlTnVtYmVyfV8ke3NhZmVGaWxlfS50eHRgO1xyXG4gICAgICBjb25zdCBkZWJ1Z1BhdGggPSBqb2luKE9DUl9ERUJVR19ESVIsIGRlYnVnTmFtZSk7XHJcblxyXG4gICAgICBjb25zdCBjb250ZW50ID1cclxuICAgICAgICBgQkFUQ0g6ICR7YmF0Y2hJZH1cXG5gICtcclxuICAgICAgICBgRklMRTogICR7cGFnZS5maWxlTmFtZX1cXG5gICtcclxuICAgICAgICBgUEFHRTogICR7cGFnZS5wYWdlTnVtYmVyfVxcbmAgK1xyXG4gICAgICAgIGAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXFxuYCArXHJcbiAgICAgICAgcGFnZS5yYXdUZXh0O1xyXG5cclxuICAgICAgYXdhaXQgZnMud3JpdGVGaWxlKGRlYnVnUGF0aCwgY29udGVudCwgXCJ1dGY4XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICBgW09DUiBERUJVR10gU2F2ZWQgcGFnZS1sZXZlbCB0ZXh0IGZvciBiYXRjaCAke2JhdGNoSWR9IHRvICR7T0NSX0RFQlVHX0RJUn1gXHJcbiAgICApO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIltPQ1IgREVCVUddIEZhaWxlZCB0byBzYXZlIHNuYXBzaG90OlwiLCBlcnIpO1xyXG4gIH1cclxufVxyXG5cclxuXHJcbi8qKlxyXG4gKiBydW5PY3JPblBkZlxyXG4gKiAtLS0tLS0tLS0tLVxyXG4gKiBVc2VzIHBkZi1wYXJzZSB0byBleHRyYWN0IHRleHQgcGVyIHBhZ2UuXHJcbiAqIElmIHBkZi1wYXJzZSByZXR1cm5zIG5vdGhpbmcsIHdlIHN0aWxsIGVtaXQgb25lIGVtcHR5IHBhZ2UgZW50cnkuXHJcbiAqXHJcbiAqIE5PVEU6IFRoaXMgcGF0aCBpcyB0ZXh0LWJhc2VkOyBpZiB5b3UgbmVlZCBpbWFnZS1iYXNlZCBQREYgT0NSIGxhdGVyLFxyXG4gKiB5b3UgY2FuIGFkZCBhIFRlc3NlcmFjdCBmYWxsYmFjayBoZXJlIHRoYXQgcmFzdGVyaXplcyBwYWdlcy5cclxuICovXHJcbmFzeW5jIGZ1bmN0aW9uIHJ1bk9jck9uUGRmKGZpbGU6IFNhdmVkRmlsZSk6IFByb21pc2U8T2NyUGFnZVtdPiB7XHJcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgZnMucmVhZEZpbGUoZmlsZS5wYXRoKTtcclxuICBjb25zdCBwYWdlVGV4dHM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gIGNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgICBwYWdlcmVuZGVyOiBhc3luYyAocGFnZURhdGE6IGFueSkgPT4ge1xyXG4gICAgICBjb25zdCB0ZXh0Q29udGVudCA9IGF3YWl0IHBhZ2VEYXRhLmdldFRleHRDb250ZW50KCk7XHJcbiAgICAgIGNvbnN0IHRleHRJdGVtcyA9IHRleHRDb250ZW50Lml0ZW1zXHJcbiAgICAgICAgLm1hcCgoaXRlbTogeyBzdHI/OiBzdHJpbmcgfSkgPT4gaXRlbT8uc3RyID8/IFwiXCIpXHJcbiAgICAgICAgLmpvaW4oXCIgXCIpO1xyXG4gICAgICBjb25zdCBjbGVhbmVkID0gY2xlYW5UZXh0KHRleHRJdGVtcyk7XHJcbiAgICAgIHBhZ2VUZXh0cy5wdXNoKGNsZWFuZWQpO1xyXG4gICAgICByZXR1cm4gY2xlYW5lZDtcclxuICAgIH0sXHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcGFyc2VkID0gYXdhaXQgcGRmUGFyc2UoYnVmZmVyLCBvcHRpb25zIGFzIGFueSk7XHJcblxyXG4gIC8vIEZhbGxiYWNrOiBpZiBwYWdlcmVuZGVyIGRpZG4ndCBwdXNoIGFueXRoaW5nIGJ1dCBwYXJzZWQudGV4dCBleGlzdHMsXHJcbiAgLy8gc3BsaXQgYnkgYmxhbmsgbGluZXMgdG8gYXBwcm94aW1hdGUgcGFnZXMvc2VjdGlvbnMuXHJcbiAgaWYgKCFwYWdlVGV4dHMubGVuZ3RoICYmIHBhcnNlZC50ZXh0KSB7XHJcbiAgICBwYXJzZWQudGV4dFxyXG4gICAgICAuc3BsaXQoL1xcbnsyLH0vKVxyXG4gICAgICAubWFwKChjaHVuaykgPT4gY2xlYW5UZXh0KGNodW5rKSlcclxuICAgICAgLmZpbHRlcihCb29sZWFuKVxyXG4gICAgICAuZm9yRWFjaCgoY2h1bmspID0+IHBhZ2VUZXh0cy5wdXNoKGNodW5rKSk7XHJcbiAgfVxyXG5cclxuICAvLyBTdGlsbCBub3RoaW5nPyBFbWl0IGEgc2luZ2xlIGVtcHR5IHBhZ2Ugc28gdGhlIEFJIGhhcyB0aGUgY29udGV4dCBvZlxyXG4gIC8vIFwiZmlsZSBleGlzdHMgYnV0IE9DUiByZXR1cm5lZCBubyB0ZXh0XCIuXHJcbiAgaWYgKCFwYWdlVGV4dHMubGVuZ3RoKSB7XHJcbiAgICBwYWdlVGV4dHMucHVzaChcIlwiKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBwYWdlVGV4dHMubWFwKChyYXdUZXh0LCBpbmRleCkgPT4gKHtcclxuICAgIGZpbGVJZDogZmlsZS5maWxlSWQsXHJcbiAgICBmaWxlTmFtZTogZmlsZS5maWxlTmFtZSxcclxuICAgIHBhZ2VOdW1iZXI6IGluZGV4ICsgMSxcclxuICAgIHJhd1RleHQsXHJcbiAgfSkpO1xyXG59XHJcblxyXG4vKipcclxuICogcnVuVGVzc2VyYWN0XHJcbiAqIC0tLS0tLS0tLS0tLVxyXG4gKiBSdW5zIFRlc3NlcmFjdCBPQ1Igb24gYW4gaW1hZ2UgYnVmZmVyIHVzaW5nIHRoZSBsYW5ndWFnZXMgY29uZmlndXJlZFxyXG4gKiBieSBPQ1JfTEFOR1MgKGRlZmF1bHQ6IGVuZytjaGlfc2ltK3RoYSttcytrb3IpLlxyXG4gKlxyXG4gKiBNYWtlIHN1cmUgeW91IGhhdmUgdGhlIGNvcnJlc3BvbmRpbmcgLnRyYWluZWRkYXRhIGZpbGVzIGluc3RhbGxlZFxyXG4gKiBpZiB5b3UgYXJlIHVzaW5nIGEgbmF0aXZlIFRlc3NlcmFjdCBpbnN0YWxsYXRpb24uIEZvciB0ZXNzZXJhY3QuanMsXHJcbiAqIGl0IHdpbGwgZG93bmxvYWQgbGFuZ3VhZ2UgZGF0YSBmcm9tIHRoZSBDRE4gb24gZmlyc3QgdXNlLlxyXG4gKlxyXG4gKiBBIHNhZmV0eSB0aW1lb3V0IChPQ1JfVElNRU9VVF9NUykgaXMgYXBwbGllZCBzbyBhIHByb2JsZW1hdGljIGltYWdlXHJcbiAqIGRvZXNu4oCZdCBoYW5nIHRoZSBlbnRpcmUgcmVxdWVzdCBpbmRlZmluaXRlbHkuXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBydW5UZXNzZXJhY3QoYnVmZmVyOiBCdWZmZXIpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGNvbnN0IHJlY29nbml6ZVByb21pc2UgPSBUZXNzZXJhY3QucmVjb2duaXplKGJ1ZmZlciwgT0NSX0xBTkdTKTtcclxuXHJcbiAgY29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZTxuZXZlcj4oKF8sIHJlamVjdCkgPT4ge1xyXG4gICAgc2V0VGltZW91dChcclxuICAgICAgKCkgPT5cclxuICAgICAgICByZWplY3QoXHJcbiAgICAgICAgICBuZXcgRXJyb3IoXHJcbiAgICAgICAgICAgIGBUZXNzZXJhY3QgT0NSIHRpbWVkIG91dCBhZnRlciAke09DUl9USU1FT1VUX01TfSBtcyAobGFuZ3VhZ2VzOiAke09DUl9MQU5HU30pYCxcclxuICAgICAgICAgICksXHJcbiAgICAgICAgKSxcclxuICAgICAgT0NSX1RJTUVPVVRfTVMsXHJcbiAgICApO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBQcm9taXNlLnJhY2UoW3JlY29nbml6ZVByb21pc2UsIHRpbWVvdXRQcm9taXNlXSk7XHJcbiAgcmV0dXJuIHJlc3VsdC5kYXRhPy50ZXh0IHx8IFwiXCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBjbGVhblRleHRcclxuICogLS0tLS0tLS0tXHJcbiAqIE5vcm1hbGl6ZXMgd2hpdGVzcGFjZSBidXQgcHJlc2VydmVzIGxpbmUgYnJlYWtzIHNvIHRoYXQgbWVudSBpdGVtc1xyXG4gKiByZW1haW4gdmlzdWFsbHkgc2VwYXJhdGVkIGZvciB0aGUgTExNLlxyXG4gKi9cclxuZnVuY3Rpb24gY2xlYW5UZXh0KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgcmV0dXJuIHRleHRcclxuICAgIC5yZXBsYWNlKC9cXHJcXG4vZywgXCJcXG5cIikgICAgICAvLyBub3JtYWxpc2UgV2luZG93cyBsaW5lIGVuZGluZ3NcclxuICAgIC5yZXBsYWNlKC9cXHIvZywgXCJcXG5cIilcclxuICAgIC5yZXBsYWNlKC9bIFxcdF0rL2csIFwiIFwiKSAgICAgLy8gY29sbGFwc2Ugc3BhY2VzL3RhYnNcclxuICAgIC5yZXBsYWNlKC9cXG57Mix9L2csIFwiXFxuXCIpICAgIC8vIGNvbGxhcHNlIG11bHRpcGxlIGJsYW5rIGxpbmVzXHJcbiAgICAudHJpbSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBlbnN1cmVUZW1wRGlyZWN0b3J5KCkge1xyXG4gIG1rZGlyU3luYyhURU1QX0RJUiwgeyByZWN1cnNpdmU6IHRydWUgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGV4dHJhY3RGaWxlc0Zyb21Gb3JtRGF0YShmb3JtRGF0YTogRm9ybURhdGEpOiBGaWxlW10ge1xyXG4gIGNvbnN0IGZpbGVzOiBGaWxlW10gPSBbXTtcclxuXHJcbiAgLy8gU2luZ2xlIC8gbXVsdGlwbGU6IFwiZmlsZVwiXHJcbiAgY29uc3QgZmlsZUVudHJpZXMgPSBmb3JtRGF0YS5nZXRBbGwoXCJmaWxlXCIpO1xyXG4gIGZvciAoY29uc3QgZW50cnkgb2YgZmlsZUVudHJpZXMpIHtcclxuICAgIGlmIChlbnRyeSBpbnN0YW5jZW9mIEZpbGUpIHtcclxuICAgICAgZmlsZXMucHVzaChlbnRyeSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBNdWx0aXBsZTogXCJmaWxlc1wiIG9yIFwiZmlsZXNbXVwiXHJcbiAgY29uc3QgbXVsdGlwbGVzID0gW1xyXG4gICAgLi4uZm9ybURhdGEuZ2V0QWxsKFwiZmlsZXNcIiksXHJcbiAgICAuLi5mb3JtRGF0YS5nZXRBbGwoXCJmaWxlc1tdXCIpLFxyXG4gIF07XHJcbiAgZm9yIChjb25zdCBlbnRyeSBvZiBtdWx0aXBsZXMpIHtcclxuICAgIGlmIChlbnRyeSBpbnN0YW5jZW9mIEZpbGUpIHtcclxuICAgICAgZmlsZXMucHVzaChlbnRyeSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gZmlsZXM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN1bW1hcml6ZUZpbGVzKGZpbGVzOiBTYXZlZEZpbGVbXSwgcGFnZXM6IE9jclBhZ2VbXSkge1xyXG4gIHJldHVybiBmaWxlcy5tYXAoKGZpbGUpID0+ICh7XHJcbiAgICBmaWxlX2lkOiBmaWxlLmZpbGVJZCxcclxuICAgIG9yaWdpbmFsX25hbWU6IGZpbGUuZmlsZU5hbWUsXHJcbiAgICBwYWdlX2NvdW50OiBwYWdlcy5maWx0ZXIoKHBhZ2UpID0+IHBhZ2UuZmlsZUlkID09PSBmaWxlLmZpbGVJZCkubGVuZ3RoLFxyXG4gIH0pKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlSHR0cEVycm9yKHN0YXR1czogbnVtYmVyLCBtZXNzYWdlOiBzdHJpbmcpIHtcclxuICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKSBhcyBFcnJvciAmIHsgc3RhdHVzPzogbnVtYmVyIH07XHJcbiAgZXJyb3Iuc3RhdHVzID0gc3RhdHVzO1xyXG4gIHJldHVybiBlcnJvcjtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGVGcmllbmRseUJhdGNoSWQoKTogc3RyaW5nIHtcclxuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gIGNvbnN0IHBhZCA9IChuOiBudW1iZXIpID0+IG4udG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIik7XHJcblxyXG4gIGNvbnN0IHkgPSBub3cuZ2V0RnVsbFllYXIoKTtcclxuICBjb25zdCBtID0gcGFkKG5vdy5nZXRNb250aCgpICsgMSk7XHJcbiAgY29uc3QgZCA9IHBhZChub3cuZ2V0RGF0ZSgpKTtcclxuICBjb25zdCBoaCA9IHBhZChub3cuZ2V0SG91cnMoKSk7XHJcbiAgY29uc3QgbW0gPSBwYWQobm93LmdldE1pbnV0ZXMoKSk7XHJcbiAgY29uc3Qgc3MgPSBwYWQobm93LmdldFNlY29uZHMoKSk7XHJcblxyXG4gIGNvbnN0IHJhbmQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyLCA2KTsgLy8gNC1jaGFyIHNsdWdcclxuXHJcbiAgcmV0dXJuIGBiXyR7eX0ke219JHtkfV8ke2hofSR7bW19JHtzc31fJHtyYW5kfWA7XHJcbn1cclxuIl0sIm5hbWVzIjpbInByb21pc2VzIiwiZnMiLCJta2RpclN5bmMiLCJqb2luIiwicmFuZG9tVVVJRCIsIlRlc3NlcmFjdCIsInBkZlBhcnNlIiwiT0NSX0RFQlVHX0RJUiIsInByb2Nlc3MiLCJjd2QiLCJPQ1JfREVCVUdfRU5BQkxFRCIsImVudiIsIk9DUl9ERUJVRyIsIlRFTVBfRElSIiwiTUFYX0ZJTEVfU0laRV9CWVRFUyIsIk51bWJlciIsIk9DUl9NQVhfRklMRV9NQiIsIkFMTE9XRURfTUlNRV9UWVBFUyIsIlNldCIsIk9DUl9MQU5HUyIsIk9DUl9USU1FT1VUX01TIiwiaGFuZGxlVXBsb2FkQW5kRXh0cmFjdE9jciIsInJlcSIsImVuc3VyZVRlbXBEaXJlY3RvcnkiLCJiYXRjaElkIiwiZ2VuZXJhdGVGcmllbmRseUJhdGNoSWQiLCJmb3JtRGF0YSIsImluY29taW5nRmlsZXMiLCJleHRyYWN0RmlsZXNGcm9tRm9ybURhdGEiLCJsZW5ndGgiLCJjcmVhdGVIdHRwRXJyb3IiLCJzYXZlZEZpbGVzIiwiZmlsZSIsImhhcyIsInR5cGUiLCJzaXplIiwiTWF0aCIsInJvdW5kIiwiZmlsZUlkIiwib3JpZ2luYWxOYW1lIiwibmFtZSIsImJhc2VOYW1lIiwic3BsaXQiLCJwb3AiLCJzYWZlTmFtZSIsInJlcGxhY2UiLCJ0ZW1wUGF0aCIsImJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJhcnJheUJ1ZmZlciIsIndyaXRlRmlsZSIsInB1c2giLCJmaWxlTmFtZSIsIm1pbWVUeXBlIiwicGF0aCIsIm9jclBhZ2VzIiwicnVuT2NyT25GaWxlcyIsImZpbGVzTWV0YSIsInN1bW1hcml6ZUZpbGVzIiwic2F2ZU9jckRlYnVnU25hcHNob3QiLCJmaWxlcyIsInBhZ2VzIiwicGRmUGFnZXMiLCJydW5PY3JPblBkZiIsInJlYWRGaWxlIiwidGV4dCIsInJ1blRlc3NlcmFjdCIsInBhZ2VOdW1iZXIiLCJyYXdUZXh0IiwiY2xlYW5UZXh0IiwicmVjdXJzaXZlIiwicGFnZSIsInNhZmVGaWxlIiwiZGVidWdOYW1lIiwiZGVidWdQYXRoIiwiY29udGVudCIsImNvbnNvbGUiLCJsb2ciLCJlcnIiLCJlcnJvciIsInBhZ2VUZXh0cyIsIm9wdGlvbnMiLCJwYWdlcmVuZGVyIiwicGFnZURhdGEiLCJ0ZXh0Q29udGVudCIsImdldFRleHRDb250ZW50IiwidGV4dEl0ZW1zIiwiaXRlbXMiLCJtYXAiLCJpdGVtIiwic3RyIiwiY2xlYW5lZCIsInBhcnNlZCIsImNodW5rIiwiZmlsdGVyIiwiQm9vbGVhbiIsImZvckVhY2giLCJpbmRleCIsInJlY29nbml6ZVByb21pc2UiLCJyZWNvZ25pemUiLCJ0aW1lb3V0UHJvbWlzZSIsIlByb21pc2UiLCJfIiwicmVqZWN0Iiwic2V0VGltZW91dCIsIkVycm9yIiwicmVzdWx0IiwicmFjZSIsImRhdGEiLCJ0cmltIiwiZmlsZUVudHJpZXMiLCJnZXRBbGwiLCJlbnRyeSIsIkZpbGUiLCJtdWx0aXBsZXMiLCJmaWxlX2lkIiwib3JpZ2luYWxfbmFtZSIsInBhZ2VfY291bnQiLCJzdGF0dXMiLCJtZXNzYWdlIiwibm93IiwiRGF0ZSIsInBhZCIsIm4iLCJ0b1N0cmluZyIsInBhZFN0YXJ0IiwieSIsImdldEZ1bGxZZWFyIiwibSIsImdldE1vbnRoIiwiZCIsImdldERhdGUiLCJoaCIsImdldEhvdXJzIiwibW0iLCJnZXRNaW51dGVzIiwic3MiLCJnZXRTZWNvbmRzIiwicmFuZCIsInJhbmRvbSIsInNsaWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/services/ocr.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@aws-sdk","vendor-chunks/@smithy","vendor-chunks/pdf-parse","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/tesseract.js","vendor-chunks/@aws-crypto","vendor-chunks/whatwg-url","vendor-chunks/tr46","vendor-chunks/node-fetch","vendor-chunks/webidl-conversions","vendor-chunks/regenerator-runtime","vendor-chunks/is-url","vendor-chunks/is-electron","vendor-chunks/@aws"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Focr-menus%2Froute&page=%2Fapi%2Focr-menus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Focr-menus%2Froute.ts&appDir=C%3A%5CUsers%5CUser%5CDocuments%5Cside_quest%5CLeMedica%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUser%5CDocuments%5Cside_quest%5CLeMedica&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();